{"version":3,"file":"index.global.js","sources":["../node_modules/tslib/tslib.es6.js","../../../Advanced Cropper/advanced-cropper/dist/utils/index.js","../../../Advanced Cropper/advanced-cropper/node_modules/tslib/tslib.es6.js","../../../Advanced Cropper/advanced-cropper/dist/types/index.js","../../../Advanced Cropper/advanced-cropper/dist/state/setCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/constants/index.js","../../../Advanced Cropper/advanced-cropper/dist/service/utils.js","../../../Advanced Cropper/advanced-cropper/dist/service/helpers.js","../../../Advanced Cropper/advanced-cropper/dist/service/sizeRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/state/copyState.js","../../../Advanced Cropper/advanced-cropper/dist/service/approximateSize.js","../../../Advanced Cropper/advanced-cropper/dist/service/fitVisibleArea.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/moveCoordinatesAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/service/fitCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/state/setVisibleArea.js","../../../Advanced Cropper/advanced-cropper/dist/state/createState.js","../../../Advanced Cropper/advanced-cropper/dist/state/moveCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/resizeCoordinatesAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/state/resizeCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/state/setBoundary.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/rotateImageAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/flipImageAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/transformImageAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/state/transformImage.js","../../../Advanced Cropper/advanced-cropper/dist/state/reconcileState.js","../../../Advanced Cropper/advanced-cropper/dist/service/normalize.js","../../../Advanced Cropper/advanced-cropper/dist/service/imageTransforms.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultPositionRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultVisibleArea.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultSize.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultSizeRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultPosition.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultAreaPositionRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultAreaSizeRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultBoundary.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultStencilConstraints.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/index.js","../../../Advanced Cropper/advanced-cropper/dist/service/interactions.js","../../../Advanced Cropper/advanced-cropper/dist/instance/AbstractCropper.js","../../../Advanced Cropper/advanced-cropper/dist/instance/CropperInstance.js","../../../Advanced Cropper/advanced-cropper/dist/animation/index.js","../../../Advanced Cropper/advanced-cropper/dist/canvas/index.js","../../../Advanced Cropper/advanced-cropper/dist/boundary/index.js","../../../Advanced Cropper/advanced-cropper/dist/image/index.js","../src/service/cropper.ts","../src/deprecated/hybridAutoZoom.ts","../src/hooks/useDeprecationWarning.ts","../src/service/utils.ts","../node_modules/classnames/index.js","../src/hooks/useWindowResize.ts","../src/hooks/useCropperImage.ts","../src/hooks/useCropperState.ts","../src/hooks/useForceRerender.ts","../src/hooks/useCropperProps.ts","../src/service/react.ts","../src/hooks/useUpdateEffect.ts","../src/hooks/useFirstMountState.ts","../src/components/service/StretchableBoundary.tsx","../src/components/service/CropperFade.tsx","../src/components/service/CropperWrapper.tsx","../src/service/events.ts","../src/components/service/CropperBackgroundImage.tsx","../src/components/service/CropperCanvas.tsx","../src/components/service/DraggableElement.tsx","../src/components/service/LineWrapper.tsx","../src/components/lines/SimpleLine.tsx","../src/components/service/HandlerWrapper.tsx","../src/components/handlers/SimpleHandler.tsx","../src/components/service/BoundingBox.tsx","../src/components/service/StencilOverlay.tsx","../src/components/service/ArtificialTransition.tsx","../src/hooks/useAnimatedState.ts","../src/components/service/StencilWrapper.tsx","../src/components/service/StencilGrid.tsx","../src/components/stencils/RectangleStencil.tsx","../src/hooks/useScaleImageOptions.ts","../src/hooks/useMoveImageOptions.ts","../src/components/service/TransformableImage.tsx","../src/components/service/CropperBackgroundWrapper.tsx","../src/hooks/useRotateImageOptions.ts","../src/components/AbstractCropper.tsx","../src/hooks/useStateWithCallback.ts","../../../Advanced Cropper/advanced-cropper/dist/extensions/stencil-size/index.js","../src/components/croppers/FixedCropper.tsx","../src/components/croppers/Cropper.tsx","../src/components/stencils/CircleStencil.tsx","../src/components/helpers/CropperPreview.tsx","../../../Advanced Cropper/advanced-cropper/dist/service/isEqualState.js"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","function getDirectionNames(hDirection, vDirection) {\n    var camelCase, snakeCase;\n    if (hDirection && vDirection) {\n        camelCase = \"\" + hDirection + vDirection[0].toUpperCase() + vDirection.slice(1);\n        snakeCase = hDirection + \"-\" + vDirection;\n    }\n    else {\n        camelCase = hDirection || vDirection;\n        snakeCase = hDirection || vDirection;\n    }\n    return { camelCase: camelCase, snakeCase: snakeCase };\n}\nfunction isBlob(url) {\n    return /^blob:/.test(url);\n}\nfunction isDataUrl(url) {\n    return /^data:/.test(url);\n}\nfunction isLocal(url) {\n    return isBlob(url) || isDataUrl(url);\n}\nfunction isCrossOriginURL(url) {\n    if (isLocal(url)) {\n        return false;\n    }\n    var pageLocation = window.location;\n    var URL_HOST_PATTERN = /(\\w+:)?(?:\\/\\/)([\\w.-]+)?(?::(\\d+))?\\/?/;\n    var urlMatch = URL_HOST_PATTERN.exec(url) || [];\n    var urlparts = {\n        protocol: urlMatch[1] || '',\n        host: urlMatch[2] || '',\n        port: urlMatch[3] || '',\n    };\n    var defaultPort = function (protocol) {\n        if (protocol === 'http') {\n            return 80;\n        }\n        else {\n            return 433;\n        }\n    };\n    var portOf = function (location) {\n        return location.port || defaultPort((location.protocol || pageLocation.protocol));\n    };\n    return !((!urlparts.protocol && !urlparts.host && !urlparts.port) ||\n        Boolean(urlparts.protocol &&\n            urlparts.protocol == pageLocation.protocol &&\n            urlparts.host &&\n            urlparts.host == pageLocation.host &&\n            urlparts.host &&\n            portOf(urlparts) == portOf(pageLocation)));\n}\nfunction isArray(value) {\n    return Array.isArray(value);\n}\nfunction isFunction(value) {\n    return typeof value === 'function';\n}\nfunction isUndefined(obj) {\n    return obj === undefined;\n}\nvar isObject = function (term) {\n    return term !== null && typeof term === 'object';\n};\n// TODO: add the typing\nfunction getOptions(options, defaultScheme, falseScheme) {\n    if (falseScheme === void 0) { falseScheme = {}; }\n    var result = {};\n    if (isObject(options)) {\n        Object.keys(defaultScheme).forEach(function (key) {\n            if (isUndefined(options[key])) {\n                result[key] = defaultScheme[key];\n            }\n            else if (isObject(defaultScheme[key])) {\n                if (isObject(options[key])) {\n                    result[key] = getOptions(options[key], defaultScheme[key], falseScheme[key]);\n                }\n                else {\n                    result[key] = options[key] ? defaultScheme[key] : falseScheme[key];\n                }\n            }\n            else if (defaultScheme[key] === true || defaultScheme[key] === false) {\n                result[key] = Boolean(options[key]);\n            }\n            else {\n                result[key] = options[key];\n            }\n        });\n        return result;\n    }\n    else {\n        if (options) {\n            return defaultScheme;\n        }\n        else {\n            return falseScheme;\n        }\n    }\n}\nfunction parseNumber(number) {\n    var parsedNumber = Number(number);\n    if (Number.isNaN(parsedNumber)) {\n        return number;\n    }\n    else {\n        return parsedNumber;\n    }\n}\nfunction isNumber(value) {\n    return typeof value === 'number';\n}\nfunction isString(value) {\n    return typeof value === 'string';\n}\nfunction isNaN(value) {\n    return value !== value;\n}\nfunction isNumeric(value) {\n    return ((isNumber(value) && !isNaN(value)) ||\n        (isString(value) && !Number.isNaN(parseFloat(value)) && isFinite(parseFloat(value))));\n}\nfunction distance(firstPoint, secondPoint) {\n    return Math.sqrt(Math.pow(firstPoint.left - secondPoint.left, 2) + Math.pow(firstPoint.top - secondPoint.top, 2));\n}\nfunction isRoughlyEqual(a, b, tolerance) {\n    if (tolerance === void 0) { tolerance = 1e-3; }\n    return Math.abs(b - a) < tolerance;\n}\nfunction isGreater(a, b, tolerance) {\n    return isRoughlyEqual(a, b, tolerance) ? false : a > b;\n}\nfunction isLower(a, b, tolerance) {\n    return isRoughlyEqual(a, b, tolerance) ? false : a < b;\n}\nfunction isArrayBufferLike(value) {\n    return value instanceof ArrayBuffer;\n}\nfunction getCloserAngle(reference, angle) {\n    var turnsCount = Math.floor(reference / 360);\n    var firstCandidate = turnsCount * 360 + angle;\n    var secondCandidate = (turnsCount + 1) * 360 + angle;\n    if (Math.abs(firstCandidate - reference) < Math.abs(secondCandidate - reference)) {\n        return firstCandidate;\n    }\n    else {\n        return secondCandidate;\n    }\n}\nfunction sign(value) {\n    var number = +value;\n    if (number === 0 || isNaN(number)) {\n        return number;\n    }\n    return number > 0 ? 1 : -1;\n}\nfunction promiseTimeout(timeout) {\n    return new Promise(function (resolve) {\n        setTimeout(function () {\n            resolve();\n        }, timeout);\n    });\n}\n// Not performant, small function to reduce the code amount\nfunction deepClone(obj) {\n    if (!isObject(obj)) {\n        return obj;\n    }\n    var result = {};\n    if (Array.isArray(obj)) {\n        result = obj.map(function (item) { return deepClone(item); });\n    }\n    else {\n        Object.keys(obj).forEach(function (key) {\n            return (result[key] = deepClone(obj[key]));\n        });\n    }\n    return result;\n}\nfunction deepCompare(a, b, tolerance) {\n    if (tolerance === void 0) { tolerance = 1e-3; }\n    if (isNumber(a) && isNumber(b) && isRoughlyEqual(a, b, tolerance))\n        return true;\n    if (a === b)\n        return true;\n    if (a && b && typeof a == 'object' && typeof b == 'object') {\n        if (a.constructor !== b.constructor)\n            return false;\n        var length_1, i = void 0;\n        if (Array.isArray(a)) {\n            length_1 = a.length;\n            if (length_1 != b.length)\n                return false;\n            for (i = length_1; i-- !== 0;)\n                if (!deepCompare(a[i], b[i], tolerance))\n                    return false;\n            return true;\n        }\n        if (a.valueOf !== Object.prototype.valueOf)\n            return a.valueOf() === b.valueOf();\n        if (a.toString !== Object.prototype.toString)\n            return a.toString() === b.toString();\n        var keys = Object.keys(a);\n        length_1 = keys.length;\n        if (length_1 !== Object.keys(b).length)\n            return false;\n        for (i = length_1; i-- !== 0;)\n            if (!Object.prototype.hasOwnProperty.call(b, keys[i]))\n                return false;\n        for (i = length_1; i-- !== 0;) {\n            var key = keys[i];\n            if (!deepCompare(a[key], b[key], tolerance))\n                return false;\n        }\n        return true;\n    }\n    return a !== a && b !== b;\n}\nfunction isWheelEvent(event) {\n    return 'deltaX' in event;\n}\nfunction isTouchEvent(event) {\n    return 'touches' in event;\n}\nfunction isMouseEvent(event) {\n    return 'buttons' in event;\n}\nfunction emptyCoordinates() {\n    return {\n        left: 0,\n        top: 0,\n        width: 0,\n        height: 0,\n    };\n}\nfunction isCardinalDirection(value) {\n    return value === 'west' || value === 'south' || value === 'north' || value === 'east';\n}\nfunction isOrdinalDirection(value) {\n    return (isCardinalDirection(value) ||\n        value === 'westNorth' ||\n        value === 'westSouth' ||\n        value === 'eastNorth' ||\n        value === 'eastSouth');\n}\nfunction debounce(callback, delay) {\n    var timestamp;\n    var timeout;\n    function later() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var last = Date.now() - timestamp;\n        var delayValue = isFunction(delay) ? delay() : delay || 0;\n        if (last < delayValue && last >= 0) {\n            timeout = setTimeout(function () { return later.apply(void 0, args); }, delayValue - last);\n        }\n        else {\n            callback.apply(void 0, args);\n        }\n    }\n    function result() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        timestamp = Date.now();\n        timeout = setTimeout(function () { return later.apply(void 0, args); }, isFunction(delay) ? delay() : delay || 0);\n    }\n    result.clear = function () {\n        clearTimeout(timeout);\n    };\n    return result;\n}\n\nexport { debounce, deepClone, deepCompare, distance, emptyCoordinates, getCloserAngle, getDirectionNames, getOptions, isArray, isArrayBufferLike, isBlob, isCardinalDirection, isCrossOriginURL, isDataUrl, isFunction, isGreater, isLocal, isLower, isMouseEvent, isNaN, isNumber, isNumeric, isObject, isOrdinalDirection, isRoughlyEqual, isString, isTouchEvent, isUndefined, isWheelEvent, parseNumber, promiseTimeout, sign };\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","var ImageRestriction;\n(function (ImageRestriction) {\n    ImageRestriction[\"fillArea\"] = \"fillArea\";\n    ImageRestriction[\"fitArea\"] = \"fitArea\";\n    ImageRestriction[\"stencil\"] = \"stencil\";\n    ImageRestriction[\"none\"] = \"none\";\n})(ImageRestriction || (ImageRestriction = {}));\nvar Priority;\n(function (Priority) {\n    Priority[\"coordinates\"] = \"coordinates\";\n    Priority[\"visibleArea\"] = \"visibleArea\";\n})(Priority || (Priority = {}));\n\nexport { ImageRestriction, Priority };\n","import { __assign } from 'tslib';\nimport { emptyCoordinates, isUndefined } from '../utils/index.js';\nimport { mergePositionRestrictions, coordinatesToPositionRestrictions, applyScale, maxScale, applyMove, inverseMove, fitToPositionRestrictions } from '../service/utils.js';\nimport { getAspectRatio, getSizeRestrictions, getPositionRestrictions, getAreaSizeRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport { approximateSize } from '../service/approximateSize.js';\nimport { fitVisibleArea } from '../service/fitVisibleArea.js';\nimport { moveCoordinatesAlgorithm } from '../algorithms/moveCoordinatesAlgorithm.js';\n\nvar SetCoordinatesMode;\n(function (SetCoordinatesMode) {\n    SetCoordinatesMode[\"limit\"] = \"limit\";\n    SetCoordinatesMode[\"zoom\"] = \"zoom\";\n    SetCoordinatesMode[\"unsafe\"] = \"unsafe\";\n})(SetCoordinatesMode || (SetCoordinatesMode = {}));\nfunction setCoordinates(state, settings, transform, \n// If you set mode to `false`, the coordinates can leave the visible area\nmode) {\n    if (mode === void 0) { mode = true; }\n    var currentMode = mode === false ? SetCoordinatesMode.unsafe : mode === true ? SetCoordinatesMode.zoom : mode;\n    var aspectRatio = getAspectRatio(state, settings);\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    if (state.visibleArea && currentMode === SetCoordinatesMode.limit) {\n        sizeRestrictions = __assign(__assign({}, sizeRestrictions), { minWidth: Math.min(state.visibleArea.width, sizeRestrictions.minWidth), minHeight: Math.min(state.visibleArea.height, sizeRestrictions.minHeight), maxWidth: Math.min(state.visibleArea.width, sizeRestrictions.maxWidth), maxHeight: Math.min(state.visibleArea.height, sizeRestrictions.maxHeight) });\n    }\n    var positionRestrictions = getPositionRestrictions(state, settings);\n    if (state.visibleArea && currentMode === SetCoordinatesMode.limit) {\n        positionRestrictions = mergePositionRestrictions(positionRestrictions, coordinatesToPositionRestrictions(state.visibleArea));\n    }\n    var move = function (prevCoordinates, newCoordinates) {\n        return moveCoordinatesAlgorithm(prevCoordinates, {\n            left: newCoordinates.left - (prevCoordinates.left || 0),\n            top: newCoordinates.top - (prevCoordinates.top || 0),\n        }, positionRestrictions);\n    };\n    var resize = function (prevCoordinates, newCoordinates) {\n        var coordinates = __assign(__assign(__assign({}, prevCoordinates), approximateSize({\n            width: newCoordinates.width,\n            height: newCoordinates.height,\n            sizeRestrictions: sizeRestrictions,\n            aspectRatio: aspectRatio,\n        })), { left: 0, top: 0 });\n        return move(coordinates, {\n            left: prevCoordinates.left || 0,\n            top: prevCoordinates.top || 0,\n        });\n    };\n    var coordinates = state.coordinates ? __assign({}, state.coordinates) : emptyCoordinates();\n    var transforms = Array.isArray(transform) ? transform : [transform];\n    transforms.forEach(function (transform) {\n        var changes;\n        if (typeof transform === 'function') {\n            changes = transform(__assign(__assign({}, state), { coordinates: coordinates }), settings);\n        }\n        else {\n            changes = transform;\n        }\n        if (changes) {\n            if (!isUndefined(changes.width) || !isUndefined(changes.height)) {\n                coordinates = resize(coordinates, __assign(__assign({}, coordinates), changes));\n            }\n            if (!isUndefined(changes.left) || !isUndefined(changes.top)) {\n                coordinates = move(coordinates, __assign(__assign({}, coordinates), changes));\n            }\n        }\n    });\n    var result = __assign(__assign({}, copyState(state)), { coordinates: coordinates });\n    if (result.visibleArea && currentMode === SetCoordinatesMode.zoom) {\n        var widthIntersections = Math.max(0, result.coordinates.width - result.visibleArea.width);\n        var heightIntersections = Math.max(0, result.coordinates.height - result.visibleArea.height);\n        var areaSizeRestrictions = getAreaSizeRestrictions(state, settings);\n        var scale = widthIntersections > heightIntersections\n            ? result.coordinates.width / result.visibleArea.width\n            : result.coordinates.height / result.visibleArea.height;\n        if (scale > 1) {\n            result.visibleArea = applyScale(result.visibleArea, Math.min(scale, maxScale(result.visibleArea, areaSizeRestrictions)));\n        }\n        result.visibleArea = applyMove(result.visibleArea, inverseMove(fitToPositionRestrictions(result.coordinates, coordinatesToPositionRestrictions(result.visibleArea))));\n        return fitVisibleArea(result, settings);\n    }\n    else {\n        return result;\n    }\n}\n\nexport { SetCoordinatesMode, setCoordinates };\n","var ALL_DIRECTIONS = ['left', 'right', 'top', 'bottom'];\nvar HORIZONTAL_DIRECTIONS = ['left', 'right'];\nvar VERTICAL_DIRECTIONS = ['top', 'bottom'];\n\nexport { ALL_DIRECTIONS, HORIZONTAL_DIRECTIONS, VERTICAL_DIRECTIONS };\n","import { __assign } from 'tslib';\nimport { ALL_DIRECTIONS } from '../constants/index.js';\nimport { isLower, isGreater, isNumber, isNumeric, isUndefined, isFunction } from '../utils/index.js';\n\nfunction diff(firstObject, secondObject) {\n    return {\n        left: firstObject.left - secondObject.left,\n        top: firstObject.top - secondObject.top,\n    };\n}\nfunction getCenter(object) {\n    return {\n        left: object.left + object.width / 2,\n        top: object.top + object.height / 2,\n    };\n}\nfunction sizeDistance(a, b) {\n    return Math.pow(a.width - b.width, 2) + Math.pow(a.height - b.height, 2);\n}\nfunction applyDirections(coordinates, directions) {\n    return {\n        left: coordinates.left - directions.left,\n        top: coordinates.top - directions.top,\n        width: coordinates.width + directions.left + directions.right,\n        height: coordinates.height + directions.top + directions.bottom,\n    };\n}\nfunction inverseMove(directions) {\n    return {\n        left: -directions.left,\n        top: -directions.top,\n    };\n}\nfunction applyMove(object, move) {\n    return __assign(__assign({}, object), { left: object.left + move.left, top: object.top + move.top });\n}\nfunction coordinatesToPositionRestrictions(coordinates) {\n    return {\n        left: coordinates.left,\n        top: coordinates.top,\n        right: coordinates.left + coordinates.width,\n        bottom: coordinates.top + coordinates.height,\n    };\n}\nfunction applyScale(object, factor, center, progress) {\n    if (factor !== 1) {\n        if ('left' in object || 'top' in object) {\n            if (center) {\n                var currentCenter = getCenter(object);\n                return {\n                    width: object.width * factor,\n                    height: object.height * factor,\n                    left: object.left +\n                        (object.width * (1 - factor)) / 2 +\n                        (center.left - currentCenter.left) * (progress || 1 - factor),\n                    top: object.top +\n                        (object.height * (1 - factor)) / 2 +\n                        (center.top - currentCenter.top) * (progress || 1 - factor),\n                };\n            }\n            else {\n                return {\n                    width: object.width * factor,\n                    height: object.height * factor,\n                    left: object.left + (object.width * (1 - factor)) / 2,\n                    top: object.top + (object.height * (1 - factor)) / 2,\n                };\n            }\n        }\n        else {\n            return {\n                width: object.width * factor,\n                height: object.height * factor,\n            };\n        }\n    }\n    else {\n        return object;\n    }\n}\nfunction ratio(object) {\n    return object.width / object.height;\n}\nfunction maxScale(size, restrictions) {\n    return Math.min(restrictions.maxWidth ? restrictions.maxWidth / size.width : Infinity, restrictions.maxHeight ? restrictions.maxHeight / size.height : Infinity);\n}\nfunction minScale(size, restrictions) {\n    return Math.max(restrictions.minWidth ? restrictions.minWidth / size.width : 0, restrictions.minHeight ? restrictions.minHeight / size.height : 0);\n}\nfunction getBrokenRatio(currentAspectRatio, aspectRatio) {\n    var ratioBroken;\n    if (aspectRatio.minimum && isLower(currentAspectRatio, aspectRatio.minimum)) {\n        ratioBroken = aspectRatio.minimum;\n    }\n    else if (aspectRatio.maximum && isGreater(currentAspectRatio, aspectRatio.maximum)) {\n        ratioBroken = aspectRatio.maximum;\n    }\n    return ratioBroken;\n}\nfunction fitToSizeRestrictions(coordinates, sizeRestrictions) {\n    var aspectRatio = ratio(coordinates);\n    var scale = 1;\n    if (sizeRestrictions.minWidth > 0 && sizeRestrictions.minHeight > 0) {\n        if (aspectRatio > sizeRestrictions.minWidth / sizeRestrictions.minHeight) {\n            if (coordinates.height < sizeRestrictions.minHeight) {\n                scale = sizeRestrictions.minHeight / coordinates.height;\n            }\n        }\n        else {\n            if (coordinates.width < sizeRestrictions.minWidth) {\n                scale = sizeRestrictions.minWidth / coordinates.width;\n            }\n        }\n    }\n    else if (sizeRestrictions.minWidth > 0) {\n        if (coordinates.width < sizeRestrictions.minWidth) {\n            scale = sizeRestrictions.minWidth / coordinates.width;\n        }\n    }\n    else if (sizeRestrictions.minHeight > 0) {\n        if (coordinates.height < sizeRestrictions.minHeight) {\n            scale = sizeRestrictions.minHeight / coordinates.height;\n        }\n    }\n    if (sizeRestrictions.maxWidth < Infinity && sizeRestrictions.maxHeight < Infinity) {\n        if (aspectRatio > sizeRestrictions.maxWidth / sizeRestrictions.maxHeight) {\n            if (coordinates.width > sizeRestrictions.maxWidth) {\n                scale = sizeRestrictions.maxWidth / coordinates.width;\n            }\n        }\n        else {\n            if (coordinates.height > sizeRestrictions.maxHeight) {\n                scale = sizeRestrictions.maxHeight / coordinates.height;\n            }\n        }\n    }\n    else if (sizeRestrictions.maxWidth < Infinity) {\n        if (coordinates.width > sizeRestrictions.maxWidth) {\n            scale = sizeRestrictions.maxWidth / coordinates.width;\n        }\n    }\n    else if (sizeRestrictions.maxHeight < Infinity) {\n        if (coordinates.height > sizeRestrictions.maxHeight) {\n            scale = sizeRestrictions.maxHeight / coordinates.height;\n        }\n    }\n    return scale;\n}\nfunction getIntersections(object, positionRestrictions) {\n    var intersections = {\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n    };\n    ALL_DIRECTIONS.forEach(function (direction) {\n        var areaLimit = positionRestrictions[direction];\n        var objectLimit = coordinatesToPositionRestrictions(object)[direction];\n        if (areaLimit !== undefined && objectLimit !== undefined) {\n            if (direction === 'left' || direction === 'top') {\n                intersections[direction] = Math.max(0, areaLimit - objectLimit);\n            }\n            else {\n                intersections[direction] = Math.max(0, objectLimit - areaLimit);\n            }\n        }\n        else {\n            intersections[direction] = 0;\n        }\n    });\n    return intersections;\n}\nfunction resizeToSizeRestrictions(coordinates, sizeRestrictions) {\n    return applyScale(coordinates, fitToSizeRestrictions(coordinates, sizeRestrictions));\n}\nfunction rotateSize(size, angle) {\n    var radians = (angle * Math.PI) / 180;\n    return {\n        width: Math.abs(size.width * Math.cos(radians)) + Math.abs(size.height * Math.sin(radians)),\n        height: Math.abs(size.width * Math.sin(radians)) + Math.abs(size.height * Math.cos(radians)),\n    };\n}\nfunction rotatePoint(point, angle, anchor) {\n    var radians = (angle * Math.PI) / 180;\n    if (anchor) {\n        return {\n            left: (point.left - anchor.left) * Math.cos(radians) -\n                (point.top - anchor.top) * Math.sin(radians) +\n                anchor.left,\n            top: (point.left - anchor.left) * Math.sin(radians) +\n                (point.top - anchor.top) * Math.cos(radians) +\n                anchor.top,\n        };\n    }\n    else {\n        return {\n            left: point.left * Math.cos(radians) - point.top * Math.sin(radians),\n            top: point.left * Math.sin(radians) + point.top * Math.cos(radians),\n        };\n    }\n}\nfunction positionToSizeRestrictions(positionRestrictions) {\n    return {\n        minWidth: 0,\n        minHeight: 0,\n        maxWidth: positionRestrictions.right !== undefined && positionRestrictions.left !== undefined\n            ? positionRestrictions.right - positionRestrictions.left\n            : Infinity,\n        maxHeight: positionRestrictions.bottom !== undefined && positionRestrictions.top !== undefined\n            ? positionRestrictions.bottom - positionRestrictions.top\n            : Infinity,\n    };\n}\nfunction mergePositionRestrictions(a, b) {\n    var restrictions = {};\n    ALL_DIRECTIONS.forEach(function (direction) {\n        var firstDirection = a[direction];\n        var secondDirection = b[direction];\n        if (firstDirection !== undefined && secondDirection !== undefined) {\n            if (direction === 'left' || direction === 'top') {\n                restrictions[direction] = Math.max(firstDirection, secondDirection);\n            }\n            else {\n                restrictions[direction] = Math.min(firstDirection, secondDirection);\n            }\n        }\n        else if (secondDirection !== undefined) {\n            restrictions[direction] = secondDirection;\n        }\n        else if (firstDirection !== undefined) {\n            restrictions[direction] = firstDirection;\n        }\n    });\n    return restrictions;\n}\nfunction fitToPositionRestrictions(coordinates, positionRestrictions) {\n    var directions = {\n        left: 0,\n        top: 0,\n    };\n    var intersection = getIntersections(coordinates, positionRestrictions);\n    if (intersection.left && intersection.left > 0) {\n        directions.left = intersection.left;\n    }\n    else if (intersection.right && intersection.right > 0) {\n        directions.left = -intersection.right;\n    }\n    if (intersection.top && intersection.top > 0) {\n        directions.top = intersection.top;\n    }\n    else if (intersection.bottom && intersection.bottom > 0) {\n        directions.top = -intersection.bottom;\n    }\n    return directions;\n}\nfunction moveToPositionRestrictions(coordinates, positionRestrictions) {\n    return applyMove(coordinates, fitToPositionRestrictions(coordinates, positionRestrictions));\n}\nfunction aspectRatioIntersection(main, subset) {\n    if (!subset) {\n        return main;\n    }\n    else if (!main) {\n        return subset;\n    }\n    else {\n        return {\n            minimum: Math.min(main.maximum, Math.max(main.minimum, subset.minimum)),\n            maximum: Math.max(main.minimum, Math.min(main.maximum, subset.maximum)),\n        };\n    }\n}\nfunction createAspectRatio(aspectRatio) {\n    if (aspectRatio === void 0) { aspectRatio = {}; }\n    if (isNumber(aspectRatio)) {\n        return {\n            minimum: aspectRatio,\n            maximum: aspectRatio,\n        };\n    }\n    else {\n        return {\n            minimum: isNumeric(aspectRatio.minimum) ? aspectRatio.minimum : 0,\n            maximum: isNumeric(aspectRatio.maximum) ? aspectRatio.maximum : Infinity,\n        };\n    }\n}\nfunction getTransitionStyle(transitions) {\n    return transitions ? transitions.timingFunction + \" \" + (transitions.active ? transitions.duration : 0) + \"ms\" : 'none';\n}\nfunction isConsistentSize(size, restrictions) {\n    return ((isUndefined(restrictions.maxWidth) || !isGreater(size.width, restrictions.maxWidth)) &&\n        (isUndefined(restrictions.maxHeight) || !isGreater(size.height, restrictions.maxHeight)) &&\n        (isUndefined(restrictions.minHeight) || !isLower(size.height, restrictions.minHeight)) &&\n        (isUndefined(restrictions.minWidth) || !isLower(size.width, restrictions.minWidth)));\n}\nfunction isConsistentPosition(coordinates, restrictions) {\n    return ((isUndefined(restrictions.left) || !isLower(coordinates.left, restrictions.left)) &&\n        (isUndefined(restrictions.top) || !isLower(coordinates.top, restrictions.top)) &&\n        (isUndefined(restrictions.right) || !isGreater(coordinates.left + coordinates.width, restrictions.right)) &&\n        (isUndefined(restrictions.bottom) || !isGreater(coordinates.top + coordinates.height, restrictions.bottom)));\n}\nfunction getCloserSize(candidates, reference, sizeRestrictions, aspectRatio) {\n    var traverse = function (ignoreMinimum) {\n        return candidates.reduce(function (minimum, size) {\n            var _a = isFunction(sizeRestrictions)\n                ? sizeRestrictions(size)\n                : sizeRestrictions, maxHeight = _a.maxHeight, maxWidth = _a.maxWidth, minWidth = _a.minWidth, minHeight = _a.minHeight;\n            var preparedAspectRatio = createAspectRatio(isFunction(aspectRatio) ? aspectRatio(size) : aspectRatio);\n            var preparedSizeRestrictions = ignoreMinimum\n                ? { maxWidth: maxWidth, maxHeight: maxHeight }\n                : { maxWidth: maxWidth, maxHeight: maxHeight, minWidth: minWidth, minHeight: minHeight };\n            if (isConsistentSize(size, preparedSizeRestrictions) &&\n                !getBrokenRatio(ratio(size), preparedAspectRatio) &&\n                size.width &&\n                size.height) {\n                return !minimum || isLower(sizeDistance(size, reference), sizeDistance(minimum, reference))\n                    ? size\n                    : minimum;\n            }\n            else {\n                return minimum;\n            }\n        }, null);\n    };\n    return traverse() || traverse(true);\n}\n\nexport { applyDirections, applyMove, applyScale, aspectRatioIntersection, coordinatesToPositionRestrictions, createAspectRatio, diff, fitToPositionRestrictions, fitToSizeRestrictions, getBrokenRatio, getCenter, getCloserSize, getIntersections, getTransitionStyle, inverseMove, isConsistentPosition, isConsistentSize, maxScale, mergePositionRestrictions, minScale, moveToPositionRestrictions, positionToSizeRestrictions, ratio, resizeToSizeRestrictions, rotatePoint, rotateSize, sizeDistance };\n","import { isFunction, emptyCoordinates } from '../utils/index.js';\nimport { createAspectRatio, rotateSize, moveToPositionRestrictions, getBrokenRatio, ratio, isConsistentSize, isConsistentPosition } from './utils.js';\nimport { calculateAreaSizeRestrictions, calculateSizeRestrictions } from './sizeRestrictions.js';\n\nfunction isInitializedState(state) {\n    return Boolean(state && state.visibleArea && state.coordinates);\n}\nfunction getAreaSizeRestrictions(state, settings) {\n    return calculateAreaSizeRestrictions(state, settings);\n}\nfunction getAreaPositionRestrictions(state, settings) {\n    return isFunction(settings.areaPositionRestrictions)\n        ? settings.areaPositionRestrictions(state, settings)\n        : settings.areaPositionRestrictions;\n}\nfunction getSizeRestrictions(state, settings) {\n    return calculateSizeRestrictions(state, settings);\n}\nfunction getPositionRestrictions(state, settings) {\n    return isFunction(settings.positionRestrictions)\n        ? settings.positionRestrictions(state, settings)\n        : settings.positionRestrictions;\n}\nfunction getCoefficient(state) {\n    return state.visibleArea ? state.visibleArea.width / state.boundary.width : 0;\n}\nfunction getStencilCoordinates(state) {\n    if (isInitializedState(state)) {\n        var _a = state.coordinates, width = _a.width, height = _a.height, left = _a.left, top_1 = _a.top;\n        var coefficient = getCoefficient(state);\n        return {\n            width: width / coefficient,\n            height: height / coefficient,\n            left: (left - state.visibleArea.left) / coefficient,\n            top: (top_1 - state.visibleArea.top) / coefficient,\n        };\n    }\n    else {\n        return emptyCoordinates();\n    }\n}\nfunction getAspectRatio(state, settings) {\n    return createAspectRatio(isFunction(settings.aspectRatio) ? settings.aspectRatio(state, settings) : settings.aspectRatio);\n}\nfunction getDefaultCoordinates(state, settings) {\n    return isFunction(settings.defaultCoordinates)\n        ? settings.defaultCoordinates(state, settings)\n        : settings.defaultCoordinates;\n}\nfunction getDefaultVisibleArea(state, settings) {\n    return isFunction(settings.defaultVisibleArea)\n        ? settings.defaultVisibleArea(state, settings)\n        : settings.defaultVisibleArea;\n}\nfunction getTransformedImageSize(state) {\n    if (state.imageSize && state.imageSize.width && state.imageSize.height) {\n        return rotateSize(state.imageSize, state.transforms.rotate);\n    }\n    else {\n        return {\n            width: 0,\n            height: 0,\n        };\n    }\n}\nfunction getMinimumSize(state) {\n    // The magic number is the approximation of the handler size\n    // Temporary solution that should be improved in the future\n    return state.coordinates\n        ? Math.min(state.coordinates.width, state.coordinates.height, 20 * getCoefficient(state))\n        : 1;\n}\nfunction getRoundedCoordinates(state, settings) {\n    if (isInitializedState(state)) {\n        var sizeRestrictions = getSizeRestrictions(state, settings);\n        var positionRestrictions = getPositionRestrictions(state, settings);\n        var roundCoordinates = {\n            width: Math.round(state.coordinates.width),\n            height: Math.round(state.coordinates.height),\n            left: Math.round(state.coordinates.left),\n            top: Math.round(state.coordinates.top),\n        };\n        if (roundCoordinates.width > sizeRestrictions.maxWidth) {\n            roundCoordinates.width = Math.floor(state.coordinates.width);\n        }\n        else if (roundCoordinates.width < sizeRestrictions.minWidth) {\n            roundCoordinates.width = Math.ceil(state.coordinates.width);\n        }\n        if (roundCoordinates.height > sizeRestrictions.maxHeight) {\n            roundCoordinates.height = Math.floor(state.coordinates.height);\n        }\n        else if (roundCoordinates.height < sizeRestrictions.minHeight) {\n            roundCoordinates.height = Math.ceil(state.coordinates.height);\n        }\n        return moveToPositionRestrictions(roundCoordinates, positionRestrictions);\n    }\n    else {\n        return null;\n    }\n}\nfunction isConsistentState(state, settings) {\n    if (isInitializedState(state)) {\n        return (!getBrokenRatio(ratio(state.coordinates), getAspectRatio(state, settings)) &&\n            isConsistentSize(state.visibleArea, getAreaSizeRestrictions(state, settings)) &&\n            isConsistentSize(state.coordinates, getSizeRestrictions(state, settings)) &&\n            isConsistentPosition(state.visibleArea, getAreaPositionRestrictions(state, settings)) &&\n            isConsistentPosition(state.coordinates, getPositionRestrictions(state, settings)));\n    }\n    else {\n        return true;\n    }\n}\n\nexport { getAreaPositionRestrictions, getAreaSizeRestrictions, getAspectRatio, getCoefficient, getDefaultCoordinates, getDefaultVisibleArea, getMinimumSize, getPositionRestrictions, getRoundedCoordinates, getSizeRestrictions, getStencilCoordinates, getTransformedImageSize, isConsistentState, isInitializedState };\n","import { __assign } from 'tslib';\nimport { isFunction, isNumeric, parseNumber } from '../utils/index.js';\nimport { ratio } from './utils.js';\nimport { getPositionRestrictions } from './helpers.js';\n\nfunction reconcileSizeRestrictions(sizeRestrictions) {\n    var restrictions = __assign({}, sizeRestrictions);\n    // Process the border cases when minimum height / width larger than maximum height / width\n    if (restrictions.minWidth > restrictions.maxWidth) {\n        restrictions.minWidth = restrictions.maxWidth;\n    }\n    if (restrictions.minHeight > restrictions.maxHeight) {\n        restrictions.minHeight = restrictions.maxHeight;\n    }\n    return restrictions;\n}\nfunction mergeSizeRestrictions(a, b) {\n    var first = a;\n    var second = __assign({ minWidth: 0, minHeight: 0, maxWidth: Infinity, maxHeight: Infinity }, b);\n    return reconcileSizeRestrictions({\n        maxHeight: Math.min(first.maxHeight, second.maxHeight),\n        minHeight: Math.max(first.minHeight, second.minHeight),\n        maxWidth: Math.min(first.maxWidth, second.maxWidth),\n        minWidth: Math.max(first.minWidth, second.minWidth),\n    });\n}\nfunction calculateSizeRestrictions(state, settings) {\n    var sizeRestrictions = isFunction(settings.sizeRestrictions)\n        ? settings.sizeRestrictions(state, settings)\n        : settings.sizeRestrictions;\n    var positionRestrictions = getPositionRestrictions(state, settings);\n    // User can forget to set some of restrictions, so we should initialize them by default values\n    var restrictions = {\n        minWidth: isNumeric(sizeRestrictions.minWidth) ? parseNumber(sizeRestrictions.minWidth) : 0,\n        minHeight: isNumeric(sizeRestrictions.minHeight) ? parseNumber(sizeRestrictions.minHeight) : 0,\n        maxWidth: isNumeric(sizeRestrictions.maxWidth) ? parseNumber(sizeRestrictions.maxWidth) : Infinity,\n        maxHeight: isNumeric(sizeRestrictions.maxHeight) ? parseNumber(sizeRestrictions.maxHeight) : Infinity,\n    };\n    // The situation, when stencil can't be positioned in cropper due to positionRestrictions should be avoided\n    if (positionRestrictions.left !== undefined && positionRestrictions.right !== undefined) {\n        restrictions.maxWidth = Math.min(restrictions.maxWidth, positionRestrictions.right - positionRestrictions.left);\n    }\n    if (positionRestrictions.bottom !== undefined && positionRestrictions.top !== undefined) {\n        restrictions.maxHeight = Math.min(restrictions.maxHeight, positionRestrictions.bottom - positionRestrictions.top);\n    }\n    return reconcileSizeRestrictions(restrictions);\n}\nfunction calculateAreaSizeRestrictions(state, settings) {\n    var sizeRestrictions = isFunction(settings.areaSizeRestrictions)\n        ? settings.areaSizeRestrictions(state, settings)\n        : settings.areaSizeRestrictions;\n    if (sizeRestrictions.maxWidth < Infinity && sizeRestrictions.maxHeight < Infinity) {\n        if (ratio(state.boundary) > sizeRestrictions.maxWidth / sizeRestrictions.maxHeight) {\n            sizeRestrictions.maxHeight = sizeRestrictions.maxWidth / ratio(state.boundary);\n        }\n        else {\n            sizeRestrictions.maxWidth = sizeRestrictions.maxHeight * ratio(state.boundary);\n        }\n    }\n    return reconcileSizeRestrictions(sizeRestrictions);\n}\n\nexport { calculateAreaSizeRestrictions, calculateSizeRestrictions, mergeSizeRestrictions, reconcileSizeRestrictions };\n","import { deepClone } from '../utils/index.js';\n\nfunction copyState(state) {\n    return deepClone(state);\n}\n\nexport { copyState };\n","import { getCloserSize, createAspectRatio, resizeToSizeRestrictions } from './utils.js';\n\n// Limitations:\n// 1. Assume that maximum width and height always larger than minimum width and height\n// 2. Assume that aspectRatio.minimum < aspectRatio.maximum\n// If you break this limitations function could return null!\nfunction approximateSize(params) {\n    var width = params.width, height = params.height;\n    var sizeRestrictions = params.sizeRestrictions || {\n        minWidth: 0,\n        minHeight: 0,\n        maxWidth: Infinity,\n        maxHeight: Infinity,\n    };\n    var aspectRatio = createAspectRatio(params.aspectRatio);\n    var coordinates = {\n        width: Math.max(sizeRestrictions.minWidth, Math.min(sizeRestrictions.maxWidth, width)),\n        height: Math.max(sizeRestrictions.minHeight, Math.min(sizeRestrictions.maxHeight, height)),\n    };\n    var candidates = [coordinates];\n    if (aspectRatio) {\n        [aspectRatio.minimum, aspectRatio.maximum].forEach(function (ratio) {\n            if (ratio) {\n                candidates.push({ width: coordinates.width, height: coordinates.width / ratio }, { width: coordinates.height * ratio, height: coordinates.height });\n            }\n        });\n    }\n    // Resize the candidates as much as possible to prevent breaking minimum size\n    candidates = candidates.map(function (candidate) { return resizeToSizeRestrictions(candidate, sizeRestrictions); });\n    // TODO: fix the type of return value\n    return getCloserSize(candidates, { width: width, height: height }, sizeRestrictions, aspectRatio);\n}\n\nexport { approximateSize };\n","import { __assign } from 'tslib';\nimport { ratio, applyMove, diff, getCenter, moveToPositionRestrictions } from './utils.js';\nimport { getAreaSizeRestrictions, getAreaPositionRestrictions } from './helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from './approximateSize.js';\n\nfunction fitVisibleArea(state, settings) {\n    var result = copyState(state);\n    if (state.visibleArea) {\n        var areaSizeRestrictions = getAreaSizeRestrictions(state, settings);\n        // Fit the visible area to its size restrictions and boundary aspect ratio:\n        result.visibleArea = __assign(__assign({}, state.visibleArea), approximateSize({\n            width: state.visibleArea.width,\n            height: state.visibleArea.height,\n            aspectRatio: {\n                minimum: ratio(result.boundary),\n                maximum: ratio(result.boundary),\n            },\n            sizeRestrictions: areaSizeRestrictions,\n        }));\n        // Return the visible area to previous center\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(state.visibleArea), getCenter(result.visibleArea)));\n        // Fit the visible area to positions restrictions\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n    }\n    return result;\n}\n\nexport { fitVisibleArea };\n","import 'tslib';\nimport { moveToPositionRestrictions, applyMove } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction moveCoordinatesAlgorithm(coordinates, directions, positionRestrictions) {\n    var movedCoordinates = applyMove(coordinates, directions);\n    return positionRestrictions ? moveToPositionRestrictions(movedCoordinates, positionRestrictions) : movedCoordinates;\n}\n\nexport { moveCoordinatesAlgorithm };\n","import { __assign } from 'tslib';\nimport { applyMove, diff, getCenter, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from './utils.js';\nimport { getAspectRatio, getSizeRestrictions, getPositionRestrictions } from './helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from './approximateSize.js';\n\nfunction fitCoordinates(state, settings) {\n    if (state.coordinates) {\n        var result = copyState(state);\n        var aspectRatio = getAspectRatio(state, settings);\n        var sizeRestrictions = getSizeRestrictions(state, settings);\n        // Fit the size of coordinates to existing size restrictions and visible area\n        result.coordinates = __assign(__assign({}, state.coordinates), approximateSize({\n            width: state.coordinates.width,\n            height: state.coordinates.height,\n            aspectRatio: aspectRatio,\n            sizeRestrictions: state.visibleArea\n                ? {\n                    maxWidth: Math.min(state.visibleArea.width, sizeRestrictions.maxWidth),\n                    maxHeight: Math.min(state.visibleArea.height, sizeRestrictions.maxHeight),\n                    minHeight: Math.min(state.visibleArea.height, sizeRestrictions.minHeight),\n                    minWidth: Math.min(state.visibleArea.width, sizeRestrictions.minWidth),\n                }\n                : sizeRestrictions,\n        }));\n        // Return the coordinates to the previous center\n        result.coordinates = applyMove(result.coordinates, diff(getCenter(state.coordinates), getCenter(result.coordinates)));\n        // Fit the coordinates to position restrictions and visible area\n        result.coordinates = moveToPositionRestrictions(result.coordinates, state.visibleArea\n            ? mergePositionRestrictions(coordinatesToPositionRestrictions(state.visibleArea), getPositionRestrictions(result, settings))\n            : getPositionRestrictions(result, settings));\n        return result;\n    }\n    return state;\n}\n\nexport { fitCoordinates };\n","import { __assign } from 'tslib';\nimport { copyState } from './copyState.js';\nimport { fitCoordinates } from '../service/fitCoordinates.js';\nimport { fitVisibleArea } from '../service/fitVisibleArea.js';\n\nfunction setVisibleArea(state, settings, visibleArea, \n// If you set safe to `false`, the coordinates will be able to leave the visible area\nsafe) {\n    if (safe === void 0) { safe = true; }\n    var result = __assign(__assign({}, copyState(state)), { visibleArea: visibleArea });\n    // There is no possibility to break visible area limitations.\n    result = fitVisibleArea(result, settings);\n    if (safe) {\n        result = fitCoordinates(result, settings);\n    }\n    return result;\n}\n\nexport { setVisibleArea };\n","import 'tslib';\nimport { getDefaultVisibleArea, getDefaultCoordinates } from '../service/helpers.js';\nimport { Priority } from '../types/index.js';\nimport { setCoordinates, SetCoordinatesMode } from './setCoordinates.js';\nimport { setVisibleArea } from './setVisibleArea.js';\n\nfunction createState(options, settings) {\n    var _a, _b;\n    var boundary = options.boundary, imageSize = options.imageSize, transforms = options.transforms, priority = options.priority;\n    var state = {\n        boundary: {\n            width: boundary.width,\n            height: boundary.height,\n        },\n        imageSize: {\n            width: imageSize.width,\n            height: imageSize.height,\n        },\n        transforms: {\n            rotate: (transforms === null || transforms === void 0 ? void 0 : transforms.rotate) || 0,\n            flip: {\n                horizontal: ((_a = transforms === null || transforms === void 0 ? void 0 : transforms.flip) === null || _a === void 0 ? void 0 : _a.horizontal) || false,\n                vertical: ((_b = transforms === null || transforms === void 0 ? void 0 : transforms.flip) === null || _b === void 0 ? void 0 : _b.vertical) || false,\n            },\n        },\n        visibleArea: null,\n        coordinates: null,\n    };\n    if (priority === Priority.visibleArea) {\n        state = setVisibleArea(state, settings, getDefaultVisibleArea(state, settings), false);\n        state = setCoordinates(state, settings, getDefaultCoordinates(state, settings), SetCoordinatesMode.limit);\n    }\n    else {\n        state = setCoordinates(state, settings, getDefaultCoordinates(state, settings), SetCoordinatesMode.unsafe);\n        state = setVisibleArea(state, settings, getDefaultVisibleArea(state, settings), true);\n    }\n    return state;\n}\n\nexport { createState };\n","import 'tslib';\nimport { applyMove, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from '../service/utils.js';\nimport { isInitializedState, getPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\n\nfunction moveCoordinates(state, settings, directions) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        result.coordinates = applyMove(result.coordinates, directions);\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), getPositionRestrictions(result, settings)));\n        return result;\n    }\n    return state;\n}\n\nexport { moveCoordinates };\n","import { __assign } from 'tslib';\nimport { ALL_DIRECTIONS, HORIZONTAL_DIRECTIONS, VERTICAL_DIRECTIONS } from '../constants/index.js';\nimport { isRoughlyEqual } from '../utils/index.js';\nimport { applyDirections, getIntersections, ratio, getBrokenRatio } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { moveCoordinatesAlgorithm } from './moveCoordinatesAlgorithm.js';\n\nfunction fitDirections(_a) {\n    var coordinates = _a.coordinates, directions = _a.directions, positionRestrictions = _a.positionRestrictions, sizeRestrictions = _a.sizeRestrictions, preserveRatio = _a.preserveRatio, compensate = _a.compensate;\n    var fittedDirections = __assign({}, directions);\n    var currentWidth = applyDirections(coordinates, fittedDirections).width;\n    var currentHeight = applyDirections(coordinates, fittedDirections).height;\n    // Prevent strange resizes when the width or height of stencil becomes smaller than 0\n    if (currentWidth < 0) {\n        if (fittedDirections.left < 0 && fittedDirections.right < 0) {\n            fittedDirections.left =\n                -(coordinates.width - sizeRestrictions.minWidth) / (fittedDirections.left / fittedDirections.right);\n            fittedDirections.right =\n                -(coordinates.width - sizeRestrictions.minWidth) / (fittedDirections.right / fittedDirections.left);\n        }\n        else if (fittedDirections.left < 0) {\n            fittedDirections.left = -(coordinates.width - sizeRestrictions.minWidth);\n        }\n        else if (fittedDirections.right < 0) {\n            fittedDirections.right = -(coordinates.width - sizeRestrictions.minWidth);\n        }\n    }\n    if (currentHeight < 0) {\n        if (fittedDirections.top < 0 && fittedDirections.bottom < 0) {\n            fittedDirections.top =\n                -(coordinates.height - sizeRestrictions.minHeight) / (fittedDirections.top / fittedDirections.bottom);\n            fittedDirections.bottom =\n                -(coordinates.height - sizeRestrictions.minHeight) / (fittedDirections.bottom / fittedDirections.top);\n        }\n        else if (fittedDirections.top < 0) {\n            fittedDirections.top = -(coordinates.height - sizeRestrictions.minHeight);\n        }\n        else if (fittedDirections.bottom < 0) {\n            fittedDirections.bottom = -(coordinates.height - sizeRestrictions.minHeight);\n        }\n    }\n    // Prevent breaking limits\n    var breaks = getIntersections(applyDirections(coordinates, fittedDirections), positionRestrictions);\n    if (compensate) {\n        if (breaks.left && breaks.left > 0 && breaks.right === 0) {\n            fittedDirections.right += breaks.left;\n            fittedDirections.left -= breaks.left;\n        }\n        else if (breaks.right && breaks.right > 0 && breaks.left === 0) {\n            fittedDirections.left += breaks.right;\n            fittedDirections.right -= breaks.right;\n        }\n        if (breaks.top && breaks.top > 0 && breaks.bottom === 0) {\n            fittedDirections.bottom += breaks.top;\n            fittedDirections.top -= breaks.top;\n        }\n        else if (breaks.bottom && breaks.bottom > 0 && breaks.top === 0) {\n            fittedDirections.top += breaks.bottom;\n            fittedDirections.bottom -= breaks.bottom;\n        }\n        breaks = getIntersections(applyDirections(coordinates, fittedDirections), positionRestrictions);\n    }\n    var maxResize = {\n        width: Infinity,\n        height: Infinity,\n        left: Infinity,\n        right: Infinity,\n        top: Infinity,\n        bottom: Infinity,\n    };\n    ALL_DIRECTIONS.forEach(function (direction) {\n        var intersection = breaks[direction];\n        if (intersection && fittedDirections[direction]) {\n            maxResize[direction] = Math.max(0, 1 - intersection / fittedDirections[direction]);\n        }\n    });\n    if (preserveRatio) {\n        var multiplier_1 = Math.min.apply(Math, ALL_DIRECTIONS.map(function (direction) { return maxResize[direction]; }));\n        if (multiplier_1 !== Infinity) {\n            ALL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= multiplier_1;\n            });\n        }\n    }\n    else {\n        ALL_DIRECTIONS.forEach(function (direction) {\n            if (maxResize[direction] !== Infinity) {\n                fittedDirections[direction] *= maxResize[direction];\n            }\n        });\n    }\n    currentWidth = applyDirections(coordinates, fittedDirections).width;\n    currentHeight = applyDirections(coordinates, fittedDirections).height;\n    if (fittedDirections.right + fittedDirections.left) {\n        if (currentWidth > sizeRestrictions.maxWidth) {\n            maxResize.width =\n                (sizeRestrictions.maxWidth - coordinates.width) / (fittedDirections.right + fittedDirections.left);\n        }\n        else if (currentWidth < sizeRestrictions.minWidth) {\n            maxResize.width =\n                (sizeRestrictions.minWidth - coordinates.width) / (fittedDirections.right + fittedDirections.left);\n        }\n    }\n    if (fittedDirections.bottom + fittedDirections.top) {\n        if (currentHeight > sizeRestrictions.maxHeight) {\n            maxResize.height =\n                (sizeRestrictions.maxHeight - coordinates.height) / (fittedDirections.bottom + fittedDirections.top);\n        }\n        else if (currentHeight < sizeRestrictions.minHeight) {\n            maxResize.height =\n                (sizeRestrictions.minHeight - coordinates.height) / (fittedDirections.bottom + fittedDirections.top);\n        }\n    }\n    if (preserveRatio) {\n        var multiplier_2 = Math.min(maxResize.width, maxResize.height);\n        if (multiplier_2 !== Infinity) {\n            ALL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= multiplier_2;\n            });\n        }\n    }\n    else {\n        if (maxResize.width !== Infinity) {\n            HORIZONTAL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= maxResize.width;\n            });\n        }\n        if (maxResize.height !== Infinity) {\n            VERTICAL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= maxResize.height;\n            });\n        }\n    }\n    return fittedDirections;\n}\nfunction distributeOverlap(overlap, first, second) {\n    if (isRoughlyEqual(first + second, 0)) {\n        return overlap / 2;\n    }\n    else if (isRoughlyEqual(first, 0)) {\n        return 0;\n    }\n    else if (isRoughlyEqual(second, 0)) {\n        return overlap;\n    }\n    else {\n        return overlap * Math.abs(first / (first + second));\n    }\n}\nfunction resizeCoordinatesAlgorithm(coordinates, directions, options, limitations) {\n    var aspectRatio = limitations.aspectRatio, positionRestrictions = limitations.positionRestrictions, sizeRestrictions = limitations.sizeRestrictions;\n    var actualCoordinates = __assign(__assign({}, coordinates), { right: coordinates.left + coordinates.width, bottom: coordinates.top + coordinates.height });\n    directions = __assign({}, directions);\n    var allowedDirections = options.allowedDirections || {\n        left: true,\n        right: true,\n        bottom: true,\n        top: true,\n    };\n    // It's possible that coordinates can be smaller than minimum width or minimum height. In this case\n    // corresponding resize should be blocked\n    if (coordinates.width < sizeRestrictions.minWidth) {\n        directions.left = 0;\n        directions.right = 0;\n    }\n    if (coordinates.height < sizeRestrictions.minHeight) {\n        directions.top = 0;\n        directions.bottom = 0;\n    }\n    ALL_DIRECTIONS.forEach(function (direction) {\n        if (!allowedDirections[direction]) {\n            directions[direction] = 0;\n        }\n    });\n    // 1. First step: determine the safe and desired area\n    directions = fitDirections({\n        coordinates: actualCoordinates,\n        directions: directions,\n        sizeRestrictions: sizeRestrictions,\n        positionRestrictions: positionRestrictions,\n    });\n    // 2. Second step: fix desired box to correspondent to aspect ratio\n    var currentWidth = applyDirections(actualCoordinates, directions).width;\n    var currentHeight = applyDirections(actualCoordinates, directions).height;\n    // Checks ratio:\n    var ratioBroken = options.preserveAspectRatio\n        ? ratio(actualCoordinates)\n        : getBrokenRatio(currentWidth / currentHeight, aspectRatio);\n    if (ratioBroken) {\n        var respectDirection = options.respectDirection;\n        if (respectDirection !== 'width' && respectDirection !== 'height') {\n            if (actualCoordinates.width >= actualCoordinates.height || ratioBroken === 1) {\n                respectDirection = 'width';\n            }\n            else {\n                respectDirection = 'height';\n            }\n        }\n        if (respectDirection === 'width') {\n            var overlapHeight = currentWidth / ratioBroken - actualCoordinates.height;\n            if (allowedDirections.top && allowedDirections.bottom) {\n                var top_1 = directions.top, bottom = directions.bottom;\n                directions.bottom = distributeOverlap(overlapHeight, bottom, top_1);\n                directions.top = distributeOverlap(overlapHeight, top_1, bottom);\n            }\n            else if (allowedDirections.bottom) {\n                directions.bottom = overlapHeight;\n            }\n            else if (allowedDirections.top) {\n                directions.top = overlapHeight;\n            }\n            else if (allowedDirections.right) {\n                directions.right = 0;\n            }\n            else if (allowedDirections.left) {\n                directions.left = 0;\n            }\n        }\n        else if (respectDirection === 'height') {\n            var overlapWidth = actualCoordinates.width - currentHeight * ratioBroken;\n            if (allowedDirections.left && allowedDirections.right) {\n                var left = directions.left, right = directions.right;\n                directions.left = -distributeOverlap(overlapWidth, left, right);\n                directions.right = -distributeOverlap(overlapWidth, right, left);\n            }\n            else if (allowedDirections.left) {\n                directions.left = -overlapWidth;\n            }\n            else if (allowedDirections.right) {\n                directions.right = -overlapWidth;\n            }\n            else if (allowedDirections.top) {\n                directions.top = 0;\n            }\n            else if (allowedDirections.bottom) {\n                directions.bottom = 0;\n            }\n        }\n        // 3. Third step: check if desired box with correct aspect ratios break some limits and fit to this conditions\n        directions = fitDirections({\n            directions: directions,\n            coordinates: actualCoordinates,\n            sizeRestrictions: sizeRestrictions,\n            positionRestrictions: positionRestrictions,\n            preserveRatio: true,\n            compensate: options.compensate,\n        });\n    }\n    // 4. Check if ratio broken (temporary):\n    currentWidth = applyDirections(actualCoordinates, directions).width;\n    currentHeight = applyDirections(actualCoordinates, directions).height;\n    ratioBroken = options.preserveAspectRatio\n        ? ratio(actualCoordinates)\n        : getBrokenRatio(currentWidth / currentHeight, aspectRatio);\n    if (ratioBroken && Math.abs(ratioBroken - currentWidth / currentHeight) > 1e-3) {\n        ALL_DIRECTIONS.forEach(function (direction) {\n            if (!allowedDirections[direction]) {\n                directions[direction] = 0;\n            }\n        });\n    }\n    return moveCoordinatesAlgorithm({\n        width: coordinates.width + directions.right + directions.left,\n        height: coordinates.height + directions.top + directions.bottom,\n        left: coordinates.left,\n        top: coordinates.top,\n    }, {\n        left: -directions.left,\n        top: -directions.top,\n    }, positionRestrictions);\n}\n\nexport { fitDirections, resizeCoordinatesAlgorithm };\n","import { __assign } from 'tslib';\nimport { mergePositionRestrictions, coordinatesToPositionRestrictions } from '../service/utils.js';\nimport { getMinimumSize, getSizeRestrictions, isInitializedState, getPositionRestrictions, getAspectRatio } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { resizeCoordinatesAlgorithm } from '../algorithms/resizeCoordinatesAlgorithm.js';\n\nfunction resizeCoordinates(state, settings, directions, options) {\n    var minimumSize = getMinimumSize(state);\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    return isInitializedState(state)\n        ? __assign(__assign({}, copyState(state)), { coordinates: resizeCoordinatesAlgorithm(state.coordinates, directions, options, {\n                positionRestrictions: mergePositionRestrictions(getPositionRestrictions(state, settings), coordinatesToPositionRestrictions(state.visibleArea)),\n                sizeRestrictions: {\n                    maxWidth: Math.min(sizeRestrictions.maxWidth, state.visibleArea.width),\n                    maxHeight: Math.min(sizeRestrictions.maxHeight, state.visibleArea.height),\n                    minWidth: Math.max(Math.min(sizeRestrictions.minWidth, state.visibleArea.width), minimumSize),\n                    minHeight: Math.max(Math.min(sizeRestrictions.minHeight, state.visibleArea.height), minimumSize),\n                },\n                aspectRatio: getAspectRatio(state, settings),\n            }) }) : state;\n}\n\nexport { resizeCoordinates };\n","import { __assign } from 'tslib';\nimport { ratio, applyScale, resizeToSizeRestrictions, inverseMove, fitToPositionRestrictions, coordinatesToPositionRestrictions, applyMove, moveToPositionRestrictions } from '../service/utils.js';\nimport { getSizeRestrictions, getAreaSizeRestrictions, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { fitCoordinates } from '../service/fitCoordinates.js';\n\nfunction setBoundary(state, settings, boundary) {\n    var result = __assign(__assign({}, copyState(state)), { boundary: boundary });\n    if (result.visibleArea && result.coordinates && state.visibleArea) {\n        // Scale visible area size to fit new boundary:\n        result.visibleArea.height = result.visibleArea.width / ratio(boundary);\n        result.visibleArea.top += (state.visibleArea.height - result.visibleArea.height) / 2;\n        // Scale visible area to prevent overlap coordinates (and its minimum size)\n        var sizeRestrictions = getSizeRestrictions(result, settings);\n        if (Math.max(sizeRestrictions.minHeight, result.coordinates.height) - result.visibleArea.height > 0 ||\n            Math.max(sizeRestrictions.minWidth, result.coordinates.width) - result.visibleArea.width > 0) {\n            result.visibleArea = applyScale(result.visibleArea, Math.max(Math.max(sizeRestrictions.minHeight, result.coordinates.height) / result.visibleArea.height, Math.max(sizeRestrictions.minWidth, result.coordinates.width) / result.visibleArea.width));\n        }\n        // Scale visible area to prevent overlap area restrictions\n        result.visibleArea = resizeToSizeRestrictions(result.visibleArea, getAreaSizeRestrictions(result, settings));\n        // Move visible are to prevent moving of the coordinates:\n        var move = inverseMove(fitToPositionRestrictions(result.coordinates, coordinatesToPositionRestrictions(result.visibleArea)));\n        if (result.visibleArea.width < result.coordinates.width) {\n            move.left = 0;\n        }\n        if (result.visibleArea.height < result.coordinates.height) {\n            move.top = 0;\n        }\n        result.visibleArea = applyMove(result.visibleArea, move);\n        // Move visible area to prevent overlap the area restrictions\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        result = fitCoordinates(result, settings);\n    }\n    return result;\n}\n\nexport { setBoundary };\n","import { __assign } from 'tslib';\nimport { isNumber } from '../utils/index.js';\nimport { rotatePoint, getCenter, diff, resizeToSizeRestrictions, moveToPositionRestrictions, applyMove } from '../service/utils.js';\nimport { mergeSizeRestrictions } from '../service/sizeRestrictions.js';\nimport { isInitializedState, getTransformedImageSize, getSizeRestrictions, getAspectRatio, getAreaSizeRestrictions, getPositionRestrictions, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction rotateImageAlgorithm(state, settings, rotate) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var angle = isNumber(rotate) ? rotate : rotate.angle;\n        var imageCenter = rotatePoint(getCenter(__assign({ left: 0, top: 0 }, getTransformedImageSize(state))), angle);\n        result.transforms.rotate += angle;\n        result.coordinates = __assign(__assign({}, approximateSize({\n            sizeRestrictions: getSizeRestrictions(result, settings),\n            aspectRatio: getAspectRatio(result, settings),\n            width: result.coordinates.width,\n            height: result.coordinates.height,\n        })), rotatePoint(getCenter(result.coordinates), angle));\n        var center = !isNumber(rotate) && rotate.center ? rotate.center : getCenter(state.coordinates);\n        var shift = diff(getCenter(state.coordinates), rotatePoint(getCenter(state.coordinates), angle, center));\n        var imageSize = getTransformedImageSize(result);\n        result.coordinates.left -= imageCenter.left - imageSize.width / 2 + result.coordinates.width / 2 - shift.left;\n        result.coordinates.top -= imageCenter.top - imageSize.height / 2 + result.coordinates.height / 2 - shift.top;\n        // Check that visible area doesn't break the area restrictions:\n        result.visibleArea = resizeToSizeRestrictions(result.visibleArea, mergeSizeRestrictions(getAreaSizeRestrictions(result, settings), {\n            minWidth: result.coordinates.width,\n            minHeight: result.coordinates.height,\n        }));\n        result.coordinates = moveToPositionRestrictions(result.coordinates, getPositionRestrictions(result, settings));\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(result.coordinates), getCenter(state.coordinates)));\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        return result;\n    }\n    return state;\n}\n\nexport { rotateImageAlgorithm };\n","import 'tslib';\nimport { rotatePoint, getCenter, applyMove, diff, moveToPositionRestrictions } from '../service/utils.js';\nimport { isInitializedState, getTransformedImageSize, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction flipImageAlgorithm(state, settings, horizontal, vertical) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var rotate = state.transforms.rotate;\n        var imageSize = getTransformedImageSize(state);\n        var changed = {\n            horizontal: horizontal,\n            vertical: vertical,\n        };\n        if (changed.horizontal || changed.vertical) {\n            var imageCenter = rotatePoint({\n                left: imageSize.width / 2,\n                top: imageSize.height / 2,\n            }, -rotate);\n            var oldCenter = rotatePoint(getCenter(result.coordinates), -rotate);\n            var newCenter = rotatePoint({\n                left: changed.horizontal ? imageCenter.left - (oldCenter.left - imageCenter.left) : oldCenter.left,\n                top: changed.vertical ? imageCenter.top - (oldCenter.top - imageCenter.top) : oldCenter.top,\n            }, rotate);\n            result.coordinates = applyMove(result.coordinates, diff(newCenter, getCenter(result.coordinates)));\n            oldCenter = rotatePoint(getCenter(result.visibleArea), -rotate);\n            newCenter = rotatePoint({\n                left: changed.horizontal ? imageCenter.left - (oldCenter.left - imageCenter.left) : oldCenter.left,\n                top: changed.vertical ? imageCenter.top - (oldCenter.top - imageCenter.top) : oldCenter.top,\n            }, rotate);\n            result.visibleArea = applyMove(result.visibleArea, diff(newCenter, getCenter(result.visibleArea)));\n            result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        }\n        if (changed.horizontal) {\n            result.transforms.flip.horizontal = !state.transforms.flip.horizontal;\n        }\n        if (changed.vertical) {\n            result.transforms.flip.vertical = !state.transforms.flip.vertical;\n        }\n        return result;\n    }\n    return state;\n}\n\nexport { flipImageAlgorithm };\n","import 'tslib';\nimport { isNumber, isRoughlyEqual } from '../utils/index.js';\nimport { applyMove, maxScale, positionToSizeRestrictions, minScale, applyScale, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions, getCenter, inverseMove, fitToPositionRestrictions } from '../service/utils.js';\nimport { isInitializedState, getSizeRestrictions, getPositionRestrictions, getAreaSizeRestrictions, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction transformImageAlgorithm(state, settings, transform) {\n    var _a;\n    var _b = transform.scale, scale = _b === void 0 ? 1 : _b, _c = transform.move, move = _c === void 0 ? {} : _c;\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        // It's reversed because zooming in the image is actually zooming out visible area\n        var scaleFactor = 1 / (isNumber(scale) ? scale : scale.factor);\n        var scaleCenter = !isNumber(scale) ? scale.center : undefined;\n        var isAllowedScale = !isRoughlyEqual(scaleFactor, 1);\n        var areaScale = 1;\n        var stencilScale = 1;\n        result.visibleArea = applyMove(result.visibleArea, {\n            left: move.left || 0,\n            top: move.top || 0,\n        });\n        var sizeRestrictions = getSizeRestrictions(result, settings);\n        var positionRestrictions = getPositionRestrictions(result, settings);\n        var areaSizeRestrictions = getAreaSizeRestrictions(result, settings);\n        var scaleRestrictions = {\n            stencil: {\n                minimum: Math.max(sizeRestrictions.minWidth ? sizeRestrictions.minWidth / result.coordinates.width : 0, sizeRestrictions.minHeight ? sizeRestrictions.minHeight / result.coordinates.height : 0),\n                maximum: Math.min(sizeRestrictions.maxWidth ? sizeRestrictions.maxWidth / result.coordinates.width : Infinity, sizeRestrictions.maxHeight ? sizeRestrictions.maxHeight / result.coordinates.height : Infinity, maxScale(result.coordinates, positionToSizeRestrictions(positionRestrictions))),\n            },\n            area: {\n                maximum: maxScale(result.visibleArea, areaSizeRestrictions),\n                minimum: minScale(result.visibleArea, areaSizeRestrictions),\n            },\n        };\n        // If there is scaling then begin scale\n        if (scaleFactor && isAllowedScale) {\n            // Determine scale factor\n            if (scaleFactor < 1) {\n                stencilScale = Math.max(scaleFactor, Math.max(scaleRestrictions.area.minimum, scaleRestrictions.stencil.minimum));\n                if (stencilScale > 1) {\n                    stencilScale = 1;\n                }\n            }\n            else if (scaleFactor > 1) {\n                stencilScale = Math.min(scaleFactor, Math.min(scaleRestrictions.area.maximum, scaleRestrictions.stencil.maximum));\n                if (stencilScale < 1) {\n                    stencilScale = 1;\n                }\n            }\n        }\n        if (stencilScale) {\n            // Resize stencil with area as much as possible\n            result.visibleArea = applyScale(result.visibleArea, stencilScale, scaleCenter);\n        }\n        var relativeCoordinates = {\n            left: state.coordinates.left - state.visibleArea.left,\n            right: state.visibleArea.width + state.visibleArea.left - (state.coordinates.width + state.coordinates.left),\n            top: state.coordinates.top - state.visibleArea.top,\n            bottom: state.visibleArea.height + state.visibleArea.top - (state.coordinates.height + state.coordinates.top),\n        };\n        // Move the area to fit to the coordinates limits:\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, {\n            left: positionRestrictions.left !== undefined\n                ? positionRestrictions.left - relativeCoordinates.left * stencilScale\n                : undefined,\n            top: positionRestrictions.top !== undefined\n                ? positionRestrictions.top - relativeCoordinates.top * stencilScale\n                : undefined,\n            bottom: positionRestrictions.bottom !== undefined\n                ? positionRestrictions.bottom + relativeCoordinates.bottom * stencilScale\n                : undefined,\n            right: positionRestrictions.right !== undefined\n                ? positionRestrictions.right + relativeCoordinates.right * stencilScale\n                : undefined,\n        });\n        // But the more important to fit are to the area restrictions, so we should fit it to that restrictions:\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        // Set the same coordinates of stencil inside visible area\n        result.coordinates.width = result.coordinates.width * stencilScale;\n        result.coordinates.height = result.coordinates.height * stencilScale;\n        result.coordinates.left = result.visibleArea.left + relativeCoordinates.left * stencilScale;\n        result.coordinates.top = result.visibleArea.top + relativeCoordinates.top * stencilScale;\n        // Move the coordinates to prevent the intersection with visible area and position restrictions\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), positionRestrictions));\n        // Resize only area if stencil can't be resized and stencil resize is disabled\n        if (isAllowedScale && scaleFactor && ((_a = settings.transformImage) === null || _a === void 0 ? void 0 : _a.adjustStencil)) {\n            if (scaleFactor > 1) {\n                areaScale = Math.min(scaleRestrictions.area.maximum, scaleFactor) / stencilScale;\n            }\n            else if (scaleFactor < 1) {\n                areaScale = Math.max(result.coordinates.height / result.visibleArea.height, result.coordinates.width / result.visibleArea.width, scaleFactor / stencilScale);\n            }\n            if (areaScale !== 1) {\n                result.visibleArea = applyScale(result.visibleArea, areaScale, scaleFactor > 1 ? scaleCenter : getCenter(result.coordinates));\n                // Move to prevent the breaking of the area restrictions:\n                result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n                // Move to prevent the intersection with coordinates:\n                result.visibleArea = applyMove(result.visibleArea, inverseMove(fitToPositionRestrictions(result.coordinates, coordinatesToPositionRestrictions(result.visibleArea))));\n            }\n        }\n        return result;\n    }\n    return state;\n}\n\nexport { transformImageAlgorithm };\n","import 'tslib';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { rotateImageAlgorithm } from '../algorithms/rotateImageAlgorithm.js';\nimport { flipImageAlgorithm } from '../algorithms/flipImageAlgorithm.js';\nimport { transformImageAlgorithm } from '../algorithms/transformImageAlgorithm.js';\n\nfunction transformImage(state, settings, transform) {\n    if (transform.rotate) {\n        state = rotateImageAlgorithm(state, settings, transform.rotate);\n    }\n    if (transform.flip) {\n        state = flipImageAlgorithm(state, settings, transform.flip.horizontal, transform.flip.vertical);\n    }\n    if (transform.move || transform.scale) {\n        state = transformImageAlgorithm(state, settings, transform);\n    }\n    return state;\n}\n\nexport { transformImage };\n","import { __assign } from 'tslib';\nimport { getBrokenRatio, ratio, applyMove, diff, getCenter, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from '../service/utils.js';\nimport { mergeSizeRestrictions } from '../service/sizeRestrictions.js';\nimport { isInitializedState, getAspectRatio, getSizeRestrictions, getAreaSizeRestrictions, getAreaPositionRestrictions, getPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction reconcileState(state, settings) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var aspectRatio = getAspectRatio(state, settings);\n        var sizeRestrictions = getSizeRestrictions(state, settings);\n        var areaSizeRestrictions = getAreaSizeRestrictions(state, settings);\n        // Fit the size of coordinates to existing size restrictions and visible area\n        var brokenRatio = getBrokenRatio(ratio(state.coordinates), aspectRatio);\n        var desiredSize = brokenRatio\n            ? {\n                height: state.coordinates.height,\n                width: state.coordinates.height * brokenRatio,\n            }\n            : state.coordinates;\n        result.coordinates = __assign(__assign({}, result.coordinates), approximateSize({\n            width: desiredSize.width,\n            height: desiredSize.height,\n            aspectRatio: aspectRatio,\n            sizeRestrictions: mergeSizeRestrictions(areaSizeRestrictions, sizeRestrictions),\n        }));\n        // Return the coordinates to the previous center\n        result.coordinates = applyMove(result.coordinates, diff(getCenter(state.coordinates), getCenter(result.coordinates)));\n        var scaleModifier = Math.max(result.coordinates.width / result.visibleArea.width, result.coordinates.height / result.visibleArea.height, 1);\n        // Fit the visible area to its size restrictions and boundary aspect ratio:\n        result.visibleArea = __assign(__assign({}, state.visibleArea), approximateSize({\n            width: state.visibleArea.width * scaleModifier,\n            height: state.visibleArea.height * scaleModifier,\n            aspectRatio: {\n                minimum: ratio(result.boundary),\n                maximum: ratio(result.boundary),\n            },\n            sizeRestrictions: areaSizeRestrictions,\n        }));\n        // Return the visible area to previous center\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(state.visibleArea), getCenter(result.visibleArea)));\n        // Fit the visible area to positions restrictions\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        // Fit the coordinates to position restrictions and visible area\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), getPositionRestrictions(result, settings)));\n        return result;\n    }\n    return state;\n}\n\nexport { reconcileState };\n","import { isNumber } from '../utils/index.js';\nimport { getCoefficient } from './helpers.js';\n\nfunction normalizeResizeDirections(state, directions) {\n    var coefficient = getCoefficient(state);\n    return {\n        left: isNumber(directions.left) ? directions.left * coefficient : 0,\n        top: isNumber(directions.top) ? directions.top * coefficient : 0,\n        right: isNumber(directions.right) ? directions.right * coefficient : 0,\n        bottom: isNumber(directions.bottom) ? directions.bottom * coefficient : 0,\n    };\n}\nfunction normalizeCenter(state, center) {\n    var coefficient = getCoefficient(state);\n    if (state.visibleArea) {\n        return {\n            left: center.left * coefficient + state.visibleArea.left,\n            top: center.top * coefficient + state.visibleArea.top,\n        };\n    }\n    return center;\n}\nfunction normalizeFlip(state, flip) {\n    if (state) {\n        var normalizedAngle = Math.abs(state.transforms.rotate % 180);\n        if (normalizedAngle <= 45 || normalizedAngle >= 135) {\n            return flip;\n        }\n        else {\n            return {\n                horizontal: flip.vertical,\n                vertical: flip.horizontal,\n            };\n        }\n    }\n    return flip;\n}\nfunction fillMoveDirections(directions) {\n    return {\n        left: isNumber(directions.left) ? directions.left : 0,\n        top: isNumber(directions.top) ? directions.top : 0,\n    };\n}\nfunction fillResizeDirections(directions) {\n    return {\n        left: isNumber(directions.left) ? directions.left : 0,\n        top: isNumber(directions.top) ? directions.top : 0,\n        right: isNumber(directions.right) ? directions.right : 0,\n        bottom: isNumber(directions.bottom) ? directions.bottom : 0,\n    };\n}\nfunction normalizeMoveDirections(state, directions) {\n    var coefficient = getCoefficient(state);\n    return {\n        left: isNumber(directions.left) ? directions.left * coefficient : 0,\n        top: isNumber(directions.top) ? directions.top * coefficient : 0,\n    };\n}\nfunction normalizeImageTransform(state, transform) {\n    if (transform.scale) {\n        transform.scale = {\n            factor: isNumber(transform.scale) ? transform.scale : transform.scale.factor,\n            center: !isNumber(transform.scale) && transform.scale.center\n                ? normalizeCenter(state, transform.scale.center)\n                : undefined,\n        };\n    }\n    if (transform.rotate) {\n        transform.rotate = {\n            angle: isNumber(transform.rotate) ? transform.rotate : transform.rotate.angle,\n            center: !isNumber(transform.rotate) && transform.rotate.center\n                ? normalizeCenter(state, transform.rotate.center)\n                : undefined,\n        };\n    }\n    if (transform.move) {\n        transform.move = normalizeMoveDirections(state, transform.move);\n    }\n    return transform;\n}\n\nexport { fillMoveDirections, fillResizeDirections, normalizeCenter, normalizeFlip, normalizeImageTransform, normalizeMoveDirections, normalizeResizeDirections };\n","import { isRoughlyEqual, sign, distance } from '../utils/index.js';\n\nfunction calculateGeometricProperties(touches, container) {\n    var _a = container.getBoundingClientRect(), left = _a.left, top = _a.top;\n    var centerMass = { left: 0, top: 0 };\n    var spread = 0;\n    touches.forEach(function (touch) {\n        centerMass.left += (touch.clientX - left) / touches.length;\n        centerMass.top += (touch.clientY - top) / touches.length;\n    });\n    touches.forEach(function (touch) {\n        spread += distance({ left: centerMass.left, top: centerMass.top }, { left: touch.clientX - left, top: touch.clientY - top });\n    });\n    return { centerMass: centerMass, spread: spread, count: touches.length };\n}\nfunction touchesToImageTransform(touches, previousTouches, container, options) {\n    if (options === void 0) { options = {}; }\n    var move, scale, rotate;\n    if (previousTouches.length === 1 && touches.length === 1) {\n        if (options.move) {\n            move = {\n                left: previousTouches[0].clientX - touches[0].clientX,\n                top: previousTouches[0].clientY - touches[0].clientY,\n            };\n        }\n    }\n    else if (touches.length > 1) {\n        var previousProperties = calculateGeometricProperties(previousTouches, container);\n        var properties = calculateGeometricProperties(touches, container);\n        if (options.rotate && previousTouches.length === 2 && touches.length === 2) {\n            var diffs = {\n                left: [\n                    touches[0].clientX - touches[1].clientX,\n                    previousTouches[0].clientX - previousTouches[1].clientX,\n                ],\n                top: [touches[0].clientY - touches[1].clientY, previousTouches[0].clientY - previousTouches[1].clientY],\n            };\n            var y = diffs.left[0] * diffs.top[1] - diffs.left[1] * diffs.top[0];\n            var x = diffs.left[0] * diffs.left[1] + diffs.top[0] * diffs.top[1];\n            if (!isRoughlyEqual(x, 0) && !isRoughlyEqual(y, 0)) {\n                var radians = Math.atan2(y, x);\n                var angle = -(radians * 180) / Math.PI;\n                rotate = {\n                    center: properties.centerMass,\n                    angle: angle,\n                };\n            }\n        }\n        if (options.move) {\n            move = {\n                left: previousProperties.centerMass.left - properties.centerMass.left,\n                top: previousProperties.centerMass.top - properties.centerMass.top,\n            };\n        }\n        if (options.scale) {\n            scale = {\n                factor: properties.spread / previousProperties.spread,\n                center: properties.centerMass,\n            };\n        }\n    }\n    return {\n        move: move,\n        scale: scale,\n        rotate: rotate,\n    };\n}\nfunction wheelEventToImageTransform(event, container, ratio) {\n    if (ratio === void 0) { ratio = 0.1; }\n    var _a = container.getBoundingClientRect(), left = _a.left, top = _a.top;\n    var factor = 1 - ratio * sign((event.deltaY || event.detail || event.wheelDelta));\n    var center = {\n        left: event.clientX - left,\n        top: event.clientY - top,\n    };\n    return { scale: { factor: factor, center: center } };\n}\n\nexport { touchesToImageTransform, wheelEventToImageTransform };\n","import 'tslib';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultPositionRestrictions(state, settings) {\n    var imageSize = getTransformedImageSize(state);\n    var limits = {};\n    if (settings.imageRestriction && settings.imageRestriction !== 'none') {\n        limits = {\n            left: 0,\n            top: 0,\n            right: imageSize.width,\n            bottom: imageSize.height,\n        };\n    }\n    return limits;\n}\n\nexport { defaultPositionRestrictions };\n","import { __assign } from 'tslib';\nimport { ratio, resizeToSizeRestrictions, getIntersections, coordinatesToPositionRestrictions, moveToPositionRestrictions } from '../service/utils.js';\nimport { getTransformedImageSize, getAreaSizeRestrictions } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultVisibleArea(state, settings) {\n    var coordinates = state.coordinates, boundary = state.boundary;\n    var imageSize = getTransformedImageSize(state);\n    var boundaryRatio = ratio(boundary);\n    if (coordinates) {\n        // Visible area will try to fit reference:\n        var reference = {\n            height: Math.max(coordinates.height, imageSize.height),\n            width: Math.max(coordinates.width, imageSize.width),\n        };\n        var visibleArea = {\n            left: 0,\n            top: 0,\n            width: ratio(reference) > boundaryRatio ? reference.width : reference.height * boundaryRatio,\n            height: ratio(reference) > boundaryRatio ? reference.width / boundaryRatio : reference.height,\n        };\n        // Visible area should correspond its restrictions:\n        visibleArea = resizeToSizeRestrictions(visibleArea, getAreaSizeRestrictions(state, settings));\n        // Visible area will try to center stencil:\n        visibleArea.left = coordinates.left + coordinates.width / 2 - visibleArea.width / 2;\n        visibleArea.top = coordinates.top + coordinates.height / 2 - visibleArea.height / 2;\n        // TODO: Controversial behavior:\n        // If the coordinates are beyond image visible area will be allowed to be beyond image alike:\n        var coordinatesIntersection = getIntersections(coordinates, coordinatesToPositionRestrictions(__assign({ left: 0, top: 0 }, imageSize)));\n        var restrictions = {};\n        if (!coordinatesIntersection.left && !coordinatesIntersection.right && visibleArea.width <= imageSize.width) {\n            restrictions.left = 0;\n            restrictions.right = imageSize.width;\n        }\n        if (!coordinatesIntersection.top && !coordinatesIntersection.bottom && visibleArea.height <= imageSize.height) {\n            restrictions.top = 0;\n            restrictions.bottom = imageSize.height;\n        }\n        return moveToPositionRestrictions(visibleArea, restrictions);\n    }\n    else {\n        var imageRatio = ratio(imageSize);\n        var areaProperties = {\n            height: imageRatio < boundaryRatio ? imageSize.height : imageSize.width / boundaryRatio,\n            width: imageRatio < boundaryRatio ? imageSize.height * boundaryRatio : imageSize.width,\n        };\n        return {\n            left: imageSize.width / 2 - areaProperties.width / 2,\n            top: imageSize.height / 2 - areaProperties.height / 2,\n            width: areaProperties.width,\n            height: areaProperties.height,\n        };\n    }\n}\n\nexport { defaultVisibleArea };\n","import { __assign } from 'tslib';\nimport { positionToSizeRestrictions, ratio } from '../service/utils.js';\nimport { getSizeRestrictions, getAspectRatio, getPositionRestrictions } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction defaultSize(state, settings) {\n    var imageSize = state.imageSize, visibleArea = state.visibleArea;\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    var aspectRatio = getAspectRatio(state, settings);\n    var area;\n    if (visibleArea) {\n        area = visibleArea;\n    }\n    else {\n        var sizeRestrictions_1 = positionToSizeRestrictions(getPositionRestrictions(state, settings));\n        area = {\n            width: Math.max(sizeRestrictions_1.minWidth, Math.min(sizeRestrictions_1.maxWidth, imageSize.width)),\n            height: Math.max(sizeRestrictions_1.minHeight, Math.min(sizeRestrictions_1.maxHeight, imageSize.height)),\n        };\n    }\n    var optimalRatio = Math.min(aspectRatio.maximum || Infinity, Math.max(aspectRatio.minimum || 0, ratio(area)));\n    var size = area.width < area.height\n        ? {\n            width: area.width * 0.8,\n            height: (area.width * 0.8) / optimalRatio,\n        }\n        : {\n            height: area.height * 0.8,\n            width: area.height * 0.8 * optimalRatio,\n        };\n    return approximateSize(__assign(__assign({}, size), { aspectRatio: aspectRatio, sizeRestrictions: sizeRestrictions }));\n}\n\nexport { defaultSize };\n","import { isNumeric, parseNumber } from '../utils/index.js';\n\nfunction retrieveSizeRestrictions(settings) {\n    return {\n        minWidth: isNumeric(settings.minWidth) ? parseNumber(settings.minWidth) : 0,\n        minHeight: isNumeric(settings.minHeight) ? parseNumber(settings.minHeight) : 0,\n        maxWidth: isNumeric(settings.maxWidth) ? parseNumber(settings.maxWidth) : Infinity,\n        maxHeight: isNumeric(settings.maxHeight) ? parseNumber(settings.maxHeight) : Infinity,\n    };\n}\nfunction pixelsRestrictions(state, settings) {\n    return retrieveSizeRestrictions(settings);\n}\n\nexport { pixelsRestrictions, retrieveSizeRestrictions };\n","import 'tslib';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultPosition(state) {\n    var visibleArea = state.visibleArea, coordinates = state.coordinates;\n    var area = visibleArea || getTransformedImageSize(state);\n    return {\n        left: (visibleArea ? visibleArea.left : 0) + area.width / 2 - (coordinates ? coordinates.width / 2 : 0),\n        top: (visibleArea ? visibleArea.top : 0) + area.height / 2 - (coordinates ? coordinates.height / 2 : 0),\n    };\n}\n\nexport { defaultPosition };\n","import 'tslib';\nimport { ratio } from '../service/utils.js';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport { ImageRestriction } from '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultAreaPositionRestrictions(state, settings) {\n    var visibleArea = state.visibleArea, boundary = state.boundary;\n    var imageRestriction = settings.imageRestriction;\n    var imageSize = getTransformedImageSize(state);\n    var restrictions = {};\n    if (imageRestriction === ImageRestriction.fillArea) {\n        restrictions = {\n            left: 0,\n            top: 0,\n            right: imageSize.width,\n            bottom: imageSize.height,\n        };\n    }\n    else if (imageRestriction === ImageRestriction.fitArea) {\n        if (ratio(boundary) > ratio(imageSize)) {\n            restrictions = {\n                top: 0,\n                bottom: imageSize.height,\n            };\n            if (visibleArea) {\n                if (visibleArea.width > imageSize.width) {\n                    restrictions.left = -(visibleArea.width - imageSize.width) / 2;\n                    restrictions.right = imageSize.width - restrictions.left;\n                }\n                else {\n                    restrictions.left = 0;\n                    restrictions.right = imageSize.width;\n                }\n            }\n        }\n        else {\n            restrictions = {\n                left: 0,\n                right: imageSize.width,\n            };\n            if (visibleArea) {\n                if (visibleArea.height > imageSize.height) {\n                    restrictions.top = -(visibleArea.height - imageSize.height) / 2;\n                    restrictions.bottom = imageSize.height - restrictions.top;\n                }\n                else {\n                    restrictions.top = 0;\n                    restrictions.bottom = imageSize.height;\n                }\n            }\n        }\n    }\n    return restrictions;\n}\n\nexport { defaultAreaPositionRestrictions };\n","import 'tslib';\nimport { ratio } from '../service/utils.js';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport { ImageRestriction } from '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultAreaSizeRestrictions(state, settings) {\n    var boundary = state.boundary;\n    var imageRestriction = settings.imageRestriction;\n    var imageSize = getTransformedImageSize(state);\n    var restrictions = {\n        minWidth: 0,\n        minHeight: 0,\n        maxWidth: Infinity,\n        maxHeight: Infinity,\n    };\n    if (imageRestriction === ImageRestriction.fillArea) {\n        restrictions.maxWidth = imageSize.width;\n        restrictions.maxHeight = imageSize.height;\n    }\n    else if (imageRestriction === ImageRestriction.fitArea) {\n        if (ratio(boundary) > ratio(imageSize)) {\n            restrictions.maxHeight = imageSize.height;\n            restrictions.maxWidth = imageSize.height * ratio(boundary);\n        }\n        else {\n            restrictions.maxWidth = imageSize.width;\n            restrictions.maxHeight = imageSize.width / ratio(boundary);\n        }\n    }\n    return restrictions;\n}\n\nexport { defaultAreaSizeRestrictions };\n","function fitBoundary(boundary, size) {\n    var areaHeight = boundary.clientHeight;\n    var areaWidth = boundary.clientWidth;\n    var currentHeight = areaHeight;\n    var currentWidth = (size.width * areaHeight) / size.height;\n    if (currentWidth > areaWidth) {\n        currentWidth = areaWidth;\n        currentHeight = (size.height * areaWidth) / size.width;\n    }\n    return {\n        width: currentWidth,\n        height: currentHeight,\n    };\n}\nfunction fillBoundary(boundary) {\n    return {\n        width: boundary.clientWidth,\n        height: boundary.clientHeight,\n    };\n}\n\nexport { fillBoundary, fitBoundary };\n","import 'tslib';\nimport { isFunction } from '../utils/index.js';\nimport { createAspectRatio } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultStencilConstraints(rawSettings, stencilProps) {\n    if (!rawSettings.aspectRatio) {\n        return {\n            aspectRatio: createAspectRatio(isFunction(stencilProps.aspectRatio) ? stencilProps.aspectRatio() : stencilProps.aspectRatio),\n        };\n    }\n    return {};\n}\n\nexport { defaultStencilConstraints };\n","import { __assign } from 'tslib';\nimport { isFunction } from '../utils/index.js';\nimport { mergePositionRestrictions, createAspectRatio } from '../service/utils.js';\nimport { mergeSizeRestrictions } from '../service/sizeRestrictions.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { defaultPositionRestrictions } from './defaultPositionRestrictions.js';\nexport { defaultPositionRestrictions } from './defaultPositionRestrictions.js';\nimport { defaultVisibleArea } from './defaultVisibleArea.js';\nexport { defaultVisibleArea } from './defaultVisibleArea.js';\nimport { defaultSize } from './defaultSize.js';\nexport { defaultSize } from './defaultSize.js';\nimport { pixelsRestrictions } from './defaultSizeRestrictions.js';\nexport { pixelsRestrictions, retrieveSizeRestrictions } from './defaultSizeRestrictions.js';\nimport { defaultPosition } from './defaultPosition.js';\nexport { defaultPosition } from './defaultPosition.js';\nimport { defaultAreaPositionRestrictions } from './defaultAreaPositionRestrictions.js';\nexport { defaultAreaPositionRestrictions } from './defaultAreaPositionRestrictions.js';\nimport { defaultAreaSizeRestrictions } from './defaultAreaSizeRestrictions.js';\nexport { defaultAreaSizeRestrictions } from './defaultAreaSizeRestrictions.js';\nexport { fillBoundary, fitBoundary } from './defaultBoundary.js';\nexport { defaultStencilConstraints } from './defaultStencilConstraints.js';\n\nfunction withDefaultSizeRestrictions(sizeRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(sizeRestrictions) ? sizeRestrictions(state, basicSettings) : sizeRestrictions;\n        return mergeSizeRestrictions(pixelsRestrictions(state, basicSettings), value);\n    };\n}\nfunction withDefaultPositionRestrictions(positionRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(positionRestrictions)\n            ? positionRestrictions(state, basicSettings)\n            : positionRestrictions;\n        return mergePositionRestrictions(defaultPositionRestrictions(state, basicSettings), value);\n    };\n}\nfunction withDefaultAreaPositionRestrictions(areaPositionRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(areaPositionRestrictions)\n            ? areaPositionRestrictions(state, basicSettings)\n            : areaPositionRestrictions;\n        return mergePositionRestrictions(defaultAreaPositionRestrictions(state, basicSettings), value);\n    };\n}\nfunction withDefaultAreaSizeRestrictions(areaSizeRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(areaSizeRestrictions)\n            ? areaSizeRestrictions(state, basicSettings)\n            : areaSizeRestrictions;\n        return mergeSizeRestrictions(defaultAreaSizeRestrictions(state, basicSettings), value);\n    };\n}\nfunction createDefaultSettings(params) {\n    return __assign(__assign({}, params), { sizeRestrictions: function (state, basicSettings) {\n            var restrictions;\n            if (params.sizeRestrictions) {\n                restrictions = isFunction(params.sizeRestrictions)\n                    ? params.sizeRestrictions(state, basicSettings)\n                    : params.sizeRestrictions;\n            }\n            else {\n                restrictions = pixelsRestrictions(state, basicSettings);\n            }\n            return restrictions;\n        }, areaPositionRestrictions: function (state, basicSettings) {\n            if (params.areaPositionRestrictions) {\n                return isFunction(params.areaPositionRestrictions)\n                    ? params.areaPositionRestrictions(state, basicSettings)\n                    : params.areaPositionRestrictions;\n            }\n            else {\n                return defaultAreaPositionRestrictions(state, basicSettings);\n            }\n        }, areaSizeRestrictions: function (state, basicSettings) {\n            if (params.areaSizeRestrictions) {\n                return isFunction(params.areaSizeRestrictions)\n                    ? params.areaSizeRestrictions(state, basicSettings)\n                    : params.areaSizeRestrictions;\n            }\n            else {\n                return defaultAreaSizeRestrictions(state, basicSettings);\n            }\n        }, positionRestrictions: function (state, basicSettings) {\n            if (params.positionRestrictions) {\n                return isFunction(params.positionRestrictions)\n                    ? params.positionRestrictions(state, basicSettings)\n                    : params.positionRestrictions;\n            }\n            else {\n                return defaultPositionRestrictions(state, basicSettings);\n            }\n        }, defaultCoordinates: function (state, basicSettings) {\n            if (params.defaultCoordinates) {\n                return isFunction(params.defaultCoordinates)\n                    ? params.defaultCoordinates(state, basicSettings)\n                    : params.defaultCoordinates;\n            }\n            else {\n                var defaultSizeAlgorithm = params.defaultSize;\n                if (!defaultSizeAlgorithm) {\n                    defaultSizeAlgorithm = defaultSize;\n                }\n                var size = isFunction(defaultSizeAlgorithm)\n                    ? defaultSizeAlgorithm(state, basicSettings)\n                    : defaultSizeAlgorithm;\n                var defaultPositionAlgorithm_1 = params.defaultPosition || defaultPosition;\n                return [\n                    size,\n                    function (state) { return (__assign({}, (isFunction(defaultPositionAlgorithm_1)\n                        ? defaultPositionAlgorithm_1(state, basicSettings)\n                        : defaultPositionAlgorithm_1))); },\n                ];\n            }\n        }, defaultVisibleArea: function (state, basicSettings) {\n            if (params.defaultVisibleArea) {\n                return isFunction(params.defaultVisibleArea)\n                    ? params.defaultVisibleArea(state, basicSettings)\n                    : params.defaultVisibleArea;\n            }\n            else {\n                return defaultVisibleArea(state, basicSettings);\n            }\n        }, aspectRatio: function (state, basicSettings) {\n            return createAspectRatio(isFunction(params.aspectRatio) ? params.aspectRatio(state, basicSettings) : params.aspectRatio);\n        } });\n}\n\nexport { createDefaultSettings, withDefaultAreaPositionRestrictions, withDefaultAreaSizeRestrictions, withDefaultPositionRestrictions, withDefaultSizeRestrictions };\n","function hasInteractions(interactions) {\n    return (interactions.moveCoordinates ||\n        interactions.resizeCoordinates ||\n        interactions.transformImage.move ||\n        interactions.transformImage.rotate ||\n        interactions.transformImage.flip ||\n        interactions.transformImage.scale);\n}\nfunction emptyInteractions() {\n    return {\n        moveCoordinates: false,\n        resizeCoordinates: false,\n        transformImage: {\n            rotate: false,\n            move: false,\n            scale: false,\n            flip: false,\n        },\n    };\n}\n\nexport { emptyInteractions, hasInteractions };\n","import { __assign } from 'tslib';\nimport { getOptions, deepClone, debounce, isArray, isFunction, deepCompare, isUndefined } from '../utils/index.js';\nimport { getCoefficient, isConsistentState, getStencilCoordinates, getRoundedCoordinates } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport { setCoordinates, SetCoordinatesMode } from '../state/setCoordinates.js';\nimport { setVisibleArea } from '../state/setVisibleArea.js';\nimport { createState } from '../state/createState.js';\nimport { moveCoordinates } from '../state/moveCoordinates.js';\nimport { resizeCoordinates } from '../state/resizeCoordinates.js';\nimport { setBoundary } from '../state/setBoundary.js';\nimport { transformImage } from '../state/transformImage.js';\nimport { reconcileState } from '../state/reconcileState.js';\nimport { normalizeImageTransform, normalizeFlip, normalizeMoveDirections, fillMoveDirections, normalizeResizeDirections, fillResizeDirections } from '../service/normalize.js';\nimport { hasInteractions } from '../service/interactions.js';\n\nfunction runCallback(callback, getInstance) {\n    if (callback && getInstance) {\n        var instance = getInstance();\n        if (instance) {\n            callback(instance);\n        }\n    }\n}\nfunction createCallback(callback, getInstance) {\n    return function () {\n        runCallback(callback, getInstance);\n    };\n}\nfunction runCallbacks(callbacks) {\n    callbacks.forEach(function (callback) {\n        callback();\n    });\n}\nvar AbstractCropper = /** @class */ (function () {\n    function AbstractCropper() {\n        var _this = this;\n        this.getTransitions = function () {\n            var data = _this.getData();\n            var transitions = _this.getProps().transitions;\n            return __assign(__assign({}, getOptions(transitions, {\n                timingFunction: 'ease-in-out',\n                duration: 350,\n            })), { active: data.transitions });\n        };\n        this.getInteractions = function () {\n            var interactions = _this.getData().interactions;\n            return deepClone(interactions);\n        };\n        this.hasInteractions = function () {\n            var interactions = _this.getData().interactions;\n            return hasInteractions(interactions);\n        };\n        this.disableTransitions = debounce(function () {\n            var _a = _this.getProps(), onTransitionsEnd = _a.onTransitionsEnd, getInstance = _a.getInstance;\n            _this.setData(__assign(__assign({}, _this.getData()), { transitions: false }));\n            runCallback(onTransitionsEnd, getInstance);\n        }, function () {\n            return _this.getTransitions().duration;\n        });\n        this.applyPostProcess = function (action, state) {\n            var _a = _this.getProps(), settings = _a.settings, postProcess = _a.postProcess;\n            var name = action.name, _b = action.interaction, interaction = _b === void 0 ? false : _b, _c = action.transitions, transitions = _c === void 0 ? false : _c, _d = action.immediately, immediately = _d === void 0 ? false : _d;\n            var preparedAction = {\n                name: name,\n                interaction: interaction,\n                transitions: transitions,\n                immediately: immediately,\n            };\n            if (isArray(postProcess)) {\n                return postProcess.reduce(function (processedState, p) { return p(processedState, settings, preparedAction); }, state);\n            }\n            else if (isFunction(postProcess)) {\n                return postProcess(state, settings, preparedAction);\n            }\n            else {\n                return state;\n            }\n        };\n        this.updateState = function (modifier, options, callbacks) {\n            if (options === void 0) { options = {}; }\n            if (callbacks === void 0) { callbacks = []; }\n            var _a = options.transitions, transitions = _a === void 0 ? false : _a;\n            var _b = _this.getProps(), onTransitionsStart = _b.onTransitionsStart, getInstance = _b.getInstance, onChange = _b.onChange, settings = _b.settings;\n            var previousData = _this.getData();\n            var state = isFunction(modifier) ? modifier(previousData.state, settings) : modifier;\n            var tolerance = state ? 1e-3 * getCoefficient(state) : 1e-3;\n            var somethingChanged = !deepCompare(previousData.state, state, tolerance);\n            var affectTransitionProperties = [\n                'coordinates',\n                'boundary',\n                'visibleArea',\n                'imageSize',\n                'transforms',\n            ].some(function (property) { var _a; return !deepCompare((_a = previousData.state) === null || _a === void 0 ? void 0 : _a[property], state === null || state === void 0 ? void 0 : state[property], tolerance); });\n            var currentData = previousData;\n            if (somethingChanged) {\n                if (transitions && affectTransitionProperties) {\n                    _this.disableTransitions();\n                }\n                currentData = __assign(__assign({}, currentData), { state: copyState(state), transitions: transitions && affectTransitionProperties });\n                _this.setData(currentData);\n                runCallback(onChange, getInstance);\n            }\n            if (currentData.transitions && !previousData.transitions) {\n                runCallback(onTransitionsStart, getInstance);\n            }\n            runCallbacks(callbacks.map(function (callback) { return createCallback(callback, getInstance); }));\n        };\n        this.setInteractions = function (interactions) {\n            var _a = _this.getProps(), onInteractionStart = _a.onInteractionStart, onInteractionEnd = _a.onInteractionEnd, getInstance = _a.getInstance;\n            var previousInteractions = _this.getInteractions();\n            var currentInteractions = __assign(__assign({}, previousInteractions), interactions);\n            if (!deepCompare(previousInteractions, currentInteractions)) {\n                _this.setData(__assign(__assign({}, _this.getData()), { interactions: currentInteractions }));\n            }\n            if (hasInteractions(previousInteractions) !== hasInteractions(currentInteractions)) {\n                if (!hasInteractions(previousInteractions)) {\n                    runCallback(onInteractionStart, getInstance);\n                }\n                else {\n                    var state_1 = _this.getData().state;\n                    _this.updateState(function () {\n                        return state_1 &&\n                            _this.applyPostProcess({\n                                name: 'interactionEnd',\n                                immediately: true,\n                                transitions: true,\n                            }, state_1);\n                    }, {\n                        transitions: true,\n                    }, [onInteractionEnd]);\n                }\n            }\n        };\n        this.resetState = function (boundary, image) {\n            _this.updateState(_this.createDefaultState(boundary, image));\n        };\n        this.clear = function () {\n            _this.updateState(null);\n        };\n        this.reconcileState = function (options) {\n            if (options === void 0) { options = {}; }\n            var _a = _this.getProps(), reconcileStateAlgorithm = _a.reconcileStateAlgorithm, settings = _a.settings;\n            var state = _this.getData().state;\n            var _b = options.transitions, transitions = _b === void 0 ? false : _b;\n            if (state && !isConsistentState(state, settings)) {\n                var reconciledState = (reconcileStateAlgorithm || reconcileState)(state, settings);\n                reconciledState = _this.applyPostProcess({\n                    name: 'reconcileState',\n                    immediately: true,\n                    transitions: transitions,\n                }, reconciledState);\n                _this.updateState(reconciledState, {\n                    transitions: transitions,\n                });\n            }\n        };\n        this.transformImage = function (transform, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.interaction, interaction = _b === void 0 ? true : _b, _c = options.immediately, immediately = _c === void 0 ? false : _c, _d = options.normalize, normalize = _d === void 0 ? true : _d;\n            var _e = _this.getProps(), transformImageAlgorithm = _e.transformImageAlgorithm, onTransformImage = _e.onTransformImage, onTransformImageEnd = _e.onTransformImageEnd, settings = _e.settings;\n            var state = _this.getData().state;\n            var callbacks = [];\n            if (state) {\n                if (normalize) {\n                    transform = normalizeImageTransform(state, transform);\n                }\n                var result = _this.applyPostProcess({\n                    name: 'transformImage',\n                    transitions: transitions,\n                    immediately: immediately,\n                }, (transformImageAlgorithm || transformImage)(state, settings, transform));\n                callbacks.push(onTransformImage);\n                if (interaction) {\n                    _this.setInteractions({\n                        transformImage: {\n                            rotate: !isUndefined(transform.rotate),\n                            flip: !isUndefined(transform.flip),\n                            scale: !isUndefined(transform.scale),\n                            move: !isUndefined(transform.move),\n                        },\n                    });\n                }\n                else {\n                    result = _this.applyPostProcess({\n                        name: 'transformImageEnd',\n                        transitions: transitions,\n                        immediately: true,\n                    }, result);\n                    callbacks.push(onTransformImageEnd);\n                }\n                _this.updateState(result, {\n                    transitions: immediately && transitions,\n                }, callbacks);\n            }\n        };\n        this.transformImageEnd = function (options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.immediately, immediately = _a === void 0 ? true : _a, _b = options.transitions, transitions = _b === void 0 ? true : _b;\n            var state = _this.getData().state;\n            var onTransformImageEnd = _this.getProps().onTransformImageEnd;\n            _this.updateState(function () { return state && _this.applyPostProcess({ name: 'transformImageEnd', immediately: immediately, transitions: transitions }, state); }, {\n                transitions: transitions,\n            }, [onTransformImageEnd]);\n            _this.setInteractions({\n                transformImage: {\n                    rotate: false,\n                    flip: false,\n                    scale: false,\n                    move: false,\n                },\n            });\n        };\n        this.zoomImage = function (scale, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? false : _d;\n            _this.transformImage({\n                scale: scale,\n            }, { interaction: interaction, immediately: immediately, transitions: transitions, normalize: normalize });\n        };\n        this.moveImage = function (left, top, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? false : _d;\n            _this.transformImage({\n                move: {\n                    left: left,\n                    top: top,\n                },\n            }, { interaction: interaction, immediately: immediately, transitions: transitions, normalize: normalize });\n        };\n        this.flipImage = function (horizontal, vertical, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? true : _d;\n            var state = _this.getState();\n            var flip = {\n                horizontal: horizontal,\n                vertical: vertical,\n            };\n            _this.transformImage({\n                flip: state && normalize ? normalizeFlip(state, flip) : flip,\n            }, { interaction: interaction, immediately: immediately, transitions: transitions });\n        };\n        this.rotateImage = function (rotate, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? false : _d;\n            _this.transformImage({\n                rotate: rotate,\n            }, { interaction: interaction, immediately: immediately, transitions: transitions, normalize: normalize });\n        };\n        this.reset = function (boundary, image) {\n            _this.resetState(boundary, image);\n        };\n        this.setState = function (modifier, options) {\n            if (options === void 0) { options = {}; }\n            var settings = _this.getSettings();\n            var state = _this.getData().state;\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? false : _b, _c = options.interaction, interaction = _c === void 0 ? false : _c, _d = options.postprocess, postprocess = _d === void 0 ? false : _d;\n            var newState = modifier && (isFunction(modifier) ? modifier(state, settings) : __assign(__assign({}, state), modifier));\n            _this.updateState(function () {\n                return postprocess\n                    ? newState &&\n                        _this.applyPostProcess({\n                            name: 'setState',\n                            immediately: immediately,\n                            transitions: transitions,\n                            interaction: interaction,\n                        }, newState)\n                    : newState;\n            }, {\n                transitions: transitions,\n            });\n        };\n        this.setCoordinates = function (transforms, options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var _a = _this.getProps(), setCoordinatesAlgorithm = _a.setCoordinatesAlgorithm, settings = _a.settings;\n            var _b = options.transitions, transitions = _b === void 0 ? true : _b, _c = options.immediately, immediately = _c === void 0 ? true : _c;\n            _this.updateState(function () {\n                return state &&\n                    _this.applyPostProcess({\n                        name: 'setCoordinates',\n                        immediately: immediately,\n                        transitions: transitions,\n                    }, (setCoordinatesAlgorithm || setCoordinates)(state, settings, transforms, SetCoordinatesMode.zoom));\n            }, {\n                transitions: transitions,\n            });\n        };\n        this.setVisibleArea = function (visibleArea, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b;\n            var state = _this.getData().state;\n            var _c = _this.getProps(), setVisibleAreaAlgorithm = _c.setVisibleAreaAlgorithm, settings = _c.settings;\n            _this.updateState(function () {\n                return state &&\n                    _this.applyPostProcess({ name: 'setVisibleArea', immediately: immediately, transitions: transitions }, (setVisibleAreaAlgorithm || setVisibleArea)(state, settings, visibleArea));\n            }, {\n                transitions: transitions,\n            });\n        };\n        this.setBoundary = function (boundary, options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var _a = _this.getProps(), setBoundaryAlgorithm = _a.setBoundaryAlgorithm, settings = _a.settings;\n            var _b = options.transitions, transitions = _b === void 0 ? false : _b, _c = options.immediately, immediately = _c === void 0 ? true : _c;\n            if (boundary) {\n                _this.updateState(function () {\n                    return state &&\n                        _this.applyPostProcess({ name: 'setBoundary', immediately: immediately, transitions: transitions }, (setBoundaryAlgorithm || setBoundary)(state, settings, boundary));\n                });\n            }\n            else {\n                _this.updateState(null);\n            }\n        };\n        this.moveCoordinates = function (directions, options) {\n            if (options === void 0) { options = {}; }\n            var data = _this.getData();\n            var _a = _this.getProps(), moveCoordinatesAlgorithm = _a.moveCoordinatesAlgorithm, onMove = _a.onMove, onMoveEnd = _a.onMoveEnd, settings = _a.settings;\n            var _b = options.interaction, interaction = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? false : _c, _d = options.immediately, immediately = _d === void 0 ? false : _d, _e = options.normalize, normalize = _e === void 0 ? true : _e;\n            var callbacks = [];\n            if (!data.transitions && data.state) {\n                var normalizedDirections = normalize\n                    ? normalizeMoveDirections(data.state, directions)\n                    : fillMoveDirections(directions);\n                var result = _this.applyPostProcess({ name: 'moveCoordinates', interaction: interaction, immediately: immediately, transitions: transitions }, (moveCoordinatesAlgorithm || moveCoordinates)(data.state, settings, normalizedDirections));\n                callbacks.push(onMove);\n                if (interaction) {\n                    _this.setInteractions({\n                        moveCoordinates: true,\n                    });\n                }\n                else {\n                    result = _this.applyPostProcess({ name: 'moveCoordinatesEnd', interaction: interaction, immediately: immediately, transitions: transitions }, result);\n                    callbacks.push(onMoveEnd);\n                }\n                _this.updateState(result, {\n                    transitions: immediately && transitions,\n                }, callbacks);\n            }\n        };\n        this.moveCoordinatesEnd = function (options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var onMoveEnd = _this.getProps().onMoveEnd;\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? false : _b;\n            _this.updateState(function () { return state && _this.applyPostProcess({ name: 'moveCoordinatesEnd', transitions: transitions, immediately: immediately }, state); }, {\n                transitions: transitions,\n            }, [onMoveEnd]);\n            _this.setInteractions({\n                moveCoordinates: false,\n            });\n        };\n        this.resizeCoordinates = function (directions, parameters, options) {\n            if (parameters === void 0) { parameters = {}; }\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var _a = _this.getProps(), resizeCoordinatesAlgorithm = _a.resizeCoordinatesAlgorithm, onResize = _a.onResize, onResizeEnd = _a.onResizeEnd, settings = _a.settings;\n            var _b = options.interaction, interaction = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? false : _c, _d = options.immediately, immediately = _d === void 0 ? false : _d, _e = options.normalize, normalize = _e === void 0 ? true : _e;\n            var transitionsOptions = _this.getTransitions();\n            if (!transitionsOptions.active && state) {\n                var callbacks = [];\n                var normalizedDirections = normalize\n                    ? normalizeResizeDirections(state, directions)\n                    : fillResizeDirections(directions);\n                var result = _this.applyPostProcess({ name: 'resizeCoordinates', interaction: interaction, immediately: immediately, transitions: transitions }, (resizeCoordinatesAlgorithm || resizeCoordinates)(state, settings, normalizedDirections, parameters));\n                callbacks.push(onResize);\n                if (interaction) {\n                    _this.setInteractions({\n                        resizeCoordinates: true,\n                    });\n                }\n                else {\n                    result = _this.applyPostProcess({ name: 'resizeCoordinatesEnd', interaction: interaction, immediately: immediately, transitions: transitions }, result);\n                    callbacks.push(onResizeEnd);\n                }\n                _this.updateState(result, {\n                    transitions: immediately && transitions,\n                }, callbacks);\n            }\n        };\n        this.resizeCoordinatesEnd = function (options) {\n            if (options === void 0) { options = {}; }\n            var onResizeEnd = _this.getProps().onResizeEnd;\n            var state = _this.getData().state;\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? false : _b;\n            _this.updateState(function () { return state && _this.applyPostProcess({ name: 'resizeCoordinatesEnd', transitions: transitions, immediately: immediately }, state); }, {\n                transitions: transitions,\n            }, [onResizeEnd]);\n            _this.setInteractions({\n                resizeCoordinates: false,\n            });\n        };\n        this.getStencilCoordinates = function () {\n            var state = _this.getData().state;\n            return getStencilCoordinates(state);\n        };\n        this.getCoordinates = function (options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var settings = _this.getProps().settings;\n            if (state && state.coordinates) {\n                var _a = options.round, round = _a === void 0 ? true : _a;\n                if (round) {\n                    return getRoundedCoordinates(state, settings);\n                }\n                else {\n                    return __assign({}, state.coordinates);\n                }\n            }\n            else {\n                return null;\n            }\n        };\n        this.getVisibleArea = function () {\n            var state = _this.getData().state;\n            if (state) {\n                return __assign({}, state.visibleArea);\n            }\n            else {\n                return null;\n            }\n        };\n        this.getSettings = function () {\n            var settings = _this.getProps().settings;\n            return __assign({}, settings);\n        };\n        this.getState = function () {\n            var state = _this.getData().state;\n            return copyState(state);\n        };\n        this.getTransforms = function () {\n            var state = _this.getData().state;\n            return state\n                ? deepClone(state.transforms)\n                : {\n                    rotate: 0,\n                    flip: {\n                        horizontal: false,\n                        vertical: false,\n                    },\n                };\n        };\n        this.createDefaultState = function (boundary, image) {\n            var _a = _this.getProps(), defaultTransforms = _a.defaultTransforms, createStateAlgorithm = _a.createStateAlgorithm, priority = _a.priority, settings = _a.settings;\n            var transforms = image.transforms;\n            if (defaultTransforms) {\n                transforms = isFunction(defaultTransforms) ? defaultTransforms(image) : defaultTransforms;\n            }\n            return _this.applyPostProcess({\n                name: 'createState',\n                immediately: true,\n                transitions: false,\n            }, (createStateAlgorithm || createState)({\n                boundary: boundary,\n                imageSize: { width: image.width, height: image.height },\n                transforms: transforms,\n                priority: priority,\n            }, settings));\n        };\n        this.isConsistent = function () {\n            var state = _this.getData().state;\n            var settings = _this.getProps().settings;\n            return state ? isConsistentState(state, settings) : true;\n        };\n    }\n    return AbstractCropper;\n}());\n\nexport { AbstractCropper };\n","import { __extends } from 'tslib';\nimport { emptyInteractions } from '../service/interactions.js';\nimport { AbstractCropper } from './AbstractCropper.js';\n\nvar CropperInstance = /** @class */ (function (_super) {\n    __extends(CropperInstance, _super);\n    function CropperInstance(props) {\n        var _this = _super.call(this) || this;\n        _this.props = props;\n        if (!_this.isControlled()) {\n            _this.data = {\n                state: null,\n                transitions: false,\n                interactions: emptyInteractions(),\n            };\n        }\n        return _this;\n    }\n    CropperInstance.prototype.isControlled = function () {\n        return Boolean(this.props.getData);\n    };\n    CropperInstance.prototype.setData = function (data) {\n        var _a, _b;\n        if (!this.isControlled()) {\n            this.data = data;\n        }\n        (_b = (_a = this.props).setData) === null || _b === void 0 ? void 0 : _b.call(_a, data);\n    };\n    CropperInstance.prototype.getProps = function () {\n        return this.props.getProps();\n    };\n    CropperInstance.prototype.getData = function () {\n        var _a, _b;\n        return (this.isControlled() ? (_b = (_a = this.props).getData) === null || _b === void 0 ? void 0 : _b.call(_a) : this.data);\n    };\n    return CropperInstance;\n}(AbstractCropper));\n\nexport { CropperInstance };\n","var timingFunctions = {\n    linear: function (t) {\n        return t;\n    },\n    'ease-in': function (t) {\n        return Math.pow(t, 1.675);\n    },\n    'ease-out': function (t) {\n        return 1 - Math.pow(1 - t, 1.675);\n    },\n    'ease-in-out': function (t) {\n        return 0.5 * (Math.sin((t - 0.5) * Math.PI) + 1);\n    },\n};\nvar Animation = /** @class */ (function () {\n    function Animation() {\n        this.active = false;\n    }\n    Animation.prototype.start = function (animation) {\n        var _a;\n        this.onStart = animation.onStart;\n        this.onProgress = animation.onProgress;\n        this.onStop = animation.onStop;\n        if (!this.active) {\n            (_a = this.onStart) === null || _a === void 0 ? void 0 : _a.call(this);\n        }\n        if (this.id) {\n            window.cancelAnimationFrame(this.id);\n        }\n        this.startTime = performance.now();\n        this.timingFunction = animation.timingFunction;\n        this.endTime = this.startTime + animation.duration;\n        this.active = true;\n        this.animate();\n    };\n    Animation.prototype.animate = function () {\n        var _this = this;\n        if (this.startTime && this.endTime) {\n            var timingFunction = timingFunctions[this.timingFunction];\n            if (!timingFunction) {\n                if (process.env.NODE_ENV !== 'production') {\n                    console.warn(\"[Animation] The timing function '\" + timingFunction + \"' is not supported. Available timing function: 'linear', 'ease-in', 'ease-in-out', 'ease-out'. Reset to 'ease-out'.\");\n                }\n                timingFunction = timingFunctions['ease-out'];\n            }\n            var percent = 1 - (this.endTime - performance.now()) / (this.endTime - this.startTime);\n            var progress = Math.min(1, timingFunction(percent));\n            if (this.onProgress) {\n                this.onProgress(progress);\n            }\n            if (percent < 1) {\n                this.id = window.requestAnimationFrame(function () { return _this.animate(); });\n            }\n            else {\n                this.stop();\n            }\n        }\n        else {\n            this.stop();\n        }\n    };\n    Animation.prototype.stop = function () {\n        this.active = false;\n        if (this.id) {\n            window.cancelAnimationFrame(this.id);\n        }\n        if (this.onStop) {\n            this.onStop();\n        }\n    };\n    return Animation;\n}());\n\nexport { Animation };\n","import { __assign } from 'tslib';\nimport { isNumeric } from '../utils/index.js';\nimport { rotateSize, rotatePoint, getCenter } from '../service/utils.js';\nimport { isInitializedState } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction prepareSource(canvas, image, _a) {\n    var rotate = _a.rotate, flip = _a.flip;\n    var originalSize = {\n        width: 'naturalWidth' in image ? image.naturalWidth : image.width,\n        height: 'naturalHeight' in image ? image.naturalHeight : image.height,\n    };\n    var transformedSize = rotateSize(originalSize, rotate);\n    var ctx = canvas.getContext('2d');\n    canvas.height = transformedSize.height;\n    canvas.width = transformedSize.width;\n    if (ctx) {\n        ctx.save();\n        // Rotation:\n        var canvasCenter = rotatePoint(getCenter(__assign({ left: 0, top: 0 }, originalSize)), rotate);\n        ctx.translate(-(canvasCenter.left - transformedSize.width / 2), -(canvasCenter.top - transformedSize.height / 2));\n        ctx.rotate((rotate * Math.PI) / 180);\n        // Reflection;\n        ctx.translate(flip.horizontal ? originalSize.width : 0, flip.vertical ? originalSize.height : 0);\n        ctx.scale(flip.horizontal ? -1 : 1, flip.vertical ? -1 : 1);\n        ctx.drawImage(image, 0, 0, originalSize.width, originalSize.height);\n        ctx.restore();\n    }\n    return canvas;\n}\nfunction updateCanvas(canvas, source, coordinates, resultSize, options) {\n    canvas.width = resultSize ? resultSize.width : coordinates.width;\n    canvas.height = resultSize ? resultSize.height : coordinates.height;\n    var ctx = canvas.getContext('2d');\n    if (ctx) {\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        if (options) {\n            if (options.imageSmoothingEnabled) {\n                ctx.imageSmoothingEnabled = options.imageSmoothingEnabled;\n            }\n            if (options.imageSmoothingQuality) {\n                ctx.imageSmoothingQuality = options.imageSmoothingQuality;\n            }\n            if (options.fillColor) {\n                ctx.fillStyle = options.fillColor;\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n                ctx.save();\n            }\n        }\n        ctx.drawImage(source, coordinates.left, coordinates.top, coordinates.width, coordinates.height, 0, 0, canvas.width, canvas.height);\n    }\n    return canvas;\n}\nfunction drawCroppedArea(state, image, resultCanvas, spareCanvas, options) {\n    if (isInitializedState(state)) {\n        var transforms = state.transforms, coordinates = state.coordinates;\n        var imageTransformed = transforms.rotate !== 0 || transforms.flip.horizontal || transforms.flip.vertical;\n        var source = imageTransformed ? prepareSource(spareCanvas, image, transforms) : image;\n        var params = __assign({ minWidth: 0, minHeight: 0, maxWidth: Infinity, maxHeight: Infinity, maxArea: Infinity, imageSmoothingEnabled: true, imageSmoothingQuality: 'high', fillColor: 'transparent' }, options);\n        var firstNumeric = function (array) { return array.find(function (el) { return isNumeric(el); }); };\n        var size = approximateSize({\n            sizeRestrictions: {\n                minWidth: firstNumeric([params.width, params.minWidth]) || 0,\n                minHeight: firstNumeric([params.height, params.minHeight]) || 0,\n                maxWidth: firstNumeric([params.width, params.maxWidth]) || Infinity,\n                maxHeight: firstNumeric([params.height, params.maxHeight]) || Infinity,\n            },\n            width: coordinates.width,\n            height: coordinates.height,\n            aspectRatio: {\n                minimum: coordinates.width / coordinates.height,\n                maximum: coordinates.width / coordinates.height,\n            },\n        });\n        if (params.maxArea && size.width * size.height > params.maxArea) {\n            var scale = Math.sqrt(params.maxArea / (size.width * size.height));\n            size = {\n                width: Math.round(scale * size.width),\n                height: Math.round(scale * size.height),\n            };\n        }\n        return updateCanvas(resultCanvas, source, coordinates, size, params);\n    }\n    else {\n        return null;\n    }\n}\n\nexport { drawCroppedArea, prepareSource, updateCanvas };\n","import 'tslib';\nimport { ratio } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction stretchCropperBoundary(boundary, stretcher, size) {\n    // Reset stretcher\n    stretcher.style.width = \"0px\";\n    stretcher.style.height = \"0px\";\n    // Try to fit the size by width:\n    stretcher.style.width = Math.max(boundary.clientWidth, size.width) + \"px\";\n    // After that try to fit the size by height and resulted width:\n    var ratio = size.width / size.height;\n    stretcher.style.height = Math.max(boundary.clientHeight, stretcher.clientWidth / ratio) + \"px\";\n    stretcher.style.width = stretcher.clientHeight * ratio + \"px\";\n}\nfunction stretchPreviewBoundary(boundary, stretcher, size) {\n    // Reset stretcher\n    stretcher.style.width = \"0px\";\n    stretcher.style.height = \"0px\";\n    // Stretch the boundary with respect to its width\n    var width = Math.max(boundary.clientWidth, size.width);\n    stretcher.style.width = width + \"px\";\n    stretcher.style.height = width / ratio(size) + \"px\";\n    // If the height of boundary larger than current stretcher height\n    // stretch the boundary with respect to its height\n    if (stretcher.clientHeight < boundary.clientHeight) {\n        stretcher.style.height = boundary.clientHeight + \"px\";\n        stretcher.style.width = stretcher.clientHeight * ratio(size) + \"px\";\n    }\n}\n\nexport { stretchCropperBoundary, stretchPreviewBoundary };\n","import { __assign } from 'tslib';\nimport { isCrossOriginURL, isBlob, isLocal } from '../utils/index.js';\nimport { getTransformedImageSize, getCoefficient } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nvar XHR_DONE = 4;\nfunction base64ToArrayBuffer(base64) {\n    base64 = base64.replace(/^data:([^;]+);base64,/gim, '');\n    var binary = atob(base64);\n    var len = binary.length;\n    var buffer = new ArrayBuffer(len);\n    var view = new Uint8Array(buffer);\n    for (var i = 0; i < len; i++) {\n        view[i] = binary.charCodeAt(i);\n    }\n    return buffer;\n}\nfunction objectURLToBlob(url, callback) {\n    var http = new XMLHttpRequest();\n    http.open('GET', url, true);\n    http.responseType = 'blob';\n    http.onload = function () {\n        if (this.status == 200 || this.status === 0) {\n            callback(this.response);\n        }\n    };\n    http.send();\n}\nfunction getTransforms(orientation) {\n    var result = {\n        flip: {\n            horizontal: false,\n            vertical: false,\n        },\n        rotate: 0,\n    };\n    if (orientation) {\n        switch (orientation) {\n            case 2:\n                result.flip.horizontal = true;\n                break;\n            case 3:\n                result.rotate = -180;\n                break;\n            case 4:\n                result.flip.vertical = true;\n                break;\n            case 5:\n                result.rotate = 90;\n                result.flip.vertical = true;\n                break;\n            case 6:\n                result.rotate = 90;\n                break;\n            case 7:\n                result.rotate = 90;\n                result.flip.horizontal = true;\n                break;\n            case 8:\n                result.rotate = -90;\n                break;\n        }\n    }\n    return result;\n}\nfunction getImageData(img) {\n    return new Promise(function (resolve, reject) {\n        try {\n            if (img) {\n                if (/^data:/i.test(img)) {\n                    // Data URL\n                    resolve(base64ToArrayBuffer(img));\n                }\n                else if (/^blob:/i.test(img)) {\n                    // Blob\n                    var fileReader_1 = new FileReader();\n                    fileReader_1.onload = function (e) {\n                        var _a;\n                        resolve((_a = e.target) === null || _a === void 0 ? void 0 : _a.result);\n                    };\n                    objectURLToBlob(img, function (blob) {\n                        fileReader_1.readAsArrayBuffer(blob);\n                    });\n                }\n                else {\n                    // Simple URL\n                    var http_1 = new XMLHttpRequest();\n                    http_1.onreadystatechange = function () {\n                        if (http_1.readyState !== XHR_DONE)\n                            return;\n                        if (http_1.status === 200 || http_1.status === 0) {\n                            resolve(http_1.response);\n                        }\n                        else {\n                            reject('Warning: could not load an image to parse its orientation');\n                        }\n                    };\n                    http_1.onprogress = function () {\n                        // Abort the request directly if it not a JPEG image for better performance\n                        if (http_1.getResponseHeader('content-type') !== 'image/jpeg') {\n                            http_1.abort();\n                        }\n                    };\n                    http_1.withCredentials = false;\n                    http_1.open('GET', img, true);\n                    http_1.responseType = 'arraybuffer';\n                    http_1.send(null);\n                }\n            }\n            else {\n                reject('Error: the image is empty');\n            }\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n}\nfunction getStyleTransforms(_a) {\n    var rotate = _a.rotate, flip = _a.flip, scale = _a.scale;\n    var transform = '';\n    transform += \" rotate(\" + rotate + \"deg) \";\n    transform += \" scaleX(\" + scale * (flip.horizontal ? -1 : 1) + \") \";\n    transform += \" scaleY(\" + scale * (flip.vertical ? -1 : 1) + \") \";\n    return transform;\n}\nfunction getStringFromCharCode(dataView, start, length) {\n    var str = '';\n    var i;\n    for (i = start, length += start; i < length; i++) {\n        str += String.fromCharCode(dataView.getUint8(i));\n    }\n    return str;\n}\nfunction resetAndGetOrientation(arrayBuffer) {\n    try {\n        var dataView = new DataView(arrayBuffer);\n        var orientation_1;\n        var exifIDCode = void 0;\n        var tiffOffset = void 0;\n        var littleEndian = void 0;\n        var app1Start = void 0;\n        var ifdStart = void 0;\n        // Only handle JPEG image (start by 0xFFD8)\n        if (dataView.getUint8(0) === 0xff && dataView.getUint8(1) === 0xd8) {\n            var length_1 = dataView.byteLength;\n            var offset = 2;\n            while (offset + 1 < length_1) {\n                if (dataView.getUint8(offset) === 0xff && dataView.getUint8(offset + 1) === 0xe1) {\n                    app1Start = offset;\n                    break;\n                }\n                offset++;\n            }\n        }\n        if (app1Start) {\n            exifIDCode = app1Start + 4;\n            tiffOffset = app1Start + 10;\n            if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n                var endianness = dataView.getUint16(tiffOffset);\n                littleEndian = endianness === 0x4949;\n                if (littleEndian || endianness === 0x4d4d /* bigEndian */) {\n                    if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002a) {\n                        var firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n                        if (firstIFDOffset >= 0x00000008) {\n                            ifdStart = tiffOffset + firstIFDOffset;\n                        }\n                    }\n                }\n            }\n        }\n        if (ifdStart) {\n            var length_2 = dataView.getUint16(ifdStart, littleEndian);\n            for (var i = 0; i < length_2; i++) {\n                var offset = ifdStart + i * 12 + 2;\n                if (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\n                    // 8 is the offset of the current tag's value\n                    offset += 8;\n                    // Get the original orientation value\n                    orientation_1 = dataView.getUint16(offset, littleEndian);\n                    // Override the orientation with its default value\n                    dataView.setUint16(offset, 1, littleEndian);\n                    break;\n                }\n            }\n        }\n        return orientation_1;\n    }\n    catch (error) {\n        return null;\n    }\n}\nfunction arrayBufferToDataURL(arrayBuffer) {\n    var chunks = [];\n    // Chunk Typed Array for better performance\n    var chunkSize = 8192;\n    var uint8 = new Uint8Array(arrayBuffer);\n    while (uint8.length > 0) {\n        var value = uint8.subarray(0, chunkSize);\n        chunks.push(String.fromCharCode.apply(null, (Array.from ? Array.from(value) : value.slice())));\n        uint8 = uint8.subarray(chunkSize);\n    }\n    return \"data:image/jpeg;base64,\" + btoa(chunks.join(''));\n}\nfunction getImage(_a) {\n    var src = _a.src, _b = _a.arrayBuffer, arrayBuffer = _b === void 0 ? null : _b, _c = _a.orientation, orientation = _c === void 0 ? null : _c;\n    var options = {\n        src: src,\n        arrayBuffer: arrayBuffer,\n        revoke: false,\n        transforms: {\n            flip: {\n                horizontal: false,\n                vertical: false,\n            },\n            rotate: 0,\n        },\n    };\n    if (arrayBuffer && orientation && orientation > 1) {\n        if (isBlob(src) || !isLocal(src)) {\n            options.src = URL.createObjectURL(new Blob([arrayBuffer]));\n            options.revoke = true;\n        }\n        else {\n            options.src = arrayBufferToDataURL(arrayBuffer);\n        }\n    }\n    else {\n        options.src = src;\n    }\n    if (orientation) {\n        options.transforms = getTransforms(orientation);\n    }\n    return options;\n}\nfunction parseImage(src, settings) {\n    if (settings === void 0) { settings = {}; }\n    var checkOrientation = settings.checkOrientation, parse = settings.parse;\n    return new Promise(function (resolve) {\n        if (checkOrientation || parse) {\n            getImageData(src)\n                .then(function (data) {\n                var orientation = resetAndGetOrientation(data);\n                resolve(getImage(data\n                    ? { src: src, arrayBuffer: data, orientation: orientation }\n                    : { src: src, arrayBuffer: null, orientation: null }));\n            })\n                .catch(function (error) {\n                console.warn(error);\n                resolve(getImage({ src: src }));\n            });\n        }\n        else {\n            resolve(getImage({ src: src }));\n        }\n    });\n}\nfunction createImage(src, settings) {\n    if (settings === void 0) { settings = {}; }\n    return new Promise(function (resolve, reject) {\n        var image = document.createElement('img');\n        if (settings.crossOrigin) {\n            image.crossOrigin = settings.crossOrigin !== true ? settings.crossOrigin : 'anonymous';\n        }\n        image.src = src;\n        image.style.visibility = 'hidden';\n        image.style.position = 'fixed';\n        document.body.appendChild(image);\n        if (image.complete) {\n            resolve(image);\n            document.body.removeChild(image);\n        }\n        else {\n            image.addEventListener('load', function () {\n                resolve(image);\n                document.body.removeChild(image);\n            });\n            image.addEventListener('error', function () {\n                reject(null);\n                document.body.removeChild(image);\n            });\n        }\n    });\n}\nfunction loadImage(src, settings) {\n    if (settings === void 0) { settings = {}; }\n    return parseImage(src, __assign(__assign({}, settings), { crossOrigin: isCrossOriginURL(src) && settings.crossOrigin })).then(function (options) {\n        return new Promise(function (resolve, reject) {\n            createImage(options.src, settings)\n                .then(function (image) {\n                resolve(__assign(__assign({}, options), { width: image.naturalWidth, height: image.naturalHeight }));\n            })\n                .catch(function () {\n                reject(null);\n            });\n        });\n    });\n}\nfunction getImageStyle(image, state, area, coefficient, transitions) {\n    if (transitions === void 0) { transitions = null; }\n    var optimalImageSize = image.width > image.height\n        ? {\n            width: Math.min(512, image.width),\n            height: Math.min(512, image.width) / (image.width / image.height),\n        }\n        : {\n            height: Math.min(512, image.height),\n            width: Math.min(512, image.height) * (image.width / image.height),\n        };\n    var actualImageSize = getTransformedImageSize(state);\n    var imageTransforms = {\n        rotate: state.transforms.rotate,\n        flip: {\n            horizontal: state.transforms.flip.horizontal,\n            vertical: state.transforms.flip.vertical,\n        },\n        translateX: area.left / coefficient,\n        translateY: area.top / coefficient,\n        scale: 1 / coefficient,\n    };\n    var compensations = {\n        rotate: {\n            left: (optimalImageSize.width - actualImageSize.width) / (2 * coefficient),\n            top: (optimalImageSize.height - actualImageSize.height) / (2 * coefficient),\n        },\n        scale: {\n            left: ((1 - 1 / coefficient) * optimalImageSize.width) / 2,\n            top: ((1 - 1 / coefficient) * optimalImageSize.height) / 2,\n        },\n    };\n    var transforms = __assign(__assign({}, imageTransforms), { scale: imageTransforms.scale * (image.width / optimalImageSize.width) });\n    var result = {\n        width: optimalImageSize.width + \"px\",\n        height: optimalImageSize.height + \"px\",\n        left: '0px',\n        top: '0px',\n        transition: 'none',\n        transform: \"translate3d(\" + (-compensations.rotate.left - compensations.scale.left - imageTransforms.translateX) + \"px, \" + (-compensations.rotate.top - compensations.scale.top - imageTransforms.translateY) + \"px, 0px)\" + getStyleTransforms(transforms),\n        willChange: 'none',\n    };\n    if (transitions && transitions.active) {\n        result.willChange = 'transform';\n        result.transition = transitions.duration + \"ms \" + transitions.timingFunction;\n    }\n    return result;\n}\nfunction getBackgroundStyle(image, state, transitions) {\n    if (transitions === void 0) { transitions = null; }\n    if (image && state && state.visibleArea) {\n        return getImageStyle(image, state, state.visibleArea, getCoefficient(state), transitions);\n    }\n    else {\n        return {};\n    }\n}\nfunction getPreviewStyle(image, state, coefficient, transitions) {\n    if (transitions === void 0) { transitions = null; }\n    if (image && state && state.visibleArea && state.coordinates) {\n        return getImageStyle(image, state, state.coordinates, coefficient, transitions);\n    }\n    else {\n        return {};\n    }\n}\n\nexport { createImage, getBackgroundStyle, getImageStyle, getPreviewStyle, getStyleTransforms, loadImage };\n","import { isUndefined } from 'advanced-cropper';\nimport React, { forwardRef } from 'react';\nimport { AbstractCropperProps } from '../components/AbstractCropper';\n\ntype MainProps = Omit<AbstractCropperProps<any>, 'settings'>;\n\nfunction omitEmpty<Obj extends object>(obj: Obj) {\n\tconst properties: Partial<Obj> = {};\n\n\t(Object.keys(obj) as (keyof Obj)[]).forEach((key) => {\n\t\tif (!isUndefined(obj[key])) {\n\t\t\tproperties[key] = obj[key];\n\t\t}\n\t});\n\treturn properties;\n}\n\nexport function splitAbstractCropperProps<Props extends MainProps>(props: Props) {\n\tconst {\n\t\tsrc,\n\t\tautoReconcileState,\n\t\tbackgroundWrapperComponent,\n\t\tbackgroundWrapperProps,\n\t\twrapperComponent,\n\t\twrapperProps,\n\t\tstencilComponent,\n\t\tstencilConstraints,\n\t\tstencilProps,\n\t\tclassName,\n\t\timageClassName,\n\t\tboundaryClassName,\n\t\tbackgroundClassName,\n\t\tbackgroundComponent,\n\t\tbackgroundProps,\n\t\tcheckOrientation,\n\t\tcanvas,\n\t\tcrossOrigin,\n\t\tboundarySizeAlgorithm,\n\t\tboundaryStretchAlgorithm,\n\t\tstyle,\n\t\tonReady,\n\t\tonError,\n\t\tunloadTime,\n\t\tgetInstance,\n\t\tonTransitionsStart,\n\t\tonTransitionsEnd,\n\t\tonChange,\n\t\tonResizeEnd,\n\t\tonMoveEnd,\n\t\tonMove,\n\t\tonResize,\n\t\tonTransformImage,\n\t\tonTransformImageEnd,\n\t\tonInteractionStart,\n\t\tonInteractionEnd,\n\t\ttransitions,\n\t\tpostProcess,\n\t\tsetCoordinatesAlgorithm,\n\t\tsetVisibleAreaAlgorithm,\n\t\tsetBoundaryAlgorithm,\n\t\ttransformImageAlgorithm,\n\t\tmoveCoordinatesAlgorithm,\n\t\tresizeCoordinatesAlgorithm,\n\t\tcreateStateAlgorithm,\n\t\treconcileStateAlgorithm,\n\t\tdefaultTransforms,\n\t\tpriority,\n\t\t...settings\n\t} = props;\n\n\treturn {\n\t\t...omitEmpty({\n\t\t\tsrc,\n\t\t\tautoReconcileState,\n\t\t\tbackgroundWrapperComponent,\n\t\t\tbackgroundWrapperProps,\n\t\t\twrapperComponent,\n\t\t\twrapperProps,\n\t\t\tstencilComponent,\n\t\t\tstencilConstraints,\n\t\t\tstencilProps,\n\t\t\tclassName,\n\t\t\timageClassName,\n\t\t\tboundaryClassName,\n\t\t\tbackgroundClassName,\n\t\t\tbackgroundComponent,\n\t\t\tbackgroundProps,\n\t\t\tcheckOrientation,\n\t\t\tcanvas,\n\t\t\tcrossOrigin,\n\t\t\tboundarySizeAlgorithm,\n\t\t\tboundaryStretchAlgorithm: boundaryStretchAlgorithm,\n\t\t\tstyle,\n\t\t\tonReady,\n\t\t\tonError,\n\t\t\tunloadTime,\n\t\t\tgetInstance,\n\t\t\tonTransitionsStart,\n\t\t\tonTransitionsEnd,\n\t\t\tonChange,\n\t\t\tonResizeEnd,\n\t\t\tonMoveEnd,\n\t\t\tonMove,\n\t\t\tonResize,\n\t\t\tonTransformImage,\n\t\t\tonTransformImageEnd,\n\t\t\tonInteractionStart,\n\t\t\tonInteractionEnd,\n\t\t\ttransitions,\n\t\t\tpostProcess,\n\t\t\tsetCoordinatesAlgorithm,\n\t\t\tsetVisibleAreaAlgorithm,\n\t\t\tsetBoundaryAlgorithm,\n\t\t\ttransformImageAlgorithm,\n\t\t\tmoveCoordinatesAlgorithm,\n\t\t\tresizeCoordinatesAlgorithm,\n\t\t\tcreateStateAlgorithm,\n\t\t\treconcileStateAlgorithm,\n\t\t\tdefaultTransforms,\n\t\t\tpriority,\n\t\t}),\n\t\tsettings,\n\t};\n}\n\nexport function createCropper<T, P = {}>(\n\trender: (props: P, ref: React.Ref<T>) => React.ReactElement | null,\n): (props: P & React.RefAttributes<T>) => React.ReactElement | null {\n\treturn forwardRef<T, P>(render);\n}\n","import {\n\tapplyMove,\n\tapplyScale,\n\tdiff,\n\tfitToSizeRestrictions,\n\tgetAreaPositionRestrictions,\n\tgetAreaSizeRestrictions,\n\tgetCenter,\n\tgetPositionRestrictions,\n\tisInitializedState,\n\tmergePositionRestrictions,\n\tmoveToPositionRestrictions,\n\tratio,\n\tcoordinatesToPositionRestrictions,\n} from 'advanced-cropper/service';\nimport { CoreSettings, CropperState, PostprocessAction, Size } from 'advanced-cropper';\nimport { copyState } from 'advanced-cropper/state';\n\nexport function hybridStencilAutoZoomAlgorithm(state: CropperState, settings: CoreSettings): CropperState {\n\tif (isInitializedState(state)) {\n\t\tconst result = copyState(state);\n\n\t\t// Checks that coordinates has the same ratio that coordinates:\n\t\tconst stencil: Size = {\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t};\n\n\t\tif (ratio(result.boundary) > ratio(result.coordinates)) {\n\t\t\tstencil.height = result.boundary.height * 0.8;\n\t\t\tstencil.width = stencil.height * ratio(result.coordinates);\n\t\t} else {\n\t\t\tstencil.width = result.boundary.width * 0.8;\n\t\t\tstencil.height = stencil.width * ratio(result.coordinates);\n\t\t}\n\n\t\t// First of all try to resize visible area as much as possible:\n\t\tresult.visibleArea = applyScale(\n\t\t\tresult.visibleArea,\n\t\t\t(result.coordinates.width * result.boundary.width) / (result.visibleArea.width * stencil.width),\n\t\t);\n\n\t\t// Check that visible area doesn't break the area restrictions:\n\t\tconst scale = fitToSizeRestrictions(result.visibleArea, getAreaSizeRestrictions(result, settings));\n\n\t\tresult.visibleArea = applyScale(result.visibleArea, scale);\n\n\t\tif (scale !== 1) {\n\t\t\tstencil.height /= scale;\n\t\t\tstencil.width /= scale;\n\t\t}\n\n\t\tresult.visibleArea = applyMove(\n\t\t\tresult.visibleArea,\n\t\t\tdiff(getCenter(result.coordinates), getCenter(result.visibleArea)),\n\t\t);\n\n\t\t// Center stencil in visible area:\n\t\tresult.visibleArea = moveToPositionRestrictions(\n\t\t\tresult.visibleArea,\n\t\t\tgetAreaPositionRestrictions(result, settings),\n\t\t);\n\n\t\tresult.coordinates = moveToPositionRestrictions(\n\t\t\tresult.coordinates,\n\t\t\tmergePositionRestrictions(\n\t\t\t\tcoordinatesToPositionRestrictions(result.visibleArea),\n\t\t\t\tgetPositionRestrictions(result, settings),\n\t\t\t),\n\t\t);\n\n\t\treturn result;\n\t}\n\treturn state;\n}\n\nexport function hybridStencilAutoZoom(\n\tstate: CropperState,\n\tsettings: CoreSettings,\n\taction: PostprocessAction,\n): CropperState {\n\tif (action.immediately) {\n\t\treturn hybridStencilAutoZoomAlgorithm(state, settings);\n\t}\n\treturn state;\n}\n","import { useRef } from 'react';\nimport { deprecationWarning } from '../service/utils';\n\nexport function useDeprecationWarning() {\n\tconst fired = useRef<string[]>([]);\n\n\treturn (message: string) => {\n\t\tif (fired.current.indexOf(message) === -1) {\n\t\t\tdeprecationWarning(message);\n\t\t\tfired.current.push(message);\n\t\t}\n\t};\n}\n","export function deprecationWarning(text: string) {\n\tif (process.env.NODE_ENV === 'development') {\n\t\tconsole.warn(`Deprecation warning: ${text}`);\n\t}\n}\n","/*!\n  Copyright (c) 2018 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString === Object.prototype.toString) {\n\t\t\t\t\tfor (var key in arg) {\n\t\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import { useEffect, useRef } from 'react';\n\nexport const useWindowResize = (callback: (...args: unknown[]) => void) => {\n\tconst callbackRef = useRef<Function>(callback);\n\n\tconst internalCallback = () => {\n\t\tif (callbackRef.current) {\n\t\t\tcallbackRef.current();\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tcallbackRef.current = callback;\n\t}, [callback]);\n\n\tuseEffect(() => {\n\t\twindow.addEventListener('resize', internalCallback);\n\t\twindow.addEventListener('orientationchange', internalCallback);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('resize', internalCallback);\n\t\t\twindow.removeEventListener('orientationchange', internalCallback);\n\t\t};\n\t}, []);\n};\n","import { useEffect, useRef, useState } from 'react';\nimport { CropperImage, isUndefined, promiseTimeout, loadImage } from 'advanced-cropper';\n\nexport interface CropperImageHookSettings {\n\tsrc?: string | null;\n\tonLoadingStart?: () => void;\n\tonLoadingEnd?: () => void;\n\tonError?: () => void;\n\tonLoad?: (image?: CropperImage) => void;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n\tcheckOrientation?: boolean;\n\tcanvas?: string | boolean;\n\tunloadTime?: number;\n}\n\nexport function useCropperImage(options: CropperImageHookSettings) {\n\tconst { src, onLoadingStart, onLoadingEnd, onError, onLoad, crossOrigin, checkOrientation, canvas } = options;\n\tconst [loading, setLoading] = useState(false);\n\tconst [loaded, setLoaded] = useState(false);\n\tconst [image, setImage] = useState<CropperImage | null>(null);\n\n\tconst currentSrc = useRef<string | null>(null);\n\n\tuseEffect(() => {\n\t\tif (currentSrc.current !== src) {\n\t\t\tcurrentSrc.current = src || null;\n\t\t\tsetLoaded(false);\n\t\t\tif (src) {\n\t\t\t\tsetLoading(true);\n\t\t\t\tonLoadingStart?.();\n\t\t\t\tconst promises: Promise<unknown>[] = [\n\t\t\t\t\tloadImage(src, {\n\t\t\t\t\t\tcrossOrigin: isUndefined(crossOrigin) ? canvas : crossOrigin,\n\t\t\t\t\t\tcheckOrientation,\n\t\t\t\t\t}),\n\t\t\t\t];\n\n\t\t\t\tif (loaded && options.unloadTime) {\n\t\t\t\t\tpromises.push(promiseTimeout(options.unloadTime));\n\t\t\t\t}\n\t\t\t\tPromise.all(promises)\n\t\t\t\t\t.then((responses) => {\n\t\t\t\t\t\tconst [image] = responses as [CropperImage];\n\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\tsetImage(image);\n\t\t\t\t\t\t\tonLoad?.(image);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\tonError?.();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\tonLoadingEnd?.();\n\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (options.unloadTime) {\n\t\t\t\t\tpromiseTimeout(options.unloadTime).then(() => {\n\t\t\t\t\t\tsetImage(null)\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tsetImage(null)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [src]);\n\n\tuseEffect(() => {\n\t\tif (image) {\n\t\t\tsetLoaded(true)\n\t\t}\n\t}, [image])\n\n\treturn { loading, loaded, image, setImage };\n}\n","import { createDefaultSettings, DefaultSettings } from 'advanced-cropper/defaults';\nimport { CoreSettings, ImageRestriction, ModifierSettings } from 'advanced-cropper';\nimport { useLayoutEffect, useRef } from 'react';\nimport { CropperInstance, AbstractCropperParameters, AbstractCropperCallbacks } from 'advanced-cropper/instance';\nimport { useForceRerender } from './useForceRerender';\nimport { useCropperProps } from './useCropperProps';\n\nexport type CropperStateSettings = DefaultSettings & CoreSettings & ModifierSettings;\n\nexport type CropperStateSettingsProp<Settings extends CropperStateSettings> = Partial<\n\tPick<Settings, keyof CropperStateSettings>\n> &\n\tOmit<Settings, keyof CropperStateSettings>;\n\nexport function useCropperState<Settings extends CropperStateSettings, Instance = unknown>(\n\tprops: () => AbstractCropperParameters<Settings> &\n\t\tAbstractCropperCallbacks<Instance> & {\n\t\t\tsettings: CropperStateSettingsProp<Settings>;\n\t\t},\n\tsettings: {\n\t\tautoReconcileState?: boolean;\n\t},\n) {\n\tconst rerender = useForceRerender();\n\n\tconst getProps = useCropperProps(() => {\n\t\tconst { settings, ...parameters } = props();\n\n\t\tconst extendedSettings = {\n\t\t\timageRestriction: ImageRestriction.fitArea,\n\t\t\ttransformImage: {\n\t\t\t\tadjustStencil: true,\n\t\t\t},\n\t\t\t...settings,\n\t\t};\n\n\t\tconst extendedParameters = {\n\t\t\ttransitions: true,\n\t\t\t...parameters,\n\t\t};\n\n\t\treturn {\n\t\t\tsettings: {\n\t\t\t\t...extendedSettings,\n\t\t\t\t...createDefaultSettings<Settings>(extendedSettings),\n\t\t\t\t// It's needed because of nature of settings field\n\t\t\t} as Settings,\n\t\t\t...extendedParameters,\n\t\t};\n\t});\n\n\tconst cropper = useRef(\n\t\tnew CropperInstance<Settings, Instance>({\n\t\t\tgetProps,\n\t\t\tsetData() {\n\t\t\t\trerender();\n\t\t\t},\n\t\t}),\n\t);\n\n\tuseLayoutEffect(() => {\n\t\tif (settings.autoReconcileState && !cropper.current.hasInteractions()) {\n\t\t\tcropper.current.reconcileState();\n\t\t}\n\t});\n\n\treturn cropper.current;\n}\nexport type CropperStateHook = ReturnType<typeof useCropperState>;\n","import { useState } from 'react';\n\nexport function useForceRerender() {\n\tconst [tick, setTick] = useState({});\n\n\treturn () => {\n\t\tsetTick({});\n\t};\n}\n","import { useRef } from 'react';\n\nexport function useCropperProps<Props>(props: () => Props) {\n\tconst propsRef = useRef(props);\n\n\tpropsRef.current = props;\n\n\treturn () => propsRef.current();\n}\n","import { MutableRefObject, LegacyRef, RefCallback } from 'react';\n\nexport function mergeRefs<T = any>(refs: (MutableRefObject<T> | LegacyRef<T>)[]): RefCallback<T> {\n\treturn (value) => {\n\t\trefs.forEach((ref) => {\n\t\t\tif (typeof ref === 'function') {\n\t\t\t\tref(value);\n\t\t\t} else if (ref != null) {\n\t\t\t\t(ref as MutableRefObject<T | null>).current = value;\n\t\t\t}\n\t\t});\n\t};\n}\n","import { useEffect } from 'react';\nimport { useFirstMountState } from './useFirstMountState';\n\nexport const useUpdateEffect: typeof useEffect = (effect, deps) => {\n\tconst isFirstMount = useFirstMountState();\n\n\tuseEffect(() => {\n\t\tif (!isFirstMount) {\n\t\t\treturn effect();\n\t\t}\n\t}, deps);\n};\n","import { useRef } from 'react';\n\nexport function useFirstMountState(): boolean {\n\tconst isFirst = useRef(true);\n\n\tif (isFirst.current) {\n\t\tisFirst.current = false;\n\n\t\treturn true;\n\t}\n\n\treturn isFirst.current;\n}\n","import React, { ReactNode, forwardRef, useImperativeHandle, useRef, CSSProperties } from 'react';\nimport cn from 'classnames';\nimport {\n\tBoundarySizeAlgorithm,\n\tSize,\n\tstretchCropperBoundary,\n\tBoundaryStretchAlgorithm,\n\tfillBoundary,\n} from 'advanced-cropper';\n\ninterface Props {\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tstretcherClassName?: string;\n\tcontentClassName?: string;\n\tstretchAlgorithm?: BoundaryStretchAlgorithm;\n\tsizeAlgorithm?: BoundarySizeAlgorithm;\n\tchildren?: ReactNode;\n}\n\nexport interface StretchableBoundaryMethods {\n\tstretchTo: (size: Size | null) => Promise<Size | null>;\n\treset: () => void;\n}\n\nexport const StretchableBoundary = forwardRef(\n\t(\n\t\t{\n\t\t\tclassName,\n\t\t\tstyle,\n\t\t\tstretcherClassName,\n\t\t\tcontentClassName,\n\t\t\tstretchAlgorithm = stretchCropperBoundary,\n\t\t\tsizeAlgorithm = fillBoundary,\n\t\t\tchildren,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst stretcherRef = useRef<HTMLDivElement>(null);\n\t\tconst boundaryRef = useRef<HTMLDivElement>(null);\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\treset: () => {\n\t\t\t\tconst stretcher = stretcherRef.current;\n\t\t\t\tif (stretcher) {\n\t\t\t\t\tstretcher.style.height = '';\n\t\t\t\t\tstretcher.style.width = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tstretchTo: (size: Size | null) => {\n\t\t\t\tconst stretcher = stretcherRef.current;\n\t\t\t\tconst boundary = boundaryRef.current;\n\n\t\t\t\tif (size?.width && size?.height && stretcher && boundary) {\n\t\t\t\t\tstretchAlgorithm(boundary, stretcher, size);\n\t\t\t\t\tconst result = sizeAlgorithm(boundary, size);\n\t\t\t\t\treturn Promise.resolve(result.width && result.height ? result : null);\n\t\t\t\t} else {\n\t\t\t\t\tif (stretcher) {\n\t\t\t\t\t\tstretcher.style.height = '';\n\t\t\t\t\t\tstretcher.style.width = '';\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t},\n\t\t}));\n\n\t\treturn (\n\t\t\t<div ref={boundaryRef} style={style} className={cn('advanced-cropper-boundary', className)}>\n\t\t\t\t<div ref={stretcherRef} className={cn(['advanced-cropper-boundary__stretcher', stretcherClassName])} />\n\t\t\t\t<div className={cn(['advanced-cropper-boundary__content', contentClassName])}>{children}</div>\n\t\t\t</div>\n\t\t);\n\t},\n);\n\nStretchableBoundary.displayName = 'StretchableBoundary';\n","import React, { CSSProperties, FC } from 'react';\nimport cn from 'classnames';\n\ninterface Props {\n\tvisible?: unknown;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n}\n\nexport const CropperFade: FC<Props> = ({ visible, className, style, children }) => {\n\treturn (\n\t\t<div\n\t\t\tstyle={style}\n\t\t\tclassName={cn(className, 'advanced-cropper-fade', Boolean(visible) && 'advanced-cropper-fade--visible')}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n","import React, { CSSProperties, FC } from 'react';\nimport cn from 'classnames';\nimport { CropperState } from 'advanced-cropper';\nimport { CropperFade } from './CropperFade';\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n}\n\nexport interface CropperWrapperProps {\n\tcropper?: DesiredCropperRef;\n\tloading?: boolean;\n\tloaded?: boolean;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n}\n\nexport const CropperWrapper: FC<CropperWrapperProps> = ({ cropper, children, loaded, className, style }) => {\n\tconst state = cropper ? cropper.getState() : null;\n\treturn (\n\t\t<div className={cn(className, 'advanced-cropper-wrapper')} style={style}>\n\t\t\t<CropperFade visible={state && loaded} className={'advanced-cropper-wrapper__fade'}>\n\t\t\t\t{children}\n\t\t\t</CropperFade>\n\t\t</div>\n\t);\n};\n","import { MouseEvent } from 'react';\n\nexport function preventDefault(e: MouseEvent) {\n\te.preventDefault();\n}\n","import React, { forwardRef } from 'react';\nimport cn from 'classnames';\nimport { CropperTransitions, CropperImage, CropperState, getBackgroundStyle } from 'advanced-cropper';\nimport { preventDefault } from '../../service/events';\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState;\n\tgetTransitions: () => CropperTransitions;\n\tgetImage: () => CropperImage;\n}\n\ninterface Props {\n\tclassName?: string;\n\tcropper: DesiredCropperRef;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n}\n\nexport const CropperBackgroundImage = forwardRef<HTMLImageElement, Props>(\n\t({ className, cropper, crossOrigin }: Props, ref) => {\n\t\tconst state = cropper.getState();\n\t\tconst transitions = cropper.getTransitions();\n\t\tconst image = cropper.getImage();\n\n\t\tconst style = image && state ? getBackgroundStyle(image, state, transitions) : {};\n\n\t\tconst src = image ? image.src : undefined;\n\n\t\treturn src ? (\n\t\t\t<img\n\t\t\t\tkey={src}\n\t\t\t\tref={ref}\n\t\t\t\tclassName={cn('advanced-cropper-background-image', className)}\n\t\t\t\tsrc={src}\n\t\t\t\tcrossOrigin={crossOrigin === true ? 'anonymous' : crossOrigin || undefined}\n\t\t\t\tstyle={style}\n\t\t\t\tonMouseDown={preventDefault}\n\t\t\t/>\n\t\t) : null;\n\t},\n);\n\nCropperBackgroundImage.displayName = 'CropperBackgroundImage';\n","import React, { forwardRef, useImperativeHandle, useRef } from 'react';\nimport { CropperState, DrawOptions, drawCroppedArea } from 'advanced-cropper';\n\nexport interface CropperCanvasMethods {\n\tdraw: (\n\t\tstate: CropperState,\n\t\timage: HTMLImageElement | HTMLCanvasElement,\n\t\toptions?: DrawOptions,\n\t) => HTMLCanvasElement | null;\n}\n\nexport const CropperCanvas = forwardRef((_, ref) => {\n\tconst canvasRef = useRef<HTMLCanvasElement>(null);\n\tconst spareCanvasRef = useRef<HTMLCanvasElement>(null);\n\n\tuseImperativeHandle(ref, () => ({\n\t\tdraw: (state: CropperState, image: HTMLImageElement | HTMLCanvasElement, options: DrawOptions = {}) => {\n\t\t\tif (image && canvasRef.current && spareCanvasRef.current) {\n\t\t\t\treturn drawCroppedArea(state, image, canvasRef.current, spareCanvasRef.current, options);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t}));\n\n\treturn (\n\t\t<>\n\t\t\t<canvas className=\"advanced-cropper-canvas\" ref={canvasRef} />\n\t\t\t<canvas className=\"advanced-cropper-canvas\" ref={spareCanvasRef} />\n\t\t</>\n\t);\n});\n\nCropperCanvas.displayName = 'CropperCanvas';\n","import React, { ReactNode, Component, RefObject, createRef } from 'react';\nimport cn from 'classnames';\nimport { MoveDirections, Point, SimpleTouch, distance } from 'advanced-cropper';\n\ninterface Props {\n\tclassName?: string;\n\tchildren?: ReactNode;\n\tdisabled?: boolean;\n\tonMove?: (directions: MoveDirections, nativeEvent: MouseEvent | TouchEvent) => void;\n\tonMoveEnd?: () => void;\n\tonMoveStart?: () => void;\n\tonLeave?: () => void;\n\tonEnter?: () => void;\n\tuseAnchor?: boolean;\n\tactivationDistance?: number;\n\trerender?: boolean;\n}\n\nexport class DraggableElement extends Component<Props> {\n\ttouches: SimpleTouch[];\n\tstarted: boolean;\n\thovered: boolean;\n\tanchor: Point;\n\tcontainer: RefObject<HTMLDivElement>;\n\n\tstatic defaultProps = {\n\t\tdisabled: false,\n\t\tactivationDistance: 30,\n\t\tuseAnchor: true,\n\t\trerender: true,\n\t};\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\n\t\tthis.touches = [];\n\t\tthis.hovered = false;\n\t\tthis.started = false;\n\t\tthis.anchor = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t};\n\t\tthis.container = createRef();\n\t}\n\n\tprocessMove = (e: MouseEvent | TouchEvent, newTouches: SimpleTouch[]) => {\n\t\tconst container = this.container.current;\n\n\t\tif (container && this.touches.length) {\n\t\t\tconst { left, top } = container.getBoundingClientRect();\n\t\t\tif (this.touches.length === 1 && newTouches.length === 1) {\n\t\t\t\tif (this.props.onMove) {\n\t\t\t\t\tconst movingToAnchor = {\n\t\t\t\t\t\tleft:\n\t\t\t\t\t\t\tMath.abs(newTouches[0].clientX - this.anchor.left - left) <\n\t\t\t\t\t\t\tMath.abs(this.touches[0].clientX - this.anchor.left - left),\n\t\t\t\t\t\ttop:\n\t\t\t\t\t\t\tMath.abs(newTouches[0].clientY - this.anchor.top - top) <\n\t\t\t\t\t\t\tMath.abs(this.touches[0].clientY - this.anchor.top - top),\n\t\t\t\t\t};\n\n\t\t\t\t\tconst direction = {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (!this.props.useAnchor || !movingToAnchor.left) {\n\t\t\t\t\t\tdirection.left = newTouches[0].clientX - this.touches[0].clientX;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.props.useAnchor || !movingToAnchor.top) {\n\t\t\t\t\t\tdirection.top = newTouches[0].clientY - this.touches[0].clientY;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.props?.onMove(direction, e);\n\n\t\t\t\t\tthis.touches = [...newTouches];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tprocessEnd = () => {\n\t\tconst { onMoveEnd, onLeave } = this.props;\n\t\tif (!this.props.disabled && this.touches.length) {\n\t\t\tonMoveEnd?.();\n\t\t}\n\t\tif (this.hovered) {\n\t\t\tonLeave?.();\n\t\t\tthis.hovered = false;\n\t\t}\n\t\tthis.touches = [];\n\t};\n\n\tinitAnchor = (touch: SimpleTouch) => {\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\tconst { left, top } = container.getBoundingClientRect();\n\t\t\tthis.anchor = {\n\t\t\t\tleft: touch.clientX - left,\n\t\t\t\ttop: touch.clientY - top,\n\t\t\t};\n\t\t}\n\t};\n\n\tonMouseOver = () => {\n\t\tconst { onEnter, disabled } = this.props;\n\t\tif (!this.hovered && !disabled) {\n\t\t\tthis.hovered = true;\n\t\t\tonEnter?.();\n\t\t}\n\t};\n\n\tonMouseLeave = () => {\n\t\tconst { onLeave } = this.props;\n\t\tif (this.hovered && !this.touches.length) {\n\t\t\tthis.hovered = false;\n\t\t\tonLeave?.();\n\t\t}\n\t};\n\n\tonTouchStart = (e: TouchEvent) => {\n\t\tconst { onEnter, onMoveStart, disabled } = this.props;\n\t\tif (e.cancelable) {\n\t\t\tthis.touches = Array.from(e.touches);\n\n\t\t\tconst shouldStartMove = !disabled && e.touches.length === 1;\n\t\t\tif (shouldStartMove) {\n\t\t\t\tthis.touches = Array.from(e.touches);\n\t\t\t\tonMoveStart?.();\n\t\t\t}\n\n\t\t\tif (!this.hovered && !disabled) {\n\t\t\t\tthis.hovered = true;\n\t\t\t\tonEnter?.();\n\t\t\t}\n\n\t\t\tif (this.started || shouldStartMove) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}\n\t};\n\n\tonTouchEnd = () => {\n\t\tthis.started = false;\n\t\tthis.processEnd();\n\t};\n\n\tonTouchMove = (e: TouchEvent) => {\n\t\tif (this.touches.length >= 1) {\n\t\t\tif (this.started) {\n\t\t\t\tthis.processMove(e, Array.from(e.touches));\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t} else if (\n\t\t\t\tdistance(\n\t\t\t\t\t{ left: this.touches[0].clientX, top: this.touches[0].clientY },\n\t\t\t\t\t{ left: e.touches[0].clientX, top: e.touches[0].clientY },\n\t\t\t\t) > (this.props.activationDistance || 0)\n\t\t\t) {\n\t\t\t\tthis.initAnchor({\n\t\t\t\t\tclientX: e.touches[0].clientX,\n\t\t\t\t\tclientY: e.touches[0].clientY,\n\t\t\t\t});\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseDown = (e: MouseEvent) => {\n\t\tconst { onMoveStart, disabled } = this.props;\n\t\tif (!disabled && e.button === 0) {\n\t\t\tconst touch = {\n\t\t\t\tclientX: e.clientX,\n\t\t\t\tclientY: e.clientY,\n\t\t\t};\n\t\t\tthis.touches = [touch];\n\t\t\tthis.initAnchor(touch);\n\t\t\te.stopPropagation();\n\t\t\tonMoveStart?.();\n\t\t}\n\t};\n\n\tonMouseMove = (e: MouseEvent) => {\n\t\tif (!this.props.disabled && this.touches.length) {\n\t\t\tthis.processMove(e, [\n\t\t\t\t{\n\t\t\t\t\tclientX: e.clientX,\n\t\t\t\t\tclientY: e.clientY,\n\t\t\t\t},\n\t\t\t]);\n\t\t\tif (e.preventDefault && e.cancelable) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t}\n\t};\n\n\tonMouseUp = () => {\n\t\tthis.processEnd();\n\t};\n\n\tshouldComponentUpdate() {\n\t\treturn !!this.props.rerender;\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\tcontainer.removeEventListener('touchstart', this.onTouchStart);\n\t\t\tcontainer.removeEventListener('mousedown', this.onMouseDown);\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false });\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false });\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false });\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false });\n\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\t// Add event listeners here due to https://github.com/facebook/react/issues/9809#issuecomment-414072263\n\t\t\tcontainer.addEventListener('touchstart', this.onTouchStart, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t\tcontainer.addEventListener('mousedown', this.onMouseDown, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t}\n\t}\n\n\tcomponentDidUpdate(prevProps: Readonly<Props>) {\n\t\tif (this.props.disabled && !prevProps.disabled) {\n\t\t\tthis.touches = [];\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { children, className } = this.props;\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={cn('advanced-cropper-draggable-element', className)}\n\t\t\t\tref={this.container}\n\t\t\t\tonMouseOver={this.onMouseOver}\n\t\t\t\tonMouseLeave={this.onMouseLeave}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React, { ReactNode } from 'react';\nimport cn from 'classnames';\nimport { HorizontalCardinalDirection, MoveDirections, VerticalCardinalDirection } from 'advanced-cropper';\nimport { DraggableElement } from './DraggableElement';\n\ninterface Props {\n\tclassName?: string;\n\tchildren?: ReactNode;\n\tonDrag?: (directions: MoveDirections, event: TouchEvent | MouseEvent) => void;\n\tonDragEnd?: () => void;\n\tonLeave?: () => void;\n\tonEnter?: () => void;\n\tdisabled?: boolean;\n\tposition?: HorizontalCardinalDirection | VerticalCardinalDirection;\n}\n\nexport const LineWrapper = ({\n\tposition,\n\tclassName,\n\tdisabled,\n\tonDrag,\n\tonDragEnd,\n\tonLeave,\n\tonEnter,\n\tchildren,\n}: Props) => {\n\treturn (\n\t\t<DraggableElement\n\t\t\tclassName={cn([\n\t\t\t\t'advanced-cropper-line-wrapper',\n\t\t\t\tposition && `advanced-cropper-line-wrapper--${position}`,\n\t\t\t\tclassName,\n\t\t\t])}\n\t\t\tdisabled={disabled}\n\t\t\tonMove={onDrag}\n\t\t\tonMoveEnd={onDragEnd}\n\t\t\tonLeave={onLeave}\n\t\t\tonEnter={onEnter}\n\t\t\tactivationDistance={0}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={cn([\n\t\t\t\t\t'advanced-cropper-line-wrapper__content',\n\t\t\t\t\tposition && `advanced-cropper-line-wrapper__content--${position}`,\n\t\t\t\t])}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t</DraggableElement>\n\t);\n};\n","import React, { useState } from 'react';\nimport cn from 'classnames';\nimport { CardinalDirection, MoveDirections } from 'advanced-cropper';\nimport { LineWrapper } from '../service/LineWrapper';\n\ninterface Props {\n\tdefaultClassName?: string;\n\thoverClassName?: string;\n\twrapperClassName?: string;\n\tposition?: CardinalDirection;\n\tdisabled?: boolean;\n\tonDrag?: (directions: MoveDirections, event: TouchEvent | MouseEvent) => void;\n\tonDragEnd?: () => void;\n}\n\nexport const SimpleLine = ({\n\tposition,\n\thoverClassName,\n\twrapperClassName,\n\tdefaultClassName,\n\tdisabled,\n\tonDrag,\n\tonDragEnd,\n}: Props) => {\n\tconst [hover, setHover] = useState(false);\n\n\tconst onEnter = () => {\n\t\tsetHover(true);\n\t};\n\n\tconst onLeave = () => {\n\t\tsetHover(false);\n\t};\n\n\treturn (\n\t\t<LineWrapper\n\t\t\tclassName={cn('advanced-cropper-simple-line-wrapper', wrapperClassName, {\n\t\t\t\t[`advanced-cropper-simple-line-wrapper--${position}`]: !!position,\n\t\t\t})}\n\t\t\tposition={position}\n\t\t\tdisabled={disabled}\n\t\t\tonDrag={onDrag}\n\t\t\tonDragEnd={onDragEnd}\n\t\t\tonLeave={onLeave}\n\t\t\tonEnter={onEnter}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'advanced-cropper-simple-line',\n\t\t\t\t\thover && 'advanced-cropper-simple-line--hover',\n\t\t\t\t\tdefaultClassName,\n\t\t\t\t\thover && hoverClassName,\n\t\t\t\t\t{\n\t\t\t\t\t\t[`advanced-cropper-simple-line--${position}`]: !!position,\n\t\t\t\t\t},\n\t\t\t\t)}\n\t\t\t/>\n\t\t</LineWrapper>\n\t);\n};\n","import React, { CSSProperties, ReactNode } from 'react';\nimport classnames from 'classnames';\nimport {\n\tHorizontalCardinalDirection,\n\tMoveDirections,\n\tVerticalCardinalDirection,\n\tgetDirectionNames,\n} from 'advanced-cropper';\nimport { DraggableElement } from './DraggableElement';\n\ninterface Props {\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tchildren?: ReactNode;\n\tonDrag?: (shift: MoveDirections, event: MouseEvent | TouchEvent) => void;\n\tonDragEnd?: () => void;\n\tonLeave?: () => void;\n\tonEnter?: () => void;\n\tdisabled?: boolean;\n\thorizontalPosition?: HorizontalCardinalDirection;\n\tverticalPosition?: VerticalCardinalDirection;\n}\n\nexport const HandlerWrapper = ({\n\thorizontalPosition,\n\tverticalPosition,\n\tclassName,\n\tdisabled,\n\tonDrag,\n\tonDragEnd,\n\tonLeave,\n\tonEnter,\n\tchildren,\n\tstyle,\n}: Props) => {\n\tconst position =\n\t\thorizontalPosition || verticalPosition\n\t\t\t? getDirectionNames(horizontalPosition, verticalPosition).snakeCase\n\t\t\t: null;\n\n\treturn (\n\t\t<div\n\t\t\tstyle={style}\n\t\t\tclassName={classnames(\n\t\t\t\tclassName,\n\t\t\t\t'advanced-cropper-handler-wrapper',\n\t\t\t\tposition && `advanced-cropper-handler-wrapper--${position}`,\n\t\t\t\tdisabled && 'advanced-cropper-handler-wrapper--disabled',\n\t\t\t)}\n\t\t>\n\t\t\t<DraggableElement\n\t\t\t\tclassName={'advanced-cropper-handler-wrapper__draggable'}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tonMove={onDrag}\n\t\t\t\tonMoveEnd={onDragEnd}\n\t\t\t\tonLeave={onLeave}\n\t\t\t\tonEnter={onEnter}\n\t\t\t\tactivationDistance={0}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</DraggableElement>\n\t\t</div>\n\t);\n};\n","import React, { CSSProperties, useState } from 'react';\nimport cn from 'classnames';\nimport { HorizontalCardinalDirection, MoveDirections, VerticalCardinalDirection } from 'advanced-cropper';\nimport { HandlerWrapper } from '../service/HandlerWrapper';\n\ninterface Props {\n\tdefaultClassName?: string;\n\thoverClassName?: string;\n\twrapperClassName?: string;\n\twrapperStyle?: CSSProperties;\n\tverticalPosition?: VerticalCardinalDirection;\n\thorizontalPosition?: HorizontalCardinalDirection;\n\tdisabled?: boolean;\n\tonDrag?: (shift: MoveDirections, event: TouchEvent | MouseEvent) => void;\n\tonDragEnd?: () => void;\n}\n\nexport const SimpleHandler = ({\n\tverticalPosition,\n\thorizontalPosition,\n\thoverClassName,\n\twrapperClassName,\n\tdefaultClassName,\n\twrapperStyle,\n\tdisabled,\n\tonDrag,\n\tonDragEnd,\n}: Props) => {\n\tconst [hover, setHover] = useState(false);\n\n\tconst onEnter = () => {\n\t\tsetHover(true);\n\t};\n\n\tconst onLeave = () => {\n\t\tsetHover(false);\n\t};\n\n\treturn (\n\t\t<HandlerWrapper\n\t\t\tstyle={wrapperStyle}\n\t\t\tclassName={cn(\n\t\t\t\t'advanced-cropper-simple-handler-wrapper',\n\t\t\t\twrapperClassName,\n\t\t\t\tverticalPosition && `advanced-cropper-simple-handler-wrapper--${verticalPosition}`,\n\t\t\t\thorizontalPosition && `advanced-cropper-simple-handler-wrapper--${horizontalPosition}`,\n\t\t\t\thorizontalPosition &&\n\t\t\t\t\tverticalPosition &&\n\t\t\t\t\t`advanced-cropper-simple-handler-wrapper--${horizontalPosition}-${verticalPosition}`,\n\t\t\t\thover && 'advanced-cropper-simple-handler-wrapper--hover',\n\t\t\t)}\n\t\t\tverticalPosition={verticalPosition}\n\t\t\thorizontalPosition={horizontalPosition}\n\t\t\tdisabled={disabled}\n\t\t\tonDrag={onDrag}\n\t\t\tonDragEnd={onDragEnd}\n\t\t\tonLeave={onLeave}\n\t\t\tonEnter={onEnter}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'advanced-cropper-simple-handler',\n\t\t\t\t\thover && 'advanced-cropper-simple-handler--hover',\n\t\t\t\t\tdefaultClassName,\n\t\t\t\t\thover && hoverClassName,\n\t\t\t\t\t{\n\t\t\t\t\t\t[`advanced-cropper-simple-handler--${verticalPosition}`]: !!verticalPosition,\n\t\t\t\t\t\t[`advanced-cropper-simple-handler--${horizontalPosition}`]: !!horizontalPosition,\n\t\t\t\t\t\t[`advanced-cropper-simple-handler--${horizontalPosition}-${verticalPosition}`]:\n\t\t\t\t\t\t\thorizontalPosition && verticalPosition,\n\t\t\t\t\t},\n\t\t\t\t)}\n\t\t\t/>\n\t\t</HandlerWrapper>\n\t);\n};\n","import React, { ComponentType, useMemo, ReactNode, CSSProperties } from 'react';\nimport classnames from 'classnames';\nimport cn from 'classnames';\nimport {\n\tCardinalDirection,\n\tOrdinalDirection,\n\tHorizontalCardinalDirection,\n\tVerticalCardinalDirection,\n\tResizeDirections,\n\tMoveDirections,\n\tResizeOptions,\n\tgetDirectionNames,\n\tisCardinalDirection,\n\tisObject,\n} from 'advanced-cropper';\nimport { SimpleLine } from '../lines/SimpleLine';\nimport { SimpleHandler } from '../handlers/SimpleHandler';\n\nconst HORIZONTAL_DIRECTIONS = ['east', 'west', null] as const;\nconst VERTICAL_DIRECTIONS = ['south', 'north', null] as const;\n\ntype HandlerComponent = ComponentType<any>;\n\ntype LineComponent = ComponentType<any>;\n\ninterface HandlerClassNames extends Partial<Record<OrdinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface LineClassNames extends Partial<Record<CardinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface Props {\n\tstyle?: CSSProperties;\n\tclassName?: string;\n\thandlerComponent?: HandlerComponent;\n\thandlers?: boolean | Partial<Record<OrdinalDirection, boolean>>;\n\thandlerClassNames?: HandlerClassNames;\n\thandlerWrapperClassNames?: HandlerClassNames;\n\tlines?: boolean | Partial<Record<CardinalDirection, boolean>>;\n\tlineComponent?: LineComponent;\n\tlineClassNames?: LineClassNames;\n\tlineWrapperClassNames?: LineClassNames;\n\tdisabled?: boolean;\n\tonResize?: (directions: ResizeDirections, options: ResizeOptions) => void;\n\tonResizeEnd?: () => void;\n\tchildren?: ReactNode;\n}\n\ninterface HandlerNode {\n\tname: OrdinalDirection;\n\tcomponent: HandlerComponent;\n\tclassName: string;\n\twrapperClassName?: string;\n\tcontainerClassName?: string;\n\thoverClassName?: string;\n\tstyle?: CSSProperties;\n\tverticalPosition: VerticalCardinalDirection | null;\n\thorizontalPosition: HorizontalCardinalDirection | null;\n\tdisabled: boolean;\n}\n\ninterface LineNode {\n\tname: CardinalDirection;\n\tcomponent: HandlerComponent;\n\tclassName: string;\n\twrapperClassName?: string;\n\thoverClassName?: string;\n\tstyle?: CSSProperties;\n\tverticalPosition: VerticalCardinalDirection | null;\n\thorizontalPosition: HorizontalCardinalDirection | null;\n\tdisabled: boolean;\n}\n\ninterface PointNode {\n\tname: OrdinalDirection;\n\tclassName: string;\n\tverticalPosition: VerticalCardinalDirection | null;\n\thorizontalPosition: HorizontalCardinalDirection | null;\n}\n\nexport const BoundingBox = ({\n\tstyle,\n\tclassName,\n\tchildren,\n\tonResize,\n\tonResizeEnd,\n\thandlerComponent = SimpleHandler,\n\thandlers = {\n\t\teastNorth: true,\n\t\tnorth: true,\n\t\twestNorth: true,\n\t\twest: true,\n\t\twestSouth: true,\n\t\tsouth: true,\n\t\teastSouth: true,\n\t\teast: true,\n\t},\n\thandlerClassNames = {},\n\thandlerWrapperClassNames = {},\n\tlines = {\n\t\twest: true,\n\t\tnorth: true,\n\t\teast: true,\n\t\tsouth: true,\n\t},\n\tlineComponent = SimpleLine,\n\tlineClassNames = {},\n\tlineWrapperClassNames = {},\n\tdisabled = false,\n}: Props) => {\n\tconst points = useMemo(() => {\n\t\tconst result: PointNode[] = [];\n\t\tHORIZONTAL_DIRECTIONS.forEach((hDirection) => {\n\t\t\tVERTICAL_DIRECTIONS.forEach((vDirection) => {\n\t\t\t\tif (hDirection !== vDirection) {\n\t\t\t\t\tlet { snakeCase, camelCase } = getDirectionNames(hDirection, vDirection);\n\t\t\t\t\tif (snakeCase && camelCase) {\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tname: camelCase,\n\t\t\t\t\t\t\tclassName: snakeCase,\n\t\t\t\t\t\t\tverticalPosition: vDirection,\n\t\t\t\t\t\t\thorizontalPosition: hDirection,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn result;\n\t}, []);\n\n\tconst lineNodes = useMemo(() => {\n\t\tconst result: LineNode[] = [];\n\t\tpoints.forEach((point) => {\n\t\t\tif (isCardinalDirection(point.name) && (isObject(lines) ? lines[point.name] : lines)) {\n\t\t\t\tresult.push({\n\t\t\t\t\tname: point.name,\n\t\t\t\t\tcomponent: lineComponent,\n\t\t\t\t\tclassName: classnames(\n\t\t\t\t\t\tlineClassNames.default,\n\t\t\t\t\t\tlineClassNames[point.name],\n\t\t\t\t\t\tdisabled && lineClassNames.disabled,\n\t\t\t\t\t),\n\t\t\t\t\twrapperClassName: classnames(\n\t\t\t\t\t\t`advanced-cropper-bounding-box__line`,\n\t\t\t\t\t\t`advanced-cropper-bounding-box__line--${point.name}`,\n\t\t\t\t\t\tlineWrapperClassNames.default,\n\t\t\t\t\t\tlineWrapperClassNames[point.name],\n\t\t\t\t\t\tdisabled && lineWrapperClassNames.disabled,\n\t\t\t\t\t),\n\t\t\t\t\thoverClassName: lineClassNames.hover,\n\t\t\t\t\tverticalPosition: point.verticalPosition,\n\t\t\t\t\thorizontalPosition: point.horizontalPosition,\n\t\t\t\t\tdisabled,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}, [points, lines, lineComponent, lineClassNames, lineWrapperClassNames, disabled]);\n\n\tconst handlerNodes = useMemo(() => {\n\t\tconst result: HandlerNode[] = [];\n\t\tpoints.forEach((point) => {\n\t\t\tif (isObject(handlers) ? handlers[point.name] : handlers) {\n\t\t\t\tresult.push({\n\t\t\t\t\tname: point.name,\n\t\t\t\t\tcomponent: handlerComponent,\n\t\t\t\t\tclassName: classnames(handlerClassNames.default, handlerClassNames[point.name]),\n\t\t\t\t\tcontainerClassName: classnames(\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler-wrapper`,\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler-wrapper--${point.className}`,\n\t\t\t\t\t),\n\t\t\t\t\twrapperClassName: classnames(\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler`,\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler--${point.className}`,\n\t\t\t\t\t\thandlerWrapperClassNames.default,\n\t\t\t\t\t\thandlerWrapperClassNames[point.name],\n\t\t\t\t\t),\n\t\t\t\t\thoverClassName: handlerClassNames.hover,\n\t\t\t\t\tverticalPosition: point.verticalPosition,\n\t\t\t\t\thorizontalPosition: point.horizontalPosition,\n\t\t\t\t\tdisabled,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}, [points, handlers, handlerComponent, handlerClassNames, handlerWrapperClassNames, disabled]);\n\n\tconst onHandlerDrag =\n\t\t(\n\t\t\thorizontalDirection: HorizontalCardinalDirection | null,\n\t\t\tverticalDirection: VerticalCardinalDirection | null,\n\t\t) =>\n\t\t({ left, top }: MoveDirections, nativeEvent: MouseEvent | TouchEvent) => {\n\t\t\tconst directions = {\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tbottom: 0,\n\t\t\t};\n\n\t\t\tif (horizontalDirection === 'west') {\n\t\t\t\tdirections.left -= left;\n\t\t\t} else if (horizontalDirection === 'east') {\n\t\t\t\tdirections.right += left;\n\t\t\t}\n\t\t\tif (verticalDirection === 'north') {\n\t\t\t\tdirections.top -= top;\n\t\t\t} else if (verticalDirection === 'south') {\n\t\t\t\tdirections.bottom += top;\n\t\t\t}\n\n\t\t\tlet respectDirection: 'width' | 'height' | undefined;\n\t\t\tif (!verticalDirection && horizontalDirection) {\n\t\t\t\trespectDirection = 'width';\n\t\t\t} else if (verticalDirection && !horizontalDirection) {\n\t\t\t\trespectDirection = 'height';\n\t\t\t}\n\n\t\t\tif (!disabled) {\n\t\t\t\tif (onResize) {\n\t\t\t\t\tonResize(directions, {\n\t\t\t\t\t\tallowedDirections: {\n\t\t\t\t\t\t\tleft: horizontalDirection === 'west' || !horizontalDirection,\n\t\t\t\t\t\t\tright: horizontalDirection === 'east' || !horizontalDirection,\n\t\t\t\t\t\t\tbottom: verticalDirection === 'south' || !verticalDirection,\n\t\t\t\t\t\t\ttop: verticalDirection === 'north' || !verticalDirection,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpreserveAspectRatio: nativeEvent && nativeEvent.shiftKey,\n\t\t\t\t\t\trespectDirection,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\treturn (\n\t\t<div className={cn('advanced-cropper-bounding-box', className)} style={style}>\n\t\t\t{children}\n\t\t\t<div>\n\t\t\t\t{lineNodes.map((line) => (\n\t\t\t\t\t<line.component\n\t\t\t\t\t\tkey={line.name}\n\t\t\t\t\t\tdefaultClassName={line.className}\n\t\t\t\t\t\thoverClassName={line.hoverClassName}\n\t\t\t\t\t\twrapperClassName={line.wrapperClassName}\n\t\t\t\t\t\tposition={line.name}\n\t\t\t\t\t\tdisabled={line.disabled}\n\t\t\t\t\t\tonDrag={onHandlerDrag(line.horizontalPosition, line.verticalPosition)}\n\t\t\t\t\t\tonDragEnd={onResizeEnd}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t{handlerNodes.map((handler) => {\n\t\t\t\t\tconst handlerElement = (\n\t\t\t\t\t\t<handler.component\n\t\t\t\t\t\t\tdefaultClassName={handler.className}\n\t\t\t\t\t\t\thoverClassName={handler.hoverClassName}\n\t\t\t\t\t\t\twrapperClassName={handler.wrapperClassName}\n\t\t\t\t\t\t\thorizontalPosition={handler.horizontalPosition}\n\t\t\t\t\t\t\tverticalPosition={handler.verticalPosition}\n\t\t\t\t\t\t\tdisabled={handler.disabled}\n\t\t\t\t\t\t\tonDrag={onHandlerDrag(handler.horizontalPosition, handler.verticalPosition)}\n\t\t\t\t\t\t\tonDragEnd={onResizeEnd}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={handler.name} className={handler.containerClassName}>\n\t\t\t\t\t\t\t{handlerElement}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","import React, { FC } from 'react';\nimport classnames from 'classnames';\n\ninterface Props {\n\tclassName?: string;\n}\n\nexport const StencilOverlay: FC<Props> = ({ className, children }) => {\n\treturn <div className={classnames('advanced-cropper-stencil-overlay', className)}>{children}</div>;\n};\n","import React, { FC, useLayoutEffect, useRef, useState } from 'react';\nimport { Coordinates, CropperTransitions, deepCompare, isNumber } from 'advanced-cropper';\nimport classnames from 'classnames';\nimport { useTransition } from '../../hooks/useAnimatedState';\n\ninterface Props {\n\tclassName?: string;\n\ttransitions?: CropperTransitions;\n\twidth?: number;\n\theight?: number;\n\tleft?: number;\n\ttop?: number;\n}\n\nexport const ArtificialTransition: FC<Props> = ({ className, transitions, children, ...values }) => {\n\tconst root = useRef<HTMLDivElement>(null);\n\n\tconst transitionValues = useRef<Partial<Coordinates>>(values);\n\n\tconst [rememberedValues, setRememberedValues] = useState(values);\n\n\tconst [runTransitions, transitionsActive] = useTransition(transitions);\n\n\tuseLayoutEffect(() => {\n\t\tif (!deepCompare(rememberedValues, values)) {\n\t\t\tsetRememberedValues(values);\n\n\t\t\tconst startValues = transitionsActive\n\t\t\t\t? {\n\t\t\t\t\t\t...transitionValues.current,\n\t\t\t\t  }\n\t\t\t\t: rememberedValues;\n\n\t\t\trunTransitions((progress) => {\n\t\t\t\tconst properties = ['left', 'top', 'height', 'width'] as const;\n\n\t\t\t\tproperties.forEach((property) => {\n\t\t\t\t\tconst desiredValue = values[property];\n\t\t\t\t\tconst startValue = startValues[property];\n\n\t\t\t\t\ttransitionValues.current[property] =\n\t\t\t\t\t\tisNumber(startValue) && isNumber(desiredValue)\n\t\t\t\t\t\t\t? startValue + (desiredValue - startValue) * progress\n\t\t\t\t\t\t\t: desiredValue;\n\t\t\t\t});\n\n\t\t\t\tif (root.current) {\n\t\t\t\t\troot.current.style.width = `${transitionValues.current.width}px`;\n\t\t\t\t\troot.current.style.height = `${transitionValues.current.height}px`;\n\t\t\t\t\troot.current.style.transform = `translate3d(${transitionValues.current.left}px, ${transitionValues.current.top}px, 0px)`;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [rememberedValues, transitionsActive, values.width, values.height, values.top, values.left]);\n\n\tconst currentValues = transitionsActive ? transitionValues.current : values;\n\n\tconst rootStyle = {\n\t\tleft: 0,\n\t\ttop: 0,\n\t\twidth: `${currentValues.width}px`,\n\t\theight: `${currentValues.height}px`,\n\t\ttransform: `translate3d(${currentValues.left}px, ${currentValues.top}px, 0px)`,\n\t};\n\n\treturn (\n\t\t<div ref={root} className={classnames('advanced-cropper-artificial-transition', className)} style={rootStyle}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n","import { CropperTransitions, Animation } from 'advanced-cropper';\nimport { useRef, useState } from 'react';\n\nexport function useTransition<T>(transitions: CropperTransitions | null = null): [(callback: (progress: number) => void) => void, boolean] {\n\tconst animation = useRef(new Animation());\n\tconst [active, setActive] = useState(false);\n\n\treturn [\n\t\t(callback: (progress: number) => void) => {\n\t\t\tif (transitions && transitions.active) {\n\t\t\t\t\tanimation.current.start({\n\t\t\t\t\t\t...transitions,\n\t\t\t\t\t\tonStart() {\n\t\t\t\t\t\t\tsetActive(true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonProgress(progress) {\n\t\t\t\t\t\t\tcallback(progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonStop() {\n\t\t\t\t\t\t\tsetActive(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n \t\t\t} else if (!animation.current.active) {\n\t\t\t\tcallback(1);\n\t\t\t}\n\t\t},\n\t\tactive,\n\t];\n}\n","import React, { FC } from 'react';\nimport { CropperTransitions } from 'advanced-cropper';\nimport classnames from 'classnames';\n\nimport { ArtificialTransition } from './ArtificialTransition';\n\ninterface Props {\n\tclassName?: string;\n\ttransitions?: CropperTransitions;\n\twidth?: number;\n\theight?: number;\n\tleft: number;\n\ttop: number;\n}\n\nexport const StencilWrapper: FC<Props> = ({ className, transitions, width, height, left, top, children }) => {\n\treturn (\n\t\t<ArtificialTransition\n\t\t\tclassName={classnames('advanced-cropper-stencil-wrapper', className)}\n\t\t\ttransitions={transitions}\n\t\t\twidth={width}\n\t\t\theight={height}\n\t\t\ttop={top}\n\t\t\tleft={left}\n\t\t>\n\t\t\t{children}\n\t\t</ArtificialTransition>\n\t);\n};\n","import React, { FC, ReactNode, useState } from 'react';\nimport cn from 'classnames';\nimport { useUpdateEffect } from '../../hooks/useUpdateEffect';\n\nexport interface StencilGridProps {\n\tvisible?: boolean;\n\tcolumns?: number;\n\trows?: number;\n\tclassName?: string;\n}\n\nexport const StencilGrid: FC<StencilGridProps> = ({ columns = 3, rows = 3, visible = false, className }) => {\n\tconst nodes: ReactNode[] = [];\n\n\tconst [currentColumns, setCurrentColumns] = useState(columns);\n\tconst [currentRows, setCurrentRows] = useState(rows);\n\n\tuseUpdateEffect(() => {\n\t\tif (visible) {\n\t\t\tsetCurrentRows(rows);\n\t\t\tsetCurrentColumns(columns);\n\t\t}\n\t}, [visible, columns, rows]);\n\n\tfor (let i = 0; i < currentRows; i++) {\n\t\tconst cells: ReactNode[] = [];\n\t\tfor (let j = 0; j < currentColumns; j++) {\n\t\t\tcells.push(\n\t\t\t\t<div\n\t\t\t\t\tkey={j}\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t'advanced-cropper-stencil-grid__cell',\n\t\t\t\t\t\ti === 0 && 'advanced-cropper-stencil-grid__cell--top',\n\t\t\t\t\t\ti === currentRows - 1 && 'advanced-cropper-stencil-grid__cell--bottom',\n\t\t\t\t\t\tj === 0 && 'advanced-cropper-stencil-grid__cell--left',\n\t\t\t\t\t\tj === currentColumns - 1 && 'advanced-cropper-stencil-grid__cell--right',\n\t\t\t\t\t)}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\t\tnodes.push(\n\t\t\t<div key={i} className={'advanced-cropper-stencil-grid__row'}>\n\t\t\t\t{cells}\n\t\t\t</div>,\n\t\t);\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t'advanced-cropper-stencil-grid',\n\t\t\t\tvisible && 'advanced-cropper-stencil-grid--visible',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t>\n\t\t\t{nodes}\n\t\t</div>\n\t);\n};\n","import React, { ComponentType, forwardRef, useImperativeHandle } from 'react';\nimport cn from 'classnames';\nimport {\n\tCardinalDirection,\n\tOrdinalDirection,\n\tCropperImage,\n\tMoveDirections,\n\tResizeDirections,\n\tCropperState,\n\tCropperTransitions,\n\tRawAspectRatio,\n\tCropperInteractions,\n} from 'advanced-cropper';\nimport { createAspectRatio, getStencilCoordinates } from 'advanced-cropper/service';\nimport { ResizeOptions } from 'advanced-cropper/state';\nimport { SimpleLine } from '../lines/SimpleLine';\nimport { SimpleHandler } from '../handlers/SimpleHandler';\nimport { BoundingBox } from '../service/BoundingBox';\nimport { StencilOverlay } from '../service/StencilOverlay';\nimport { DraggableArea } from '../service/DraggableArea';\nimport { StencilWrapper } from '../service/StencilWrapper';\nimport { StencilGrid } from '../service/StencilGrid';\n\ntype HandlerComponent = ComponentType<any>;\n\ntype LineComponent = ComponentType<any>;\n\ninterface HandlerClassNames extends Partial<Record<OrdinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface LineClassNames extends Partial<Record<CardinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState;\n\tgetTransitions: () => CropperTransitions;\n\tgetInteractions: () => CropperInteractions;\n\thasInteractions: () => boolean;\n\tresizeCoordinates: (directions: ResizeDirections, options: ResizeOptions) => void;\n\tresizeCoordinatesEnd: () => void;\n\tmoveCoordinates: (directions: MoveDirections) => void;\n\tmoveCoordinatesEnd: () => void;\n\trefresh: () => void;\n}\n\ninterface Props {\n\tcropper: DesiredCropperRef;\n\timage?: CropperImage | null;\n\thandlerComponent?: HandlerComponent;\n\thandlers?: Partial<Record<OrdinalDirection, boolean>>;\n\thandlerClassNames?: HandlerClassNames;\n\thandlerWrapperClassNames?: HandlerClassNames;\n\tlines?: Partial<Record<CardinalDirection, boolean>>;\n\tlineComponent?: LineComponent;\n\tlineClassNames?: LineClassNames;\n\tlineWrapperClassNames?: LineClassNames;\n\tmovingClassName?: string;\n\tresizingClassName?: string;\n\tgridClassName?: string;\n\tpreviewClassName?: string;\n\tboundingBoxClassName?: string;\n\toverlayClassName?: string;\n\tdraggableAreaClassName?: string;\n\tminAspectRatio?: number;\n\tmaxAspectRatio?: number;\n\taspectRatio?: number;\n\tmovable?: boolean;\n\tresizable?: boolean;\n\tgrid?: boolean;\n}\n\ninterface Methods {\n\taspectRatio: RawAspectRatio;\n}\n\nexport const RectangleStencil = forwardRef<Methods, Props>(\n\t(\n\t\t{\n\t\t\tcropper,\n\t\t\taspectRatio,\n\t\t\tminAspectRatio,\n\t\t\tmaxAspectRatio,\n\t\t\thandlerComponent = SimpleHandler,\n\t\t\thandlers = {\n\t\t\t\teastNorth: true,\n\t\t\t\tnorth: true,\n\t\t\t\twestNorth: true,\n\t\t\t\twest: true,\n\t\t\t\twestSouth: true,\n\t\t\t\tsouth: true,\n\t\t\t\teastSouth: true,\n\t\t\t\teast: true,\n\t\t\t},\n\t\t\thandlerClassNames = {},\n\t\t\thandlerWrapperClassNames = {},\n\t\t\tlines = {\n\t\t\t\twest: true,\n\t\t\t\tnorth: true,\n\t\t\t\teast: true,\n\t\t\t\tsouth: true,\n\t\t\t},\n\t\t\tlineComponent = SimpleLine,\n\t\t\tlineClassNames = {},\n\t\t\tlineWrapperClassNames = {},\n\t\t\tresizable = true,\n\t\t\tmovable = true,\n\t\t\tgrid,\n\t\t\tgridClassName,\n\t\t\tmovingClassName,\n\t\t\tresizingClassName,\n\t\t\tpreviewClassName,\n\t\t\tboundingBoxClassName,\n\t\t\toverlayClassName,\n\t\t\tdraggableAreaClassName,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst state = cropper.getState();\n\t\tconst transitions = cropper.getTransitions();\n\t\tconst interactions = cropper.getInteractions();\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\taspectRatio: createAspectRatio(\n\t\t\t\taspectRatio || {\n\t\t\t\t\tminimum: minAspectRatio,\n\t\t\t\t\tmaximum: maxAspectRatio,\n\t\t\t\t},\n\t\t\t),\n\t\t}));\n\n\t\tconst onMove = (directions: MoveDirections) => {\n\t\t\tif (cropper && movable) {\n\t\t\t\tcropper.moveCoordinates(directions);\n\t\t\t}\n\t\t};\n\n\t\tconst onMoveEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.moveCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst onResize = (directions: ResizeDirections, options: ResizeOptions) => {\n\t\t\tif (cropper && resizable) {\n\t\t\t\tcropper.resizeCoordinates(directions, options);\n\t\t\t}\n\t\t};\n\n\t\tconst onResizeEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.resizeCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst { width, height, left, top } = getStencilCoordinates(state);\n\n\t\treturn (\n\t\t\tstate && (\n\t\t\t\t<StencilWrapper\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t'advanced-cropper-rectangle-stencil',\n\t\t\t\t\t\tmovable && 'advanced-cropper-rectangle-stencil--movable',\n\t\t\t\t\t\tinteractions.moveCoordinates && 'advanced-cropper-rectangle-stencil--moving',\n\t\t\t\t\t\tresizable && 'advanced-cropper-rectangle-stencil--resizable',\n\t\t\t\t\t\tinteractions.resizeCoordinates && 'advanced-cropper-rectangle-stencil--resizing',\n\t\t\t\t\t\tinteractions.moveCoordinates && movingClassName,\n\t\t\t\t\t\tinteractions.resizeCoordinates && resizingClassName,\n\t\t\t\t\t)}\n\t\t\t\t\twidth={width}\n\t\t\t\t\theight={height}\n\t\t\t\t\tleft={left}\n\t\t\t\t\ttop={top}\n\t\t\t\t\ttransitions={transitions}\n\t\t\t\t>\n\t\t\t\t\t<BoundingBox\n\t\t\t\t\t\tclassName={cn(boundingBoxClassName, 'advanced-cropper-rectangle-stencil__bounding-box')}\n\t\t\t\t\t\thandlers={handlers}\n\t\t\t\t\t\thandlerComponent={handlerComponent}\n\t\t\t\t\t\thandlerClassNames={handlerClassNames}\n\t\t\t\t\t\thandlerWrapperClassNames={handlerWrapperClassNames}\n\t\t\t\t\t\tlines={lines}\n\t\t\t\t\t\tlineComponent={lineComponent}\n\t\t\t\t\t\tlineClassNames={lineClassNames}\n\t\t\t\t\t\tlineWrapperClassNames={lineWrapperClassNames}\n\t\t\t\t\t\tonResize={onResize}\n\t\t\t\t\t\tonResizeEnd={onResizeEnd}\n\t\t\t\t\t\tdisabled={!resizable}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DraggableArea\n\t\t\t\t\t\t\tdisabled={!movable}\n\t\t\t\t\t\t\tonMove={onMove}\n\t\t\t\t\t\t\tonMoveEnd={onMoveEnd}\n\t\t\t\t\t\t\tclassName={cn('advanced-cropper-rectangle-stencil__draggable-area', draggableAreaClassName)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<StencilOverlay\n\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-rectangle-stencil__overlay', overlayClassName)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{grid && (\n\t\t\t\t\t\t\t\t\t<StencilGrid\n\t\t\t\t\t\t\t\t\t\tvisible={cropper.hasInteractions()}\n\t\t\t\t\t\t\t\t\t\tcolumns={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\trows={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-rectangle-stencil__grid', gridClassName)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div className={cn('advanced-cropper-rectangle-stencil__preview', previewClassName)} />\n\t\t\t\t\t\t\t</StencilOverlay>\n\t\t\t\t\t\t</DraggableArea>\n\t\t\t\t\t</BoundingBox>\n\t\t\t\t</StencilWrapper>\n\t\t\t)\n\t\t);\n\t},\n);\n\nRectangleStencil.displayName = 'RectangleStencil';\n","import { useMemo } from 'react';\nimport { getOptions } from 'advanced-cropper';\nimport { ScaleImageSettings } from '../types';\n\ninterface UseScaleImageOptions {\n\ttouch: boolean;\n\twheel:\n\t\t| boolean\n\t\t| {\n\t\t\t\tratio: number;\n\t\t  };\n}\n\nexport function useScaleImageOptions(scaleImage: ScaleImageSettings | boolean) {\n\treturn useMemo<UseScaleImageOptions>(\n\t\t() =>\n\t\t\tgetOptions(\n\t\t\t\tscaleImage,\n\t\t\t\t{\n\t\t\t\t\ttouch: true,\n\t\t\t\t\twheel: {\n\t\t\t\t\t\tratio: 0.1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttouch: false,\n\t\t\t\t\twheel: false,\n\t\t\t\t},\n\t\t\t),\n\t\t[scaleImage],\n\t);\n}\n","import { useMemo } from 'react';\nimport { getOptions } from 'advanced-cropper';\nimport { MoveImageSettings } from '../types';\n\nexport function useMoveImageOptions(moveImage: MoveImageSettings | boolean) {\n\treturn useMemo(\n\t\t() =>\n\t\t\tgetOptions(\n\t\t\t\tmoveImage,\n\t\t\t\t{\n\t\t\t\t\ttouch: true,\n\t\t\t\t\tmouse: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttouch: false,\n\t\t\t\t\tmouse: false,\n\t\t\t\t},\n\t\t\t),\n\t\t[moveImage],\n\t);\n}\n","import React, { ReactNode, CSSProperties, Component, RefObject, createRef } from 'react';\nimport {\n\tdebounce,\n\tDebouncedFunction,\n\tImageTransform,\n\tPoint,\n\tSimpleTouch,\n\ttouchesToImageTransform,\n\twheelEventToImageTransform,\n} from 'advanced-cropper';\n\ninterface Props {\n\tonTransform?: (transform: ImageTransform) => void;\n\tonTransformEnd?: () => void;\n\tonEvent?: (transformEvent: TransformableImageEvent, nativeEvent: Event) => unknown;\n\tdisabled?: boolean;\n\ttouchMove?: boolean;\n\tmouseMove?: boolean;\n\ttouchScale?: boolean;\n\ttouchRotate?: boolean;\n\twheelScale?:\n\t\t| boolean\n\t\t| {\n\t\t\t\tratio: number;\n\t\t  };\n\ttimeout?: number;\n\tchildren?: ReactNode;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n}\n\nexport class TransformableImageEvent {\n\tconstructor({ active }: { active: boolean }) {\n\t\tthis.active = active;\n\t\tthis.defaultPrevented = false;\n\t}\n\tpreventDefault() {\n\t\tthis.defaultPrevented = true;\n\t}\n\tdefaultPrevented: boolean;\n\tactive: boolean;\n}\n\nexport class TransformableImage extends Component<Props> {\n\ttouches: (SimpleTouch & { identifier?: number })[];\n\ttransforming: boolean;\n\tanchor: Point;\n\tcontainer: RefObject<HTMLDivElement>;\n\tdebouncedProcessEnd: DebouncedFunction<TransformableImage['processEnd']>;\n\n\tstatic defaultProps = {\n\t\ttouchMove: true,\n\t\tmouseMove: true,\n\t\ttouchScale: true,\n\t\ttouchRotate: false,\n\t\twheelScale: true,\n\t\ttimeout: 500,\n\t};\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.transforming = false;\n\t\tthis.touches = [];\n\t\tthis.anchor = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t};\n\t\tthis.container = createRef();\n\t\tthis.debouncedProcessEnd = debounce(this.processEnd, props.timeout);\n\t}\n\n\tprocessMove = (newTouches: SimpleTouch[]) => {\n\t\tconst { onTransform, touchScale, touchMove, touchRotate } = this.props;\n\t\tconst container = this.container.current;\n\t\tif (container && onTransform) {\n\t\t\tonTransform(\n\t\t\t\ttouchesToImageTransform(newTouches, this.touches, container, {\n\t\t\t\t\tscale: touchScale,\n\t\t\t\t\trotate: touchRotate,\n\t\t\t\t\tmove: touchMove,\n\t\t\t\t}),\n\t\t\t);\n\t\t\tthis.touches = newTouches;\n\t\t}\n\t};\n\n\tprocessEnd = () => {\n\t\tconst { onTransformEnd } = this.props;\n\t\tif (this.transforming) {\n\t\t\tthis.transforming = false;\n\t\t\tif (onTransformEnd) {\n\t\t\t\tonTransformEnd();\n\t\t\t}\n\t\t}\n\t};\n\n\tprocessStart = () => {\n\t\tthis.transforming = true;\n\t\tthis.debouncedProcessEnd.clear();\n\t};\n\n\tprocessEvent = (nativeEvent: Event) => {\n\t\tconst { onEvent, disabled } = this.props;\n\t\tconst transformEvent = new TransformableImageEvent({ active: this.transforming });\n\n\t\tif (onEvent) {\n\t\t\tonEvent(transformEvent, nativeEvent);\n\t\t} else {\n\t\t\tnativeEvent.preventDefault();\n\t\t\tnativeEvent.stopPropagation();\n\t\t}\n\n\t\treturn !disabled && !transformEvent.defaultPrevented;\n\t};\n\n\tonWheel = (event: WheelEvent) => {\n\t\tconst { onTransform, wheelScale } = this.props;\n\t\tconst container = this.container.current;\n\n\t\tif (wheelScale) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tthis.processStart();\n\t\t\t\tif (onTransform && container) {\n\t\t\t\t\tonTransform(\n\t\t\t\t\t\twheelEventToImageTransform(event, container, wheelScale === true ? 0.1 : wheelScale.ratio),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (!this.touches.length) {\n\t\t\t\t\tthis.debouncedProcessEnd();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tonTouchStart = (event: TouchEvent) => {\n\t\tconst { touchMove, touchScale, touchRotate } = this.props;\n\t\tif (event.cancelable && (touchMove || ((touchScale || touchRotate) && event.touches.length > 1))) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tconst container = this.container.current;\n\t\t\t\tif (container) {\n\t\t\t\t\tconst { left, top, bottom, right } = container.getBoundingClientRect();\n\t\t\t\t\tthis.touches = Array.from(event.touches).filter(\n\t\t\t\t\t\t(touch) =>\n\t\t\t\t\t\t\ttouch.clientX > left &&\n\t\t\t\t\t\t\ttouch.clientX < right &&\n\t\t\t\t\t\t\ttouch.clientY > top &&\n\t\t\t\t\t\t\ttouch.clientY < bottom,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tonTouchEnd = (event: TouchEvent) => {\n\t\tif (event.touches.length === 0) {\n\t\t\tthis.touches = [];\n\t\t\tthis.processEnd();\n\t\t}\n\t};\n\n\tonTouchMove = (event: TouchEvent) => {\n\t\tif (this.touches.length) {\n\t\t\tconst touches = [...event.touches].filter(\n\t\t\t\t(touch) =>\n\t\t\t\t\t!touch.identifier ||\n\t\t\t\t\tthis.touches.find((anotherTouch) => anotherTouch.identifier === touch.identifier),\n\t\t\t);\n\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tthis.processMove(touches);\n\t\t\t\tthis.processStart();\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseDown = (event: MouseEvent) => {\n\t\tconst { mouseMove } = this.props;\n\t\tif (mouseMove && 'buttons' in event && event.buttons === 1) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tconst touch = {\n\t\t\t\t\tclientX: event.clientX,\n\t\t\t\t\tclientY: event.clientY,\n\t\t\t\t};\n\t\t\t\tthis.touches = [touch];\n\t\t\t\tthis.processStart();\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseMove = (event: MouseEvent) => {\n\t\tif (this.touches.length) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tthis.processMove([\n\t\t\t\t\t{\n\t\t\t\t\t\tclientX: event.clientX,\n\t\t\t\t\t\tclientY: event.clientY,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseUp = () => {\n\t\tthis.touches = [];\n\t\tthis.processEnd();\n\t};\n\n\tshouldComponentUpdate(): boolean {\n\t\treturn true;\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\tcontainer.removeEventListener('touchstart', this.onTouchStart);\n\t\t\tcontainer.removeEventListener('mousedown', this.onMouseDown);\n\t\t\tcontainer.removeEventListener('wheel', this.onWheel);\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false });\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false });\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false });\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false });\n\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\t// Add event listeners here due to https://github.com/facebook/react/issues/9809#issuecomment-414072263\n\t\t\tcontainer.addEventListener('touchstart', this.onTouchStart, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t\tcontainer.addEventListener('mousedown', this.onMouseDown, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t\tcontainer.addEventListener('wheel', this.onWheel, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { className, children, style } = this.props;\n\t\treturn (\n\t\t\t<div className={className} style={style} ref={this.container}>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React, { CSSProperties, ReactNode } from 'react';\nimport { CropperTransitions, ImageTransform } from 'advanced-cropper';\nimport { useRotateImageOptions } from '../../hooks/useRotateImageOptions';\nimport { useScaleImageOptions } from '../../hooks/useScaleImageOptions';\nimport { useMoveImageOptions } from '../../hooks/useMoveImageOptions';\nimport { MoveImageSettings, RotateImageSettings, ScaleImageSettings } from '../../types';\nimport { TransformableImage } from './TransformableImage';\n\ninterface DesiredCropperRef {\n\ttransformImage: (transform: ImageTransform) => void;\n\ttransformImageEnd: () => void;\n\tgetTransitions: () => CropperTransitions;\n}\n\nexport interface CropperBackgroundWrapperProps {\n\tcropper: DesiredCropperRef;\n\trotateImage?: boolean | RotateImageSettings;\n\tscaleImage?: boolean | ScaleImageSettings;\n\tmoveImage?: boolean | MoveImageSettings;\n\tchildren?: ReactNode;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\ttimeout?: number;\n}\n\nexport const CropperBackgroundWrapper = ({\n\tscaleImage = true,\n\tmoveImage = true,\n\trotateImage = false,\n\tchildren,\n\tclassName,\n\tstyle,\n\tcropper,\n\ttimeout,\n}: CropperBackgroundWrapperProps) => {\n\tconst transitions = cropper.getTransitions();\n\n\tconst rotateImageOptions = useRotateImageOptions(rotateImage);\n\tconst scaleImageOptions = useScaleImageOptions(scaleImage);\n\tconst moveImageOptions = useMoveImageOptions(moveImage);\n\n\treturn (\n\t\t<TransformableImage\n\t\t\tclassName={className}\n\t\t\tstyle={style}\n\t\t\tonTransform={cropper.transformImage}\n\t\t\tonTransformEnd={cropper.transformImageEnd}\n\t\t\ttouchMove={moveImageOptions.touch}\n\t\t\tmouseMove={moveImageOptions.mouse}\n\t\t\ttouchScale={scaleImageOptions.touch}\n\t\t\twheelScale={scaleImageOptions.wheel}\n\t\t\ttouchRotate={rotateImageOptions.touch}\n\t\t\tdisabled={transitions.active}\n\t\t\ttimeout={timeout}\n\t\t>\n\t\t\t{children}\n\t\t</TransformableImage>\n\t);\n};\n","import { useMemo } from 'react';\nimport { getOptions } from 'advanced-cropper';\nimport { RotateImageSettings } from '../types';\n\nexport function useRotateImageOptions(rotateImage: RotateImageSettings | boolean) {\n\treturn useMemo(\n\t\t() =>\n\t\t\tgetOptions(\n\t\t\t\trotateImage,\n\t\t\t\t{\n\t\t\t\t\ttouch: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttouch: false,\n\t\t\t\t},\n\t\t\t),\n\t\t[rotateImage],\n\t);\n}\n","import React, { useImperativeHandle, useRef, CSSProperties, Ref, useState } from 'react';\nimport cn from 'classnames';\nimport {\n\tDrawOptions,\n\tBoundaryStretchAlgorithm,\n\tDefaultSettings,\n\tdefaultStencilConstraints,\n\tBoundarySizeAlgorithm,\n\tCoreSettings,\n\tCropperImage,\n\tCropperState,\n\tCropperTransitions,\n\tModifierSettings,\n\tAbstractCropperCallbacks,\n\tAbstractCropperParameters,\n} from 'advanced-cropper';\n\nimport {\n\tCropperBackgroundWrapperComponent,\n\tCropperWrapperComponent,\n\tStencilComponent,\n\tCropperBackgroundComponent,\n\tArbitraryProps,\n\tStencilConstraints,\n\tSettingsExtension,\n\tExtendedSettings,\n\tCustomCropperRef,\n} from '../types';\nimport { useWindowResize } from '../hooks/useWindowResize';\nimport { useCropperImage } from '../hooks/useCropperImage';\nimport {\n\tCropperStateHook,\n\tCropperStateSettings,\n\tCropperStateSettingsProp,\n\tuseCropperState,\n} from '../hooks/useCropperState';\nimport { mergeRefs } from '../service/react';\nimport { useUpdateEffect } from '../hooks/useUpdateEffect';\nimport { useStateWithCallback } from '../hooks/useStateWithCallback';\nimport { createCropper } from '../service/cropper';\nimport { StretchableBoundary, StretchableBoundaryMethods } from './service/StretchableBoundary';\nimport { CropperWrapper } from './service/CropperWrapper';\nimport { CropperBackgroundImage } from './service/CropperBackgroundImage';\nimport { CropperCanvas, CropperCanvasMethods } from './service/CropperCanvas';\nimport { RectangleStencil } from './stencils/RectangleStencil';\nimport { CropperBackgroundWrapper } from './service/CropperBackgroundWrapper';\n\nexport type AbstractCropperSettingsProp<Settings extends CropperStateSettings> = CropperStateSettingsProp<Settings>;\n\nexport type AbstractCropperSettings = DefaultSettings & CoreSettings & ModifierSettings;\n\nexport interface AbstractCropperRef<Settings extends AbstractCropperSettings = AbstractCropperSettings> {\n\treset: () => void;\n\trefresh: () => void;\n\tsetCoordinates: CropperStateHook['setCoordinates'];\n\tsetState: CropperStateHook['setState'];\n\tsetImage: (image: CropperImage) => void;\n\tflipImage: CropperStateHook['flipImage'];\n\tzoomImage: CropperStateHook['zoomImage'];\n\trotateImage: CropperStateHook['rotateImage'];\n\treconcileState: CropperStateHook['reconcileState'];\n\tmoveImage: CropperStateHook['moveImage'];\n\tmoveCoordinates: CropperStateHook['moveCoordinates'];\n\tmoveCoordinatesEnd: CropperStateHook['moveCoordinatesEnd'];\n\tresizeCoordinates: CropperStateHook['resizeCoordinates'];\n\tresizeCoordinatesEnd: CropperStateHook['resizeCoordinatesEnd'];\n\ttransformImage: CropperStateHook['transformImage'];\n\ttransformImageEnd: CropperStateHook['transformImageEnd'];\n\tgetCoordinates: CropperStateHook['getCoordinates'];\n\tgetVisibleArea: CropperStateHook['getVisibleArea'];\n\tgetTransforms: CropperStateHook['getTransforms'];\n\tgetStencilCoordinates: CropperStateHook['getStencilCoordinates'];\n\tgetDefaultState: () => CropperState | null;\n\tgetCanvas: (options?: DrawOptions) => HTMLCanvasElement | null;\n\tgetSettings: () => Settings;\n\tgetImage: () => CropperImage | null;\n\tgetState: () => CropperState | null;\n\tgetTransitions: () => CropperTransitions;\n}\n\nexport interface AbstractCropperProps<Settings extends AbstractCropperSettings>\n\textends AbstractCropperParameters<Settings>,\n\t\tAbstractCropperCallbacks<AbstractCropperRef<Settings>> {\n\tsrc?: string | null;\n\tbackgroundComponent?: CropperBackgroundComponent;\n\tbackgroundProps?: ArbitraryProps;\n\tbackgroundWrapperComponent?: CropperBackgroundWrapperComponent;\n\tbackgroundWrapperProps?: ArbitraryProps;\n\twrapperComponent?: CropperWrapperComponent;\n\twrapperProps?: ArbitraryProps;\n\tstencilComponent?: StencilComponent;\n\tstencilProps?: ArbitraryProps;\n\tstencilConstraints?: StencilConstraints<AbstractCropperSettingsProp<Settings>>;\n\tclassName?: string;\n\timageClassName?: string;\n\tboundaryClassName?: string;\n\tbackgroundClassName?: string;\n\tcheckOrientation?: boolean;\n\tcanvas?: boolean;\n\tcrossOrigin?: 'anonymous' | 'use-credentials';\n\tboundaryStretchAlgorithm?: BoundaryStretchAlgorithm;\n\tboundarySizeAlgorithm?: BoundarySizeAlgorithm;\n\tstyle?: CSSProperties;\n\tonReady?: (cropper: AbstractCropperRef<Settings>) => void;\n\tonError?: (cropper: AbstractCropperRef<Settings>) => void;\n\tunloadTime?: number;\n\tsettings: CropperStateSettingsProp<Settings>;\n\tautoReconcileState?: boolean;\n}\n\nexport type AbstractCropperIntrinsicProps<Settings extends AbstractCropperSettings> = Omit<\n\tAbstractCropperProps<Settings>,\n\t'settings'\n>;\n\nconst AbstractCropperComponent = <Extension extends SettingsExtension = {}>(\n\tprops: AbstractCropperProps<ExtendedSettings<Extension>>,\n\tref: Ref<CustomCropperRef<Extension>>,\n) => {\n\tconst {\n\t\tsrc,\n\t\tstencilComponent = RectangleStencil,\n\t\tstencilConstraints = defaultStencilConstraints,\n\t\tstencilProps = {},\n\t\twrapperComponent = CropperWrapper,\n\t\twrapperProps = {},\n\t\tbackgroundComponent = CropperBackgroundImage,\n\t\tbackgroundProps = {},\n\t\tbackgroundWrapperComponent = CropperBackgroundWrapper,\n\t\tbackgroundWrapperProps = {},\n\t\timageClassName,\n\t\tclassName,\n\t\tboundaryClassName,\n\t\tbackgroundClassName,\n\t\tboundarySizeAlgorithm,\n\t\tboundaryStretchAlgorithm,\n\t\tcrossOrigin = true,\n\t\tcheckOrientation = true,\n\t\tautoReconcileState = true,\n\t\tcanvas = true,\n\t\tstyle,\n\t\tonReady,\n\t\tonError,\n\t\tunloadTime = 500,\n\t\tsettings,\n\t\t...parameters\n\t} = props;\n\n\tconst stencilRef = useRef<StencilComponent>(null);\n\tconst imageRef = useRef<HTMLImageElement | HTMLCanvasElement>(null);\n\tconst boundaryRef = useRef<StretchableBoundaryMethods>(null);\n\tconst canvasRef = useRef<CropperCanvasMethods>(null);\n\tconst cropperRef = useRef<AbstractCropperRef<ExtendedSettings<Extension>>>(null);\n\n\tconst [currentImage, setCurrentImage] = useStateWithCallback<CropperImage | null>(null);\n\tconst [autoReconcileStateDisabled, setAutoReconcileStateDisabled] = useState(false);\n\n\tconst cropper = useCropperState(\n\t\t() => ({\n\t\t\t...parameters,\n\t\t\tgetInstance() {\n\t\t\t\treturn cropperRef.current;\n\t\t\t},\n\t\t\tsettings: {\n\t\t\t\t...settings,\n\t\t\t\t...stencilConstraints(settings, {\n\t\t\t\t\t...stencilProps,\n\t\t\t\t\t...stencilRef.current,\n\t\t\t\t}),\n\t\t\t},\n\t\t}),\n\t\t{\n\t\t\tautoReconcileState: autoReconcileState && !autoReconcileStateDisabled,\n\t\t},\n\t);\n\n\tconst { image, loaded, loading } = useCropperImage({\n\t\tsrc,\n\t\tcrossOrigin,\n\t\tcheckOrientation,\n\t\tunloadTime,\n\t\tcanvas,\n\t\tonLoad() {\n\t\t\tif (cropperRef.current) {\n\t\t\t\tonReady?.(cropperRef.current);\n\t\t\t}\n\t\t},\n\t\tonError() {\n\t\t\tif (cropperRef.current) {\n\t\t\t\tonError?.(cropperRef.current);\n\t\t\t}\n\t\t},\n\t});\n\n\tconst resetCropper = () => {\n\t\tif (boundaryRef.current) {\n\t\t\tsetAutoReconcileStateDisabled(true);\n\t\t\tboundaryRef.current\n\t\t\t\t?.stretchTo(image)\n\t\t\t\t.then((boundary) => {\n\t\t\t\t\tsetCurrentImage(image, () => {\n\t\t\t\t\t\tif (boundary && image) {\n\t\t\t\t\t\t\tcropper.reset(boundary, image);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcropper.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tsetAutoReconcileStateDisabled(false);\n\t\t\t\t});\n\t\t}\n\t};\n\n\tconst refreshCropper = () => {\n\t\tif (boundaryRef.current) {\n\t\t\tsetAutoReconcileStateDisabled(true);\n\t\t\tboundaryRef.current\n\t\t\t\t?.stretchTo(image)\n\t\t\t\t.then((boundary) => {\n\t\t\t\t\tif (boundary && image) {\n\t\t\t\t\t\tconst state = cropper.getState();\n\t\t\t\t\t\tif (state) {\n\t\t\t\t\t\t\tif (boundary.width !== state.boundary.width || boundary.height !== state.boundary.height) {\n\t\t\t\t\t\t\t\tcropper.setBoundary(boundary);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// It's important because, probably, after the boundary reset\n\t\t\t\t\t\t\t// the cropper can meet some restrictions that were broken before\n\t\t\t\t\t\t\tcropper.reconcileState();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcropper.reset(boundary, image);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcropper.clear();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tsetAutoReconcileStateDisabled(false);\n\t\t\t\t});\n\t\t}\n\t};\n\n\tconst cropperInterface = {\n\t\treset: () => {\n\t\t\tresetCropper();\n\t\t},\n\t\trefresh: () => {\n\t\t\trefreshCropper();\n\t\t},\n\t\tgetCanvas: (options?: DrawOptions) => {\n\t\t\tconst state = cropper.getState();\n\t\t\tif (imageRef.current && canvasRef.current && state) {\n\t\t\t\treturn canvasRef.current.draw(state, imageRef.current, options);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tgetImage: () => {\n\t\t\treturn currentImage ? { ...currentImage } : null;\n\t\t},\n\t\tsetImage: (image: CropperImage) => {\n\t\t\tsetCurrentImage(image);\n\t\t},\n\t\treconcileState: cropper.reconcileState,\n\t\tmoveCoordinates: cropper.moveCoordinates,\n\t\tmoveCoordinatesEnd: cropper.moveCoordinatesEnd,\n\t\tresizeCoordinates: cropper.resizeCoordinates,\n\t\tclear: cropper.clear,\n\t\tresizeCoordinatesEnd: cropper.resizeCoordinatesEnd,\n\t\tmoveImage: cropper.moveImage,\n\t\tflipImage: cropper.flipImage,\n\t\tzoomImage: cropper.zoomImage,\n\t\trotateImage: cropper.rotateImage,\n\t\ttransformImage: cropper.transformImage,\n\t\ttransformImageEnd: cropper.transformImageEnd,\n\t\tsetCoordinates: cropper.setCoordinates,\n\t\tsetState: cropper.setState,\n\t\thasInteractions: cropper.hasInteractions,\n\t\tgetStencilCoordinates: cropper.getStencilCoordinates,\n\t\tgetCoordinates: cropper.getCoordinates,\n\t\tgetVisibleArea: cropper.getVisibleArea,\n\t\tgetTransforms: cropper.getTransforms,\n\t\tgetTransitions: cropper.getTransitions,\n\t\tgetInteractions: cropper.getInteractions,\n\t\tgetSettings: cropper.getSettings,\n\t\tgetState: cropper.getState,\n\t\tgetDefaultState() {\n\t\t\tconst state = cropper.getState();\n\t\t\treturn state && image && cropper.createDefaultState(state.boundary, image);\n\t\t},\n\t};\n\n\tuseWindowResize(() => {\n\t\trefreshCropper();\n\t});\n\n\tuseUpdateEffect(() => {\n\t\tresetCropper();\n\t}, [image]);\n\n\tuseImperativeHandle(mergeRefs([ref, cropperRef]), () => cropperInterface);\n\n\tconst StencilComponent = stencilComponent;\n\n\tconst WrapperComponent = wrapperComponent;\n\n\tconst BackgroundWrapperComponent = backgroundWrapperComponent;\n\n\tconst BackgroundComponent = backgroundComponent;\n\n\treturn (\n\t\t<WrapperComponent\n\t\t\t{...wrapperProps}\n\t\t\tclassName={cn('advanced-cropper', className)}\n\t\t\tloaded={loaded}\n\t\t\tcropper={cropperInterface}\n\t\t\tloading={loading}\n\t\t\tstyle={style}\n\t\t>\n\t\t\t<StretchableBoundary\n\t\t\t\tref={boundaryRef}\n\t\t\t\tstretchAlgorithm={boundaryStretchAlgorithm}\n\t\t\t\tsizeAlgorithm={boundarySizeAlgorithm}\n\t\t\t\tclassName={cn('advanced-cropper__boundary', boundaryClassName)}\n\t\t\t\tstretcherClassName={cn('advanced-cropper__stretcher')}\n\t\t\t>\n\t\t\t\t<BackgroundWrapperComponent\n\t\t\t\t\t{...backgroundWrapperProps}\n\t\t\t\t\tcropper={cropperInterface}\n\t\t\t\t\tclassName={'advanced-cropper__background-wrapper'}\n\t\t\t\t>\n\t\t\t\t\t<div className={cn('advanced-cropper__background', backgroundClassName)}>\n\t\t\t\t\t\t{cropper.getState() && (\n\t\t\t\t\t\t\t<BackgroundComponent\n\t\t\t\t\t\t\t\t{...backgroundProps}\n\t\t\t\t\t\t\t\tref={imageRef}\n\t\t\t\t\t\t\t\tcrossOrigin={crossOrigin}\n\t\t\t\t\t\t\t\tcropper={cropperInterface}\n\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper__image', imageClassName)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<StencilComponent\n\t\t\t\t\t\t{...stencilProps}\n\t\t\t\t\t\tref={stencilRef}\n\t\t\t\t\t\tcropper={cropperInterface}\n\t\t\t\t\t\timage={currentImage}\n\t\t\t\t\t/>\n\t\t\t\t</BackgroundWrapperComponent>\n\t\t\t\t{canvas && <CropperCanvas ref={canvasRef} />}\n\t\t\t</StretchableBoundary>\n\t\t</WrapperComponent>\n\t);\n};\n\nexport const AbstractCropper = createCropper(AbstractCropperComponent);\n","import { SetStateAction, useRef, useState } from \"react\";\nimport { useUpdateEffect } from \"./useUpdateEffect\";\n\ntype DispatchWithCallback<S> = (value: SetStateAction<S>, callback?: Function) => void;\n\nexport function useStateWithCallback<S>(initialState?: S | (() => S)): [S, DispatchWithCallback<S>];\nexport function useStateWithCallback<S = undefined>(): [S | undefined, DispatchWithCallback<S  | undefined>];\nexport function useStateWithCallback<S = undefined>(initialState?: S | (() => S)): [S | undefined, DispatchWithCallback<S | undefined>]  {\n\tconst [state, setState] = useState(initialState);\n\tconst [callback, setCallback] = useState<Function | null | undefined>(null);\n\tconst previousState = useRef(initialState);\n\n\tuseUpdateEffect(() => {\n\t\tif (callback) {\n\t\t\tcallback(state, previousState.current);\n\t\t}\n\t}, [callback])\n\n\treturn [\n\t\tstate,\n\t\t(value: SetStateAction<S | undefined>, callback?: Function) => {\n\t\t\tpreviousState.current = state;\n\t\t\tsetState(value);\n\t\t\tsetCallback(() => callback);\n\t\t}\n\t]\n}\n","import { __assign } from 'tslib';\nimport { isFunction } from '../../utils/index.js';\nimport { aspectRatioIntersection, createAspectRatio, ratio, applyScale, fitToSizeRestrictions, applyMove, diff, getCenter, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from '../../service/utils.js';\nimport { getAreaSizeRestrictions, getSizeRestrictions, getAspectRatio, isInitializedState, getAreaPositionRestrictions } from '../../service/helpers.js';\nimport { copyState } from '../../state/copyState.js';\nimport '../../types/index.js';\nimport '../../state/setCoordinates.js';\nimport { approximateSize } from '../../service/approximateSize.js';\nimport { defaultStencilConstraints } from '../../defaults/defaultStencilConstraints.js';\n\nfunction fixedStencilConstraints(rawSettings, stencilOptions) {\n    var defaultConstraints = defaultStencilConstraints({}, stencilOptions);\n    return {\n        stencilSize: function (state, settings) {\n            var previousSize = isFunction(rawSettings.stencilSize)\n                ? rawSettings.stencilSize(state, settings)\n                : rawSettings.stencilSize;\n            return approximateSize(__assign(__assign({}, previousSize), { aspectRatio: aspectRatioIntersection(defaultConstraints.aspectRatio, createAspectRatio(ratio(previousSize))) }));\n        },\n    };\n}\nfunction getStencilSize(state, settings) {\n    var boundary = state.boundary;\n    var size = isFunction(settings.stencilSize) ? settings.stencilSize(state, settings) : settings.stencilSize;\n    if (size.width > boundary.width || size.height > boundary.height) {\n        size = approximateSize({\n            sizeRestrictions: {\n                maxWidth: boundary.width,\n                maxHeight: boundary.height,\n                minWidth: 0,\n                minHeight: 0,\n            },\n            width: size.width,\n            height: size.height,\n            aspectRatio: {\n                minimum: ratio(size),\n                maximum: ratio(size),\n            },\n        });\n    }\n    return size;\n}\nfunction sizeRestrictions(state, settings) {\n    var stencilSize = getStencilSize(state, __assign(__assign({}, settings), { stencilSize: settings.stencilSize }));\n    var areaRestrictions = getAreaSizeRestrictions(state, settings);\n    return {\n        maxWidth: (areaRestrictions.maxWidth * stencilSize.width) / state.boundary.width,\n        maxHeight: (areaRestrictions.maxHeight * stencilSize.height) / state.boundary.height,\n        minWidth: 0,\n        minHeight: 0,\n    };\n}\nfunction defaultSize(state, settings) {\n    var imageSize = state.imageSize, visibleArea = state.visibleArea, boundary = state.boundary;\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    var aspectRatio = getAspectRatio(state, settings);\n    var stencilSize = isFunction(settings.stencilSize) ? settings.stencilSize(state, settings) : settings.stencilSize;\n    var area = (visibleArea || imageSize);\n    var height, width;\n    if (ratio(area) > ratio(boundary)) {\n        height = (stencilSize.height * area.height) / boundary.height;\n        width = height * ratio(stencilSize);\n    }\n    else {\n        width = (stencilSize.width * area.width) / boundary.width;\n        height = width / ratio(stencilSize);\n    }\n    return approximateSize({\n        width: width,\n        height: height,\n        aspectRatio: aspectRatio,\n        sizeRestrictions: sizeRestrictions,\n    });\n}\nfunction aspectRatio(state, settings) {\n    var value = ratio(getStencilSize(state, settings));\n    return {\n        minimum: value,\n        maximum: value,\n    };\n}\nfunction fixedStencilAlgorithm(state, settings) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var stencil = getStencilSize(state, settings);\n        // First of all try to resize visible area as much as possible:\n        result.visibleArea = applyScale(result.visibleArea, (result.coordinates.width * result.boundary.width) / (result.visibleArea.width * stencil.width));\n        // Check that visible area doesn't break the area restrictions:\n        var scale = fitToSizeRestrictions(result.visibleArea, getAreaSizeRestrictions(result, settings));\n        if (scale !== 1) {\n            result.visibleArea = applyScale(result.visibleArea, scale);\n            result.coordinates = applyScale(result.coordinates, scale);\n        }\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(result.coordinates), getCenter(result.visibleArea)));\n        // Center stencil in visible area:\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), getAreaPositionRestrictions(result, settings)));\n        return result;\n    }\n    return state;\n}\nfunction fixedStencil(state, settings, action) {\n    if (action && action.immediately) {\n        return fixedStencilAlgorithm(state, settings);\n    }\n    return state;\n}\n\nexport { aspectRatio, defaultSize, fixedStencil, fixedStencilAlgorithm, fixedStencilConstraints, getStencilSize, sizeRestrictions };\n","import React, { Ref } from 'react';\nimport {\n\tdefaultSize,\n\tsizeRestrictions,\n\taspectRatio,\n\tfixedStencil,\n\tStencilSize,\n\tfixedStencilConstraints,\n} from 'advanced-cropper/extensions/stencil-size';\nimport { withDefaultSizeRestrictions } from 'advanced-cropper/defaults';\nimport { CustomCropperProps, CustomCropperRef } from '../../types';\nimport { createCropper, splitAbstractCropperProps } from '../../service/cropper';\nimport { AbstractCropper } from '../AbstractCropper';\n\ntype UnavailableProps = 'sizeRestrictions' | 'aspectRatio';\n\nexport interface FixedCropperSettings {\n\tstencilSize: StencilSize<this>;\n}\n\nexport type FixedCropperProps<Extension extends FixedCropperSettings = FixedCropperSettings> = Omit<\n\tCustomCropperProps<Extension>,\n\tUnavailableProps\n>;\n\nexport type FixedCropperRef<Extension extends FixedCropperSettings = FixedCropperSettings> =\n\tCustomCropperRef<Extension>;\n\nconst FixedCropperComponent = <Extension extends FixedCropperSettings = FixedCropperSettings>(\n\tprops: FixedCropperProps<Extension>,\n\tref?: Ref<FixedCropperRef<Extension>>,\n) => {\n\tconst { settings, ...parameters } = splitAbstractCropperProps(props);\n\treturn (\n\t\t<AbstractCropper<FixedCropperSettings>\n\t\t\tpostProcess={fixedStencil}\n\t\t\tstencilConstraints={fixedStencilConstraints}\n\t\t\t{...parameters}\n\t\t\tsettings={{\n\t\t\t\tdefaultSize: defaultSize,\n\t\t\t\taspectRatio: aspectRatio,\n\t\t\t\tsizeRestrictions: withDefaultSizeRestrictions(sizeRestrictions),\n\t\t\t\t...settings,\n\t\t\t\ttransformImage: {\n\t\t\t\t\t...settings.transformImage,\n\t\t\t\t\tadjustStencil: false,\n\t\t\t\t},\n\t\t\t}}\n\t\t\tref={ref}\n\t\t/>\n\t);\n};\n\nexport const FixedCropper = createCropper(FixedCropperComponent);\n","import React, { Ref } from 'react';\nimport { isUndefined } from 'advanced-cropper';\nimport { StencilSize } from 'advanced-cropper/extensions/stencil-size';\nimport { CustomCropperProps, CustomCropperRef, SettingsExtension } from '../../types';\nimport { createCropper, splitAbstractCropperProps } from '../../service/cropper';\nimport { hybridStencilAutoZoom } from '../../deprecated/hybridAutoZoom';\nimport { useDeprecationWarning } from '../../hooks/useDeprecationWarning';\nimport { AbstractCropper } from '../AbstractCropper';\nimport { FixedCropper, FixedCropperRef, FixedCropperSettings } from './FixedCropper';\n\ninterface DeprecatedCropperSettings {\n\tstencilSize?: StencilSize;\n\tautoZoom?: boolean;\n}\n\nexport type CropperProps<Extension extends SettingsExtension = {}> = CustomCropperProps<Extension>;\n\nexport type CropperRef<Extension extends SettingsExtension = {}> = CustomCropperRef<Extension>;\n\nconst CropperComponent = <Extension extends SettingsExtension = {}>(\n\tprops: CropperProps<Extension>,\n\tref?: Ref<CropperRef<Extension>>,\n) => {\n\tlet { settings, postProcess, ...parameters } = splitAbstractCropperProps(props);\n\n\t// Process the deprecated properties\n\tconst { stencilSize, autoZoom, ...actualSettings } = settings as DeprecatedCropperSettings;\n\n\tconst deprecationWarning = useDeprecationWarning();\n\n\tif (!isUndefined(autoZoom)) {\n\t\tif (postProcess || stencilSize) {\n\t\t\tdeprecationWarning(\n\t\t\t\t`prop 'autoZoom' is deprecated now and will be removed, use 'postProcess' prop to pass your auto zoom function.`,\n\t\t\t);\n\t\t} else {\n\t\t\tdeprecationWarning(\n\t\t\t\t`prop 'autoZoom' is deprecated now and will be removed, use 'postProcess' prop to pass your auto zoom function. The 'postProcess' automatically set to 'hybridAutoZoom'`,\n\t\t\t);\n\t\t\tpostProcess = hybridStencilAutoZoom;\n\t\t}\n\t}\n\n\tif (!isUndefined(stencilSize)) {\n\t\tdeprecationWarning(\n\t\t\t`prop 'stencilSize' is deprecated for <Cropper/> component now and will be removed, use <FixedCropper/> component instead.`,\n\t\t);\n\t\treturn (\n\t\t\t<FixedCropper<FixedCropperSettings>\n\t\t\t\tref={ref as Ref<FixedCropperRef>}\n\t\t\t\tstencilSize={stencilSize}\n\t\t\t\t{...actualSettings}\n\t\t\t\t{...parameters}\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<AbstractCropper<DeprecatedCropperSettings>\n\t\t\t{...parameters}\n\t\t\tpostProcess={postProcess}\n\t\t\tref={ref}\n\t\t\tsettings={actualSettings}\n\t\t/>\n\t);\n};\n\nexport const Cropper = createCropper(CropperComponent);\n","import React, { ComponentType, forwardRef, useImperativeHandle } from 'react';\nimport cn from 'classnames';\nimport {\n\tCardinalDirection,\n\tOrdinalDirection,\n\tCropperTransitions,\n\tCropperState,\n\tResizeDirections,\n\tMoveDirections,\n\tCropperImage,\n\tResizeOptions,\n\tgetStencilCoordinates,\n\tCropperInteractions,\n} from 'advanced-cropper';\nimport { SimpleLine } from '../lines/SimpleLine';\nimport { SimpleHandler } from '../handlers/SimpleHandler';\nimport { BoundingBox } from '../service/BoundingBox';\nimport { StencilOverlay } from '../service/StencilOverlay';\nimport { DraggableArea } from '../service/DraggableArea';\nimport { StencilWrapper } from '../service/StencilWrapper';\nimport { StencilOptions } from '../../types';\nimport { StencilGrid } from '../service/StencilGrid';\n\ntype HandlerComponent = ComponentType<any>;\n\ntype LineComponent = ComponentType<any>;\n\ninterface HandlersClassNames extends Partial<Record<OrdinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface LinesClassNames extends Partial<Record<CardinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState;\n\tgetTransitions: () => CropperTransitions;\n\tgetInteractions: () => CropperInteractions;\n\thasInteractions: () => boolean;\n\tresizeCoordinates: (directions: ResizeDirections, options: ResizeOptions) => void;\n\tresizeCoordinatesEnd: () => void;\n\tmoveCoordinates: (directions: MoveDirections) => void;\n\tmoveCoordinatesEnd: () => void;\n\tsetStencilOptions: (options: StencilOptions) => void;\n}\n\ninterface Props {\n\tcropper: DesiredCropperRef;\n\timage: CropperImage | null;\n\thandlerComponent?: HandlerComponent;\n\thandlers?: Partial<Record<OrdinalDirection, boolean>>;\n\thandlerClassNames?: HandlersClassNames;\n\thandlerWrapperClassNames?: HandlersClassNames;\n\tlines?: Partial<Record<CardinalDirection, boolean>>;\n\tlineComponent?: LineComponent;\n\tlineClassNames?: LinesClassNames;\n\tlineWrapperClassNames?: LinesClassNames;\n\tmovingClassName?: string;\n\tresizingClassName?: string;\n\tgridClassName?: string;\n\tpreviewClassName?: string;\n\tboundingBoxClassName?: string;\n\toverlayClassName?: string;\n\tdraggableAreaClassName?: string;\n\tminAspectRatio?: number;\n\tmaxAspectRatio?: number;\n\taspectRatio?: number;\n\tmovable?: boolean;\n\tresizable?: boolean;\n\tgrid?: boolean;\n}\n\ninterface Methods {\n\taspectRatio: number;\n}\n\nexport const CircleStencil = forwardRef<Methods, Props>(\n\t(\n\t\t{\n\t\t\tcropper,\n\t\t\thandlerComponent = SimpleHandler,\n\t\t\thandlers = {\n\t\t\t\teastNorth: true,\n\t\t\t\twestNorth: true,\n\t\t\t\twestSouth: true,\n\t\t\t\teastSouth: true,\n\t\t\t},\n\t\t\thandlerClassNames = {},\n\t\t\thandlerWrapperClassNames = {},\n\t\t\tlines = {\n\t\t\t\twest: true,\n\t\t\t\tnorth: true,\n\t\t\t\teast: true,\n\t\t\t\tsouth: true,\n\t\t\t},\n\t\t\tlineComponent = SimpleLine,\n\t\t\tlineClassNames = {},\n\t\t\tlineWrapperClassNames = {},\n\t\t\tresizable = true,\n\t\t\tmovable = true,\n\t\t\tgrid,\n\t\t\tgridClassName,\n\t\t\tmovingClassName,\n\t\t\tresizingClassName,\n\t\t\tpreviewClassName,\n\t\t\tboundingBoxClassName,\n\t\t\toverlayClassName,\n\t\t\tdraggableAreaClassName,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst state = cropper.getState();\n\t\tconst transitions = cropper.getTransitions();\n\t\tconst interactions = cropper.getInteractions();\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\taspectRatio: 1,\n\t\t\tboundingBox: 'circle',\n\t\t}));\n\n\t\tconst onMove = (directions: MoveDirections) => {\n\t\t\tif (cropper && movable) {\n\t\t\t\tcropper.moveCoordinates(directions);\n\t\t\t}\n\t\t};\n\n\t\tconst onMoveEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.moveCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst onResize = (directions: ResizeDirections, options: ResizeOptions) => {\n\t\t\tif (cropper && resizable) {\n\t\t\t\tcropper.resizeCoordinates(directions, options);\n\t\t\t}\n\t\t};\n\n\t\tconst onResizeEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.resizeCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst { width, height, left, top } = getStencilCoordinates(state);\n\n\t\treturn (\n\t\t\tstate && (\n\t\t\t\t<StencilWrapper\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t'advanced-cropper-circle-stencil',\n\t\t\t\t\t\tmovable && 'advanced-cropper-circle-stencil--movable',\n\t\t\t\t\t\tinteractions.moveCoordinates && 'advanced-cropper-circle-stencil--moving',\n\t\t\t\t\t\tresizable && 'advanced-cropper-circle-stencil--resizable',\n\t\t\t\t\t\tinteractions.resizeCoordinates && 'advanced-cropper-circle-stencil--resizing',\n\t\t\t\t\t\tinteractions.moveCoordinates && movingClassName,\n\t\t\t\t\t\tinteractions.resizeCoordinates && resizingClassName,\n\t\t\t\t\t)}\n\t\t\t\t\twidth={width}\n\t\t\t\t\theight={height}\n\t\t\t\t\tleft={left}\n\t\t\t\t\ttop={top}\n\t\t\t\t\ttransitions={transitions}\n\t\t\t\t>\n\t\t\t\t\t<BoundingBox\n\t\t\t\t\t\tclassName={cn(boundingBoxClassName, 'advanced-cropper-circle-stencil__bounding-box')}\n\t\t\t\t\t\thandlers={handlers}\n\t\t\t\t\t\thandlerComponent={handlerComponent}\n\t\t\t\t\t\thandlerClassNames={handlerClassNames}\n\t\t\t\t\t\thandlerWrapperClassNames={handlerWrapperClassNames}\n\t\t\t\t\t\tlines={lines}\n\t\t\t\t\t\tlineComponent={lineComponent}\n\t\t\t\t\t\tlineClassNames={lineClassNames}\n\t\t\t\t\t\tlineWrapperClassNames={lineWrapperClassNames}\n\t\t\t\t\t\tonResize={onResize}\n\t\t\t\t\t\tonResizeEnd={onResizeEnd}\n\t\t\t\t\t\tdisabled={!resizable}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DraggableArea\n\t\t\t\t\t\t\tdisabled={!movable}\n\t\t\t\t\t\t\tonMove={onMove}\n\t\t\t\t\t\t\tonMoveEnd={onMoveEnd}\n\t\t\t\t\t\t\tclassName={cn('advanced-cropper-circle-stencil__draggable-area', draggableAreaClassName)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<StencilOverlay\n\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-circle-stencil__overlay', overlayClassName)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{grid && (\n\t\t\t\t\t\t\t\t\t<StencilGrid\n\t\t\t\t\t\t\t\t\t\tvisible={cropper.hasInteractions()}\n\t\t\t\t\t\t\t\t\t\tcolumns={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\trows={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-circle-stencil__grid', gridClassName)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div className={cn('advanced-cropper-circle-stencil__preview', previewClassName)} />\n\t\t\t\t\t\t\t</StencilOverlay>\n\t\t\t\t\t\t</DraggableArea>\n\t\t\t\t\t</BoundingBox>\n\t\t\t\t</StencilWrapper>\n\t\t\t)\n\t\t);\n\t},\n);\n\nCircleStencil.displayName = 'CircleStencil';\n","import React, { useLayoutEffect, useRef, useState } from 'react';\nimport cn from 'classnames';\nimport {\n\tCropperImage,\n\tCropperState,\n\tCropperTransitions,\n\tSize,\n\tgetPreviewStyle,\n\tisLower,\n\tratio,\n\tstretchPreviewBoundary,\n} from 'advanced-cropper';\nimport { StretchableBoundary, StretchableBoundaryMethods } from '../service/StretchableBoundary';\nimport { useWindowResize } from '../../hooks/useWindowResize';\n\ninterface Props {\n\tstate: CropperState | null;\n\timage: CropperImage | null;\n\ttransitions?: CropperTransitions | null;\n\tclassName?: string;\n\timageClassName?: string;\n\tcontentClassName?: string;\n}\n\nexport const CropperPreview = ({\n\tclassName,\n\tcontentClassName,\n\timageClassName,\n\tstate,\n\timage,\n\ttransitions = null,\n}: Props) => {\n\tconst boundaryRef = useRef<StretchableBoundaryMethods>(null);\n\n\tconst [size, setSize] = useState<Size | null>(null);\n\n\tconst [coefficient, setCoefficient] = useState(1);\n\n\tconst imageStyle =\n\t\tstate && state.coordinates && image && size ? getPreviewStyle(image, state, coefficient, transitions) : {};\n\n\tconst contentStyle = size\n\t\t? {\n\t\t\t\twidth: `${size.width}px`,\n\t\t\t\theight: `${size.height}px`,\n\t\t  }\n\t\t: {};\n\n\tconst refresh = () => {\n\t\tif (boundaryRef.current && state?.coordinates) {\n\t\t\tboundaryRef.current.stretchTo(state.coordinates).then((size) => {\n\t\t\t\tif (size && state.coordinates) {\n\t\t\t\t\tif (!isLower(ratio(state.coordinates), ratio(size))) {\n\t\t\t\t\t\tsetSize({\n\t\t\t\t\t\t\twidth: size.width,\n\t\t\t\t\t\t\theight: size.width / ratio(state.coordinates),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsetCoefficient(state.coordinates.width / size.width);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetSize({\n\t\t\t\t\t\t\twidth: size.height * ratio(state.coordinates),\n\t\t\t\t\t\t\theight: size.height,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsetCoefficient(state.coordinates.height / size.height);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsetSize(null);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tuseWindowResize(refresh);\n\n\tuseLayoutEffect(() => {\n\t\tif (state?.coordinates) {\n\t\t\trefresh();\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [image?.src, state?.coordinates]);\n\n\treturn (\n\t\t<StretchableBoundary\n\t\t\tref={boundaryRef}\n\t\t\tstretchAlgorithm={stretchPreviewBoundary}\n\t\t\tclassName={cn(className, 'advanced-cropper-preview')}\n\t\t>\n\t\t\t<div className={cn(contentClassName, 'advanced-cropper-preview__content')} style={contentStyle}>\n\t\t\t\t<img\n\t\t\t\t\tsrc={image ? image.src : undefined}\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\timageClassName,\n\t\t\t\t\t\t'advanced-cropper-preview__image',\n\t\t\t\t\t\timage && image.src && 'advanced-cropper-preview__image--visible',\n\t\t\t\t\t)}\n\t\t\t\t\tstyle={imageStyle}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</StretchableBoundary>\n\t);\n};\n","import { deepCompare } from '../utils/index.js';\n\nfunction isEqualState(a, b) {\n    return deepCompare(a, b);\n}\n\nexport { isEqualState };\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__read","o","m","Symbol","iterator","r","ar","next","done","push","value","error","__spreadArray","to","from","pack","l","slice","concat","getDirectionNames","hDirection","vDirection","camelCase","snakeCase","toUpperCase","isBlob","url","test","isDataUrl","isLocal","isCrossOriginURL","pageLocation","window","location","urlMatch","exec","urlparts","protocol","host","port","portOf","Boolean","isArray","isFunction","isUndefined","obj","undefined","isObject","term","getOptions","options","defaultScheme","falseScheme","result","keys","forEach","key","parseNumber","number","parsedNumber","Number","isNaN","isNumber","isString","isNumeric","parseFloat","isFinite","distance","firstPoint","secondPoint","Math","sqrt","pow","left","top","isRoughlyEqual","a","tolerance","abs","isGreater","isLower","sign","promiseTimeout","timeout","Promise","resolve","setTimeout","deepClone","map","item","deepCompare","length_1","valueOf","toString","emptyCoordinates","width","height","isCardinalDirection","debounce","callback","delay","timestamp","later","args","_i","last","Date","now","delayValue","clear","clearTimeout","ImageRestriction","Priority","SetCoordinatesMode","ALL_DIRECTIONS","HORIZONTAL_DIRECTIONS","VERTICAL_DIRECTIONS","diff","firstObject","secondObject","getCenter","object","sizeDistance","applyDirections","coordinates","directions","right","bottom","inverseMove","applyMove","move","coordinatesToPositionRestrictions","applyScale","factor","center","progress","currentCenter","ratio","maxScale","size","restrictions","min","maxWidth","Infinity","maxHeight","minScale","max","minWidth","minHeight","getBrokenRatio","currentAspectRatio","aspectRatio","ratioBroken","minimum","maximum","fitToSizeRestrictions","sizeRestrictions","scale","getIntersections","positionRestrictions","intersections","direction","areaLimit","objectLimit","resizeToSizeRestrictions","rotateSize","angle","radians","PI","cos","sin","rotatePoint","point","anchor","positionToSizeRestrictions","mergePositionRestrictions","firstDirection","secondDirection","fitToPositionRestrictions","intersection","moveToPositionRestrictions","aspectRatioIntersection","main","subset","createAspectRatio","isConsistentSize","isConsistentPosition","getCloserSize","candidates","reference","traverse","ignoreMinimum","reduce","_a","preparedAspectRatio","isInitializedState","state","visibleArea","getAreaSizeRestrictions","settings","calculateAreaSizeRestrictions","getAreaPositionRestrictions","areaPositionRestrictions","getSizeRestrictions","calculateSizeRestrictions","getPositionRestrictions","getCoefficient","boundary","getStencilCoordinates","top_1","coefficient","getAspectRatio","getDefaultCoordinates","defaultCoordinates","getDefaultVisibleArea","defaultVisibleArea","getTransformedImageSize","imageSize","transforms","rotate","getMinimumSize","getRoundedCoordinates","roundCoordinates","round","floor","ceil","isConsistentState","reconcileSizeRestrictions","mergeSizeRestrictions","first","second","areaSizeRestrictions","copyState","approximateSize","params","candidate","fitVisibleArea","moveCoordinatesAlgorithm","movedCoordinates","setCoordinates","transform","mode","currentMode","unsafe","zoom","limit","prevCoordinates","newCoordinates","changes","resize","widthIntersections","heightIntersections","fitCoordinates","setVisibleArea","safe","createState","_b","priority","flip","horizontal","vertical","moveCoordinates","fitDirections","preserveRatio","compensate","fittedDirections","currentWidth","currentHeight","breaks","maxResize","multiplier_1","multiplier_2","distributeOverlap","overlap","resizeCoordinatesAlgorithm","limitations","actualCoordinates","allowedDirections","preserveAspectRatio","respectDirection","overlapHeight","overlapWidth","resizeCoordinates","minimumSize","setBoundary","rotateImageAlgorithm","imageCenter","shift","flipImageAlgorithm","changed","oldCenter","newCenter","transformImageAlgorithm","_c","scaleFactor","scaleCenter","isAllowedScale","areaScale","stencilScale","scaleRestrictions","stencil","area","relativeCoordinates","transformImage","adjustStencil","reconcileState","brokenRatio","desiredSize","scaleModifier","normalizeResizeDirections","normalizeCenter","normalizeFlip","normalizedAngle","fillMoveDirections","fillResizeDirections","normalizeMoveDirections","normalizeImageTransform","calculateGeometricProperties","touches","container","getBoundingClientRect","centerMass","spread","touch","clientX","clientY","count","touchesToImageTransform","previousTouches","previousProperties","properties","diffs","y","x","atan2","wheelEventToImageTransform","event","deltaY","detail","wheelDelta","defaultPositionRestrictions","limits","imageRestriction","boundaryRatio","coordinatesIntersection","imageRatio","areaProperties","defaultSize","sizeRestrictions_1","optimalRatio","retrieveSizeRestrictions","pixelsRestrictions","defaultPosition","defaultAreaPositionRestrictions","fillArea","fitArea","defaultAreaSizeRestrictions","fillBoundary","clientWidth","clientHeight","defaultStencilConstraints","rawSettings","stencilProps","withDefaultSizeRestrictions","basicSettings","createDefaultSettings","defaultSizeAlgorithm","defaultPositionAlgorithm_1","hasInteractions","interactions","runCallback","getInstance","instance","exports","AbstractCropper","_this","getTransitions","data","getData","transitions","getProps","timingFunction","duration","active","getInteractions","disableTransitions","onTransitionsEnd","setData","applyPostProcess","action","postProcess","name","interaction","_d","immediately","preparedAction","processedState","updateState","modifier","callbacks","onTransitionsStart","onChange","previousData","somethingChanged","affectTransitionProperties","some","property","currentData","runCallbacks","createCallback","setInteractions","onInteractionStart","onInteractionEnd","previousInteractions","currentInteractions","state_1","resetState","image","createDefaultState","reconcileStateAlgorithm","reconciledState","normalize","_e","onTransformImage","onTransformImageEnd","transformImageEnd","zoomImage","moveImage","flipImage","getState","rotateImage","reset","setState","getSettings","postprocess","newState","setCoordinatesAlgorithm","setVisibleAreaAlgorithm","setBoundaryAlgorithm","onMove","onMoveEnd","normalizedDirections","moveCoordinatesEnd","parameters","onResize","onResizeEnd","resizeCoordinatesEnd","getCoordinates","getVisibleArea","getTransforms","defaultTransforms","createStateAlgorithm","isConsistent","CropperInstance","_super","props","isControlled","timingFunctions","linear","Animation","start","animation","onStart","onProgress","onStop","id","cancelAnimationFrame","startTime","performance","endTime","animate","production","console","warn","percent","requestAnimationFrame","stop","prepareSource","canvas","originalSize","naturalWidth","naturalHeight","transformedSize","ctx","getContext","save","canvasCenter","translate","drawImage","restore","updateCanvas","source","resultSize","clearRect","imageSmoothingEnabled","imageSmoothingQuality","fillColor","fillStyle","fillRect","drawCroppedArea","resultCanvas","spareCanvas","maxArea","firstNumeric","array","find","el","stretchCropperBoundary","stretcher","style","stretchPreviewBoundary","getImageData","img","reject","base64","replace","binary","atob","len","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","base64ToArrayBuffer","fileReader_1","FileReader","onload","target","blob","readAsArrayBuffer","http","XMLHttpRequest","open","responseType","status","response","send","http_1","onreadystatechange","readyState","onprogress","getResponseHeader","abort","withCredentials","getStyleTransforms","resetAndGetOrientation","arrayBuffer","orientation_1","dataView","DataView","tiffOffset","littleEndian","app1Start","ifdStart","getUint8","byteLength","offset","str","fromCharCode","getStringFromCharCode","endianness","getUint16","firstIFDOffset","getUint32","length_2","setUint16","getImage","src","orientation","revoke","URL","createObjectURL","Blob","chunks","uint8","subarray","btoa","join","arrayBufferToDataURL","createImage","document","createElement","crossOrigin","visibility","position","body","appendChild","complete","removeChild","addEventListener","loadImage","checkOrientation","parse","then","catch","parseImage","getImageStyle","optimalImageSize","actualImageSize","imageTransforms","translateX","translateY","compensations","transition","willChange","getBackgroundStyle","getPreviewStyle","splitAbstractCropperProps","autoReconcileState","backgroundWrapperComponent","backgroundWrapperProps","wrapperComponent","wrapperProps","stencilComponent","stencilConstraints","className","imageClassName","boundaryClassName","backgroundClassName","backgroundComponent","backgroundProps","boundarySizeAlgorithm","boundaryStretchAlgorithm","onReady","onError","unloadTime","createCropper","render","forwardRef","hybridStencilAutoZoom","hybridStencilAutoZoomAlgorithm","useDeprecationWarning","fired","useRef","message","text","current","hasOwn","classNames","classes","arg","argType","inner","module","default","useWindowResize","callbackRef","internalCallback","useEffect","removeEventListener","useCropperImage","onLoadingStart","onLoadingEnd","onLoad","useState","loading","setLoading","loaded","setLoaded","setImage","currentSrc","promises","all","responses","finally","useCropperState","rerender","setTick","useForceRerender","propsRef","useCropperProps","extendedSettings","extendedParameters","cropper","useLayoutEffect","mergeRefs","refs","ref","useUpdateEffect","effect","deps","isFirst","isFirstMount","StretchableBoundary","stretcherClassName","contentClassName","stretchAlgorithm","sizeAlgorithm","children","stretcherRef","boundaryRef","useImperativeHandle","stretchTo","React","cn","displayName","CropperFade","visible","CropperWrapper","preventDefault","CropperBackgroundImage","onMouseDown","CropperCanvas","_","canvasRef","spareCanvasRef","draw","Fragment","DraggableElement","processMove","newTouches","movingToAnchor","useAnchor","processEnd","onLeave","disabled","hovered","initAnchor","top_2","onMouseOver","onEnter","onMouseLeave","onTouchStart","onMoveStart","cancelable","shouldStartMove","started","stopPropagation","onTouchEnd","onTouchMove","activationDistance","button","onMouseMove","onMouseUp","createRef","shouldComponentUpdate","componentWillUnmount","componentDidMount","passive","componentDidUpdate","prevProps","defaultProps","Component","LineWrapper","onDrag","onDragEnd","SimpleLine","hoverClassName","wrapperClassName","defaultClassName","hover","setHover","HandlerWrapper","horizontalPosition","verticalPosition","classnames","SimpleHandler","wrapperStyle","BoundingBox","handlerComponent","handlers","eastNorth","north","westNorth","west","westSouth","south","eastSouth","east","handlerClassNames","handlerWrapperClassNames","_f","lines","_g","lineComponent","_h","lineClassNames","_j","lineWrapperClassNames","_k","points","useMemo","lineNodes","component","handlerNodes","containerClassName","onHandlerDrag","horizontalDirection","verticalDirection","nativeEvent","shiftKey","line","handler","handlerElement","StencilOverlay","ArtificialTransition","values","root","transitionValues","rememberedValues","setRememberedValues","setActive","useTransition","runTransitions","transitionsActive","startValues_1","desiredValue","startValue","currentValues","rootStyle","StencilWrapper","StencilGrid","columns","rows","nodes","currentColumns","setCurrentColumns","currentRows","setCurrentRows","cells","j","RectangleStencil","minAspectRatio","maxAspectRatio","resizable","_l","movable","grid","gridClassName","movingClassName","resizingClassName","previewClassName","boundingBoxClassName","overlayClassName","draggableAreaClassName","_m","DraggableArea","useScaleImageOptions","scaleImage","wheel","useMoveImageOptions","mouse","TransformableImageEvent","defaultPrevented","TransformableImage","onTransform","touchScale","touchMove","touchRotate","onTransformEnd","transforming","processStart","debouncedProcessEnd","processEvent","onEvent","transformEvent","onWheel","wheelScale","left_1","bottom_1","right_1","filter","identifier","anotherTouch","buttons","mouseMove","CropperBackgroundWrapper","rotateImageOptions","useRotateImageOptions","scaleImageOptions","moveImageOptions","_o","_p","stencilRef","imageRef","cropperRef","_q","initialState","setCallback","previousState","useStateWithCallback","currentImage","setCurrentImage","_r","autoReconcileStateDisabled","setAutoReconcileStateDisabled","_s","resetCropper","refreshCropper","cropperInterface","refresh","getCanvas","getDefaultState","StencilComponent","WrapperComponent","BackgroundWrapperComponent","BackgroundComponent","fixedStencilConstraints","stencilOptions","defaultConstraints","stencilSize","previousSize","getStencilSize","areaRestrictions","fixedStencil","fixedStencilAlgorithm","FixedCropper","Cropper","autoZoom","actualSettings","deprecationWarning","CircleStencil","boundingBox","setSize","setCoefficient","imageStyle","contentStyle","areaHeight","areaWidth","turnsCount","firstCandidate","secondCandidate"],"mappings":"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"}